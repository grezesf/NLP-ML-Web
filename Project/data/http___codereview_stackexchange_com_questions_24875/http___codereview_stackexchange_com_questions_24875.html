<!DOCTYPE html>
<html>
<head>
    
    <title>Looking for Python code review of database abstraction class - Code Review Stack Exchange</title>
    <link rel="shortcut icon" href="//cdn.sstatic.net/codereview/img/favicon.ico">
    <link rel="apple-touch-icon image_src" href="//cdn.sstatic.net/codereview/img/apple-touch-icon.png">
    <link rel="search" type="application/opensearchdescription+xml" title="Code Review Stack Exchange" href="/opensearch.xml">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@StackCodeReview" />
    <meta name="twitter:domain" content="codereview.stackexchange.com"/>
    <meta name="og:type" content="website" />
    <meta name="og:image" content="http://cdn.sstatic.net/codereview/img/apple-touch-icon.png?v=bb26b8631f86"/>
    <meta name="og:title" content="Looking for Python code review of database abstraction class" />
    <meta name="og:description" content="I&#39;d be very thankful if some Python masters would take a look over the following class and review the code. There is no bug(not as far as I know anyway), the code is working as intended. But, since..." />
    <meta name="og:url" content="http://codereview.stackexchange.com/questions/24875/looking-for-python-code-review-of-database-abstraction-class"/>
    <link rel="canonical" href="http://codereview.stackexchange.com/questions/24875/looking-for-python-code-review-of-database-abstraction-class" />

    
    
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="//cdn.sstatic.net/Js/stub.en.js?v=e3d47b73fa12" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="//cdn.sstatic.net/codereview/all.css?v=67e9087155b1">
    
    <link rel="alternate" type="application/atom+xml" title="Feed for question &#39;Looking for Python code review of database abstraction class&#39;" href="/feeds/question/24875">
    <script type="text/javascript">
        
        StackExchange.ready(function () {
            StackExchange.using("postValidation", function () {
                StackExchange.postValidation.initOnBlurAndSubmit($('#post-form'), 2, 'answer');
            });

            
            StackExchange.question.init({showAnswerHelp:true,totalCommentCount:0,shownCommentCount:0,highlightColor:'#F4A83D',backgroundColor:'#FFF',questionId:24875});

            styleCode();

                StackExchange.realtime.subscribeToQuestion('196', '24875');
            
                    });
    </script>


    <script type="text/javascript">
        StackExchange.ready(function () {
            StackExchange.realtime.init('wss://qa.sockets.stackexchange.com,ws://qa.sockets.stackexchange.com');
            StackExchange.realtime.subscribeToInboxNotifications();
                    StackExchange.realtime.subscribeToReputationNotifications('196');
                        });
    </script>
    <script type="text/javascript">
        StackExchange.init({"locale":"en","stackAuthUrl":"https://stackauth.com","serverTime":1385484127,"styleCode":true,"enableUserHovercards":true,"site":{"name":"Code Review Stack Exchange","description":"Q&A for peer programmer code reviews","isNoticesTabEnabled":true,"recaptchaPublicKey":"6LdsB7sSAAAAAAzjgEF_Hd8vXv-C42sa_KyofaGR","enableSocialMediaInSharePopup":true},"user":{"fkey":"6c07fd052a87c08ef3cc6e062a9ff978","isAnonymous":true}});
        StackExchange.using.setCacheBreakers({"js/prettify-full.en.js":"e0bbd4760e83","js/moderator.en.js":"1a411fd265fe","js/full-anon.en.js":"8a881a0975af","js/full.en.js":"e87912181c10","js/wmd.en.js":"bd9234d44a40","js/third-party/jquery.autocomplete.min.js":"e5f01e97f7c3","js/third-party/jquery.autocomplete.min.en.js":"","js/mobile.en.js":"d1d834ef85d2","js/help.en.js":"d3cc74d8a93a","js/tageditor.en.js":"6d51a5f8d7f3","js/tageditornew.en.js":"111b781cf314","js/inline-tag-editing.en.js":"f951bd09dc69","js/revisions.en.js":"33fd38144303","js/review.en.js":"f45b4ec094ea","js/tagsuggestions.en.js":"e4e7b952fcc7","js/post-validation.en.js":"c275fe37d674","js/explore-qlist.en.js":"73825bd006fc","js/events.en.js":"53bc48767091"});
        StackExchange.using("gps", function() {
             StackExchange.gps.init(true);
        });
        
    </script>
    
        <script type="text/javascript">
            StackExchange.ready(function () {
                $('#nav-tour').click(function () {
                    StackExchange.using("gps", function() {
                        StackExchange.gps.track("aboutpage.click", { aboutclick_location: "headermain" }, true);
                    });
                });
            });
        </script>
</head>
<body class="question-page">
    <noscript><div id="noscript-padding"></div></noscript>
    <div id="notify-container"></div>
    <div id="overlay-header"></div>
    <div id="custom-header"></div>
    <div class="container">
        <div id="header" class=headeranon>
            <div id="portalLink">
                <a class="genu" href="http://stackexchange.com" onclick="StackExchange.ready(function(){genuwine.click();});return false;">Stack Exchange</a>
            </div>
            <div id="topbar">
                <div id="hlinks">
                    
<span id="hlinks-user"></span>
<span id="hlinks-nav">                        <a href="/users/login?returnurl=%2fquestions%2f24875%2flooking-for-python-code-review-of-database-abstraction-class">sign up</a>

 <span class="lsep">|</span>
                    <a href="/users/login?returnurl=%2fquestions%2f24875%2flooking-for-python-code-review-of-database-abstraction-class">log in</a>

 <span class="lsep">|</span>
</span>
<span id="hlinks-custom"></span>
                </div>
                <div id="hsearch">
                    <form id="search" action="/search" method="get" autocomplete="off">
                        <div>
                            <input autocomplete="off" name="q" class="textbox" placeholder="search" tabindex="1" type="text" maxlength="240" size="28" value="">
                        </div>
                    </form>
                </div>
            </div>
            <br class="cbt">
            <div id="hlogo">
                <a href="/">
                    Code Review
                        <span class="beta-title">beta</span>
                </a>
            </div>
            <div id="hmenus">
                <div class="nav mainnavs mainnavsanon">
                    <ul>
                            <li class="youarehere"><a id="nav-questions" href="/questions">Questions</a></li>
                            <li><a id="nav-tags" href="/tags">Tags</a></li>
                            <li><a id="nav-tour" href="/about">Tour</a></li>
                            <li><a id="nav-users" href="/users">Users</a></li>
                    </ul>
                </div>
                <div class="nav askquestion">
                    <ul>
                        <li>
                            <a id="nav-askquestion"  href="/questions/ask">Ask Question</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        



        <div id="content">
            

<div itemscope itemtype="http://schema.org/Article">
	<link itemprop="image" href="//cdn.sstatic.net/codereview/img/apple-touch-icon.png">
			<!--googleoff: all-->
<div id="herobox-mini">
    <div id="hero-content">
        <span id="controls">
            <a href="/about" id="tell-me-more" class="button">Tell me more</a>
            <span id="close"><a title="click to dismiss">&times;</a></span>
        </span>
        <div id="blurb">
            Code Review Stack Exchange is a question and answer site for peer programmer code reviews. It&#39;s 100% free, no registration required.
        </div>        
    </div>
    <script>
        $('#tell-me-more').click(function () {
            var clickSource = $("body").attr("class") + '-mini';
            if ($("body").hasClass("questions-page")) {
                clickSource = 'questionpagemini';
            }
            if ($("body").hasClass("home-page")) {
                clickSource = 'homepagemini';
            }

            StackExchange.using("gps", function () {
                StackExchange.gps.track("aboutpage.click", { aboutclick_location: clickSource } , true);
            });
        });
        $('#herobox-mini #close').click(function () {
            StackExchange.using("gps", function () {
                StackExchange.gps.track("hero.action", { hero_action_type: "close" }, true);
            });
            $.cookie("hero", "none", { path: "/" });
            var $hero = $("#herobox-mini");
            $hero.slideUp('fast', function () { $hero.remove(); });
            return false;
        });
    </script>
</div>
			<!--googleon: all-->
			<div id="question-header">
			<h1 itemprop="name"><a href="/questions/24875/looking-for-python-code-review-of-database-abstraction-class" class="question-hyperlink">Looking for Python code review of database abstraction class</a></h1>
		</div>
			<div id="mainbar">

			

<div class="question" data-questionid="24875"  id="question">
    
        <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="24875">
    <a class="vote-up-off" title="This question shows research effort; it is useful and clear">up vote</a>
    <span class="vote-count-post ">1</span>
    <a class="vote-down-off" title="This question does not show any research effort; it is unclear or not useful">down vote</a>
    
    <a class="star-off" href="#" title="This is a favorite question (click again to undo)">favorite</a>
    <div class="favoritecount"><b></b></div>   

</div>

            </td>
            
<td class="postcell">
<div>
    <div class="post-text" itemprop="description">

        <p>I'd be very thankful if some Python masters would take a look over the following class and review the code. There is no bug(not as far as I know anyway), the code is working as intended. But, since I'm learning Python, I want to make sure I'm thinking and working in the most "pythonic" way possible. Thank you all in advance. Oh, the class does some database abstraction operations. And while I could have just used an ORM, I prefer to get my hands dirty when learning something new...</p>

<p><strong>Warning:</strong> Long file (~350 lines)</p>

<pre><code>from Singleton import Singleton;

#Singleton class implements static methods and variable required for the
#singleton design pattern
class Database(Singleton):

    def __init__(self, **kwargs):

        self._con = None;
        self._host = kwargs['host'] if kwargs.has_key('host') else 'localhost';
        self._username = kwargs['username'];
        self._password = kwargs['password'];
        self._dbname = kwargs['database'];
        self._driver = kwargs['driver'];

        #encloser characters for system identifiers(key_delim) and strings(str_delim)
        self._key_delim = '"';
        self._str_delim = "'";

        if self._driver == 'mysql':
            self._module = __import__('MySQLdb');
            self._key_delim = '`';
        elif self._driver == 'pgsql':
            self._module = __import__('psycopg2');
        else:
            raise Exception("Unknown database driver");

        self._affected_rows = None;
        self._last_query = None;
        self._insert_id = None;
        self._error = None;
        self._autocommit = False;

        self.connect();

    def __del__(self):
        self.disconnect();

    def connect(self):
        kwargs = {'host': self._host, 'user': self._username};
        if self._driver == 'mysql':
            kwargs['passwd'] = self._password;
            kwargs['db'] = self._dbname;
        elif self._driver == 'pgsql':
            kwargs['database'] = self._dbname;
            kwargs['password'] = self._password;

        self._con = self._module.connect(**kwargs);

    def disconnect(self):
        if self._con:
            self._con.commit();
            self._con.close();

    def reconnect(self):
        self.disconnect();
        self.connect();

    #fake connecting to the database. Useful when trying out connection parameters, e.g. during install
    @staticmethod
    def mock(**kwargs):
        try:
            d = Database(kwargs);
            return true;
        except Exception:
            return false;


    #queries the database, returning the result as a list of dicts or None, if no row found or on commands
    def _query(self, s, params = None):

        if isinstance(params, list):
            params = tuple(params);

        #need this for compatibility with manual queries using MySQL format, where the backtick is used for enclosing column names
        #instead of the standard double quote. Will be removed soon
        if self._driver != 'mysql':
            s = self.__replace_backticks(s);

        try:
            cur = self._con.cursor();
            cur.execute(s, params);
            self._insert_id = cur.lastrowid;
            self._affected_rows = cur.rowcount;

            try:
                results = cur.fetchall();
                n = len(results);
                cols = self.table_columns(None, cur);
            except self._module.DatabaseError:
                #INSERT/UPDATE or similar
                return None;
            finally:
                cur.close();

            retval = [];
            for i in range(0,n):
                aux = results[i];
                row = {};
                for j in range(0,len(cols)):
                    #elem = aux[j].decode('UTF-8') if isinstance(aux[j], basestring) else aux[j];
                    row[cols[j]] = aux[j];

                if len(row):
                    retval.append(row);

            return retval;

        except self._module.DatabaseError as e:
            #Error. Reset insert id and affected rows to None
            self._insert_id = None;
            self._affected_rows = None;
            raise Exception("Database Error: %s" % str(e));

        return retval;

    #escape a variable/tuple/list
    def escape(self, s):
        if isinstance(s, basestring):
            return self._con.escape_string(s);
        elif isinstance(s, list):
            return map(lambda x: self.escape(x), s);
        elif isinstance(s, tuple):
            return tuple(self.escape(list(s)));
        else:
            raise TypeException("Unknown parameter given for escaping");

        #never get here
        return None;

    #encloses a string with single quotes
    def enclose_str(self, s):
        if isinstance(s, basestring):
            return ''.join([self._str_delim,str(s),self._str_delim]);
        elif isinstance(s, list):
            return map(self.enclose_str, s);
        elif isinstance(s, tuple):
            return tuple(map(self.enclose_str, s));
        else:
            raise TypeError("Unknown argument type to enclose_str");

    #encloses an identifier in the appropriate double quotes/backticks  
    def enclose_sys(self,s):
        #we do not enclose variable containing spaces because we assume them to be expressions, e.g. COUNT(*) AS ...
        #Column names containing spaces are not supported
        if isinstance(s, basestring):
            if s.count(' ') or s == '*':
                return s;
            return ''.join([self._key_delim,str(s),self._key_delim]);
        elif isinstance(s, list):
            return map(self.enclose_sys, s);
        elif isinstance(s, tuple):
            return tuple(map(self.enclose_sys, s));
        else:
            raise TypeError("Unknown argument type to enclose_sys");

    #SELECT FROM table
    def select(self, table, columns = None, where = None, op = "AND"):
        if isinstance(columns, tuple):
            columns = ",".join(map(lambda x: self.enclose_sys(x), columns));
        elif isinstance(columns, basestring):
            columns = self.enclose_sys(columns);
        elif not columns:
            columns = "*";
        else:
            raise TypeException("Invalid column definition");

        (where_clause, where_params) = self.__expand_where_clause(where, op);

        if not where_clause:
            return self._query("SELECT %s FROM %s" % (columns, self.enclose_sys(table)));
        else:
            return self._query("SELECT %s FROM %s WHERE %s" % (columns, self.enclose_sys(table), where_clause), where_params);

    #INSERT INTO table
    def insert(self, table, values):
        if isinstance(values, tuple):
            values = [values];
        if not isinstance(values, list):
            raise TypeError("INSERT: Inappropriate argument type for parameter values");

        cols = map(lambda x: self.enclose_sys(x[0]), values);
        vals = tuple(map(lambda x: x[1], values));

        sql = 'INSERT INTO %s(%s) VALUES (%s)' % (self.enclose_sys(table), ','.join(cols), ','.join( ['%s'] * len(vals) ));
        return self._query(sql, vals);

    #UPDATE table
    def update(self, table, values, where = None, op = 'AND'):
        if isinstance(values, tuple):
            values = [values];
        if not isinstance(values, list):
            raise TypeError("UPDATE: Inappropriate argument type for parameter values");

        cols = map(lambda x: self.enclose_sys(x[0])+'=%s', values);
        vals = tuple(map(lambda x: x[1], values));

        (where_clause, where_params) = self.__expand_where_clause(where, op);

        if where_clause:
            return self._query('UPDATE %s SET %s WHERE %s' % (self.enclose_sys(table), ','.join(cols), where_clause), list(vals) + list(where_params));
        else:
            return self._query('UPDATE %s SET %s' % (self.enclose_sys(table), ','.join(cols)), vals);

    #DELETE FROM table
    def delete(self, table, where = None, op = 'AND'):
        (where_clause, where_params) = self.__expand_where_clause(where, op);

        if where_clause:
            return self._query("DELETE FROM %s WHERE %s" % (self.enclose_sys(table), where_clause), where_params);
        else:
            return self._query("DELETE FROM %s" % (self.enclose_sys(table)));

    #upsert and merge perform the same task, having the same end result.
    #The difference is that the former is optimised to work on data where usually little new rows are added
    #while the latter is optimised in the case the majority of the data dealt with will be added, not already existing
    def upsert(self, table, values, where):
        self.update(table, values, where);
        if not self.affected_rows():
            self.insert(table, [values] + [where]);
    def merge(self, table, values, where):
        try:
            self.insert(table, [values] + [where]);
        except self._module.DatabaseError as e:
            #TODO: Check error in case it's not due to a PK/Unique violation
            self.update(table, values, where);

    #Returns a row, instead of simply a list of 1. Inspired by Wordpress
    def get_row(self, table, columns = None, where = None, op = "AND"):
        r = self.select(table, columns, where, op);
        return r[0] if r else None;

    #Returns a variable. Useful for quick counts or returning of an id, for example. Inspired by Wordpress
    def get_var(self, table, columns = None, where = None, op = "AND"):
        r = self.select(table, columns, where, op);
        return r[0].items()[0][1] if r else None;

    #Count the rows of a table
    def count(self, table, column, value = None):
        where = (column, value) if value else None;
        return self.get_var(table, 'COUNT(*) AS %s' % (self.enclose_sys('cunt')), where);


    def drop(self):
        self._query("DROP DATABASE " + self._dbname);
    def create(self):
        self._query("CREATE DATABASE " + self._dbname);
    def purge(self):
        #only works in MySQL, must find alternative for Postgres
        self.drop();
        self.create();
    def truncate(self, table_name):
        self._query("TRUNCATE TABLE " + self.enclose_sys(table_name));


    #wrappers around transaction management functions
    def commit(self):
        self._con.commit();
    def rollback(self):
        self._con.rollback();
    def autocommit(self, val):
        self._autocommit(bool(val));

    #getters... 
    def affected_rows(self):
        return self._affected_rows; 
    def insert_id(self):
        return self._insert_id;

    def __is_escaped(self, s, pos):
        for char in ["'", "\\"]:
            j = pos - 1;
            count = 0;

            #count back the num. of appearances of certain char
            while (j&gt;=0 and s[j] == char):
                j-=1;
                count+=1;

            #reduce the count in cases like \'' ,where the last ' to the left is escaped by 1 or more \
            if (char == "'" and count and self.__isEscaped(s, pos-count)):
                count-=1;
            if (count):
                break;

        return True if (count % 2) else False;


    #replaces MySQL style `backticks` with "double quotes", as per SQL standard.
    #Required in order to support MySQL queries containing backticks
    def __replace_backticks(self, str):
        s = list(str);
        delim = None;
        inside = False;


        for i in range(0, len(s)):
            #only working on important characters
            if (s[i] not in ['"',"'","`"]):
                continue;

            if inside:
                if (s[i] == '`' or s[i] != delim): #if we encounter a wrong token, simply continue
                    continue;

                if not self.__is_escaped(s, i):
                    inside = False;
                    delim = None;
            else:
                if s[i] == '`':
                    s[i] = '"';
                    continue;

                if not self.__is_escaped(s, i):
                    inside = True;
                    delim = s[i];

        return "".join(s);

    #helper function, expands a tuple/list of tuples containing where parameters to string
    def __expand_where_clause(self, where, op):
        params = [];
        clauses = [];

        if where:
            if isinstance(where, tuple):
                where = [where];
            if not isinstance(where, list):
                raise TypeException("Unknown type for WHERE clause argument");

        if where:   
            for clause in where:
                clause_op = clause[2] if len(clause)==3 else '=';
                clauses.append(self.enclose_sys(clause[0]) + (" %s " % clause_op) + '%s');
                params.append(clause[1]);

        where_clause = (' %s ' % op).join(clauses);
        return (where_clause, tuple(params) if len(params) else None);  

    #returns an array containing the names of the columns of a table
    def table_columns(self, table_name = None, cur = None):
        if not cur:
            try:
                cur = self._con.cursor();
                cur.execute("SELECT * FROM " + table_name + " LIMIT 1");
                cur.close();
            except self._module.DatabaseError as e:
                raise Exception("Database Error: %s" % str(e));

        cols = map(lambda x: x[0], cur.description);
        return cols;
</code></pre>

    </div>
    <div class="post-taglist">
        <a href="/questions/tagged/python" class="post-tag" title="show questions tagged &#39;python&#39;" rel="tag">python</a> <a href="/questions/tagged/clean-code" class="post-tag" title="show questions tagged &#39;clean-code&#39;" rel="tag">clean-code</a> 
    </div>
    <table class="fw">
    <tr>
    <td class="vt">











<div class="post-menu"><a href="/q/24875" title="short permalink to this question" class="short-link" id="link-post-24875">share</a><span class="lsep">|</span><a href="/posts/24875/edit" class="suggest-edit-post" title="">improve this question</a></div>        
    </td>
    <td class="post-signature owner">
        
<div class="user-info ">
    <div class="user-action-time">
        
        
            asked <span title="2013-04-08 22:34:04Z" class="relativetime">Apr 8 at 22:34</span>
        

    </div>
    <div class="user-gravatar32">
        <a href="/users/23931/vlad"><div><img src="https://www.gravatar.com/avatar/181213ff9aa17b009c198a78105e3df8?s=32&d=identicon&r=PG&f=1" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/23931/vlad">Vlad</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">8</span><span title="2 bronze badges"><span class="badge3"></span><span class="badgecount">2</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</div>
</td>
        </tr>
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-24875" class="comments dno" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">
					    <tr><td></td><td></td></tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-24875" data-rep=50 data-anon=true
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid answering questions in comments." 
				>add comment</a>
    </td>
</tr>            </table>    
</div>


			<div id="answers">

				<a name="tab-top"></a>
				<div id="answers-header">
					<div class="subheader answers-subheader">
						<h2>
								2 Answers
						</h2>
						<div>
							<div id="tabs">
        <a href="/questions/24875/looking-for-python-code-review-of-database-abstraction-class?answertab=active#tab-top" title="Answers with the latest activity first">active</a>
        <a href="/questions/24875/looking-for-python-code-review-of-database-abstraction-class?answertab=oldest#tab-top" title="Answers in the order they were provided">oldest</a>
        <a class="youarehere" href="/questions/24875/looking-for-python-code-review-of-database-abstraction-class?answertab=votes#tab-top" title="Answers with the highest score first">votes</a>
</div>
						</div>
					</div>    
				</div>    




  
<a name="24880"></a>
<div id="answer-24880" class="answer accepted-answer" data-answerid="24880" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="24880">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">2</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


        <span class="vote-accepted-on load-accepted-answer-date" title="loading when this answer was accepted...">accepted</span>
</div>

            </td>



<td class="answercell">
    <div class="post-text"><ol>
<li><p>Comments like <code># Will be removed soon</code> make me think that this isn't really ready for review. It's best to fix all the problems you know about before submitting for review.</p></li>
<li><p>There's no documentation. How is anyone supposed to use this? For example, what arguments should one pass to the constructor? What kind of object do I pass in if I want a <code>where</code> clause?</p></li>
<li><p>Why inherit from <code>Singleton</code>? Does this mean I can't connect to more than one database? Isn't that a problem?</p></li>
<li><p>There are <a href="http://en.wikipedia.org/wiki/SQL_injection" rel="nofollow">SQL injection vulnerabilities</a> everywhere, because <code>enclose_sys()</code> doesn't escape its argument if it contains a space. For example, if I run:</p>

<pre><code> db = Database(username='foo', password='bar', database='mydb', driver='mysql')
 db.select('table', ('1; drop database; select *',))
</code></pre>

<p>then this issues the query</p>

<pre><code> SELECT 1; drop database; select * FROM `table`
</code></pre></li>
<li><p>There's no separation of driver code into its own class. If I want to add a new backend (e.g. SQLite) how do I do it?</p></li>
<li><p>Your <code>upsert()</code> method doesn't take advantage of the capability of some databases to do it in a single query, for example <a href="http://dev.mysql.com/doc/refman/5.1/en/insert-on-duplicate.html" rel="nofollow"><code>INSERT ... ON DUPLICATE KEY UPDATE</code></a> in MySQL.</p></li>
<li><p>In <code>disconnect()</code> you don't clear <code>self._con</code>, so calling <code>disconnect()</code> twice will cause you to close the connection twice.</p></li>
<li><p>It's better to write <code>values = list(values)</code> instead of testing <code>isinstance(values, list)</code> and then raising an exception if it's not. The former can accept iterators and generators.</p></li>
<li><p>In <code>select()</code>, why does the <code>columns</code> argument have to be a tuple? Why not a list?</p></li>
<li><p>Basically <code>if isinstance(arg, type1): ... elif isinstance(arg, type2): ...</code> is an anti-pattern in Python. It usually means that your interface is poorly thought out and you are trying to overload the meaning of your parameter. Better to choose a single type for each parameter.</p></li>
<li><p>You <code>raise TypeException</code> in various places, but there is no such exception in Python. Presumably this is a typo for <code>TypeError</code>, but it suggests that you have never tested these error paths.</p></li>
<li><p>Your <code>_query()</code> method always returns its results as a list of dictionaries, thus reading the entire result set into memory. This defeats the whole point of having database cursors, which is that the application can process records one at a time as they are returned from the database. This allows the application to proceed in parallel with the database, and avoids filling memory unnecessarily.</p></li>
<li><p>It's not very portable to Python 3: <code>kwargs.has_key('host')</code>, <code>basestring</code>.</p></li>
<li><p>You use Python's <a href="http://docs.python.org/2/tutorial/classes.html#private-variables-and-class-local-references" rel="nofollow">private variables</a> in a couple of places: <code>__is_escaped</code>, <code>__expand_where_clause</code>, <code>__replace_backticks</code>. This makes it impossible to test or experiment with these methods. You should use private variables only when you absolutely have to to avoid name clashes.</p></li>
<li><p>There's a method <code>enclose_str</code> but it does not seem to be called.</p></li>
<li><p>Many more problems which I have not the will to type up ... basically this is far from ready for anyone to use.</p></li>
</ol>

<p>Responding to your comments:</p>

<ul>
<li><p>To #3, you say, "I needed a way to pass a 'main' database connection to other modules". But this doesn't explain why <code>Database</code> inherits from <code>Singleton</code>. Why can't you just write:</p>

<pre><code>main_db = Database(...)
</code></pre>

<p>and then pass <code>main_db</code> to the other modules? You should beware of letting a local concern (your program needs a main database connection) influence the design of a module that is supposed to be general.</p>

<p>You go on to say, "you can have how many you instances you like". But in the <a href="http://en.wikipedia.org/wiki/Singleton_pattern" rel="nofollow">singleton pattern</a> there can be at most <em>one</em> instance of the class. Hence the name. So I don't understand this remark.</p></li>
<li><p>To #4, you indicate that you don't think it's the responsibility of your class to avoid SQL injection attacks. That's fair enough, but one of the most important reasons to use an object-relational mapping system is that it takes care of this task, which is difficult and tedious to get right.</p></li>
<li><p>To #10, you say, "I'd rather have it take multiple types and return multiple types than write 3 separate functions." Yes, of course, as an implementor you want to make things easy for yourself. But I'm looking at your code from the perspective of a user or maintainer, and I would prefer interfaces to be simple and easy to understand.</p>

<p>In any case, how hard is it to write:</p>

<pre><code>def escape_list(self, seq):
    """Escape all the elements in seq, and return them as a list."""
    return map(self.escape, seq)
</code></pre></li>
</ul>
</div>
    <table class="fw">
    <tr>
    <td class="vt">











<div class="post-menu"><a href="/a/24880" title="short permalink to this answer" class="short-link" id="link-post-24880">share</a><span class="lsep">|</span><a href="/posts/24880/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">

<div class="user-info ">
    <div class="user-action-time">
        
        
        <a href="/posts/24880/revisions" title="show all edits to this post">edited <span title="2013-04-09 08:46:27Z" class="relativetime">Apr 9 at 8:46</span></a>
        

    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        <br>
        
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    
<div class="user-info user-hover">
    <div class="user-action-time">
        
        
            answered <span title="2013-04-08 23:33:33Z" class="relativetime">Apr 8 at 23:33</span>
        

    </div>
    <div class="user-gravatar32">
        <a href="/users/11728/gareth-rees"><div><img src="https://www.gravatar.com/avatar/093d6dc5c8295d32bcb8e76c7c66455a?s=32&d=identicon&r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/11728/gareth-rees">Gareth Rees</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">5,201</span><span title="4 silver badges"><span class="badge2"></span><span class="badgecount">4</span></span><span title="23 bronze badges"><span class="badge3"></span><span class="badgecount">23</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-24880" class="comments" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">

    <tr id="comment-38449" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">First, thanks for the answer. Since I&#39;m a bit of a newbie, this helps a lot. All of your points are valid, though I&#39;d like to discuss a few
3.I needed a way to pass a &quot;main&quot; database connection to other modules. Appart from that, you can have how many you instances you like.
4. enclose_sys doesn&#39;t escape <b>any</b> parameter. If one needs the marginal case of allowing users access to the structure of the table, he should do the escaping himself(should be written in the docs though).
10.E.g.&quot;escape&quot;, I&#39;d rather have it take multiple types and return multiple types than write 3 separate functions.</span>
	&ndash;&nbsp;
		<a href="/users/23931/vlad" 
		   title="8 reputation" 
		   class="comment-user owner">Vlad</a>
	<span class="comment-date" dir="ltr"><span title="2013-04-09 01:31:53Z" class="relativetime-clean">Apr 9 at 1:31</span></span>
		<span class="edited-yes" title="this comment was edited 1 time"></span>
				</div>

        </td>
    </tr>
    <tr id="comment-38474" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">3.Singleton is an bad name choice, I do agree, but I couldn&#39;t find a better one. It&#39;s more of a &quot;main/default instance, but allow instantiation through the constructor as well if you need another&quot;. The whole Singleton class itself is just a bunch of static methods anyway(get/set/clear).
4.Yes it is, but I&#39;ve yet to hear of escaping system identifiers(column names). Solved it by removing whitespace check &amp; raising when I encounter a &quot; character.
10.I&#39;m not lazy, I just thought it was a more elegant solution. E.g. the list function, which does 2 things(unpacks if iterable, list of 1 if not).</span>
	&ndash;&nbsp;
		<a href="/users/23931/vlad" 
		   title="8 reputation" 
		   class="comment-user owner">Vlad</a>
	<span class="comment-date" dir="ltr"><span title="2013-04-09 10:35:44Z" class="relativetime-clean">Apr 9 at 10:35</span></span>
		<span class="edited-yes" title="this comment was edited 1 time"></span>
				</div>

        </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-24880" data-rep=50 data-anon=true
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”." 
				>add comment</a>
    </td>
</tr>
    </table>
</div>
<div class="newsletter-anon">
    <img src="//cdn.sstatic.net/codereview/img/apple-touch-icon.png" class="newsletter-logo" />
    <div class="newsletter-container">
        <h2>Did you find this question interesting? Try our newsletter</h2>
        <p class="newsletter-description">
            Sign up for our newsletter and get our top new questions delivered to your inbox (<a href="http://stackexchange.com/newsletters/newsletter?site=codereview.stackexchange.com" id="newsletter-preview">see an example</a>).
        </p>
        <form id="anon-newsletter-form">
            <input type="email" id="newsletter-email-input" />
            <span class="edit-field-overlay">email address</span>
            <input type="submit" value="Subscribe" id="newsletter-email-submit" />            
        </form>
    </div>
</div>
<script>
    StackExchange.ready(function () {
        StackExchange.newsletterAd.init();
    });
    
    StackExchange.helpers.bindHelpOverlayEvents($("#newsletter-email-input"));
    
    StackExchange.using("gps", function () {
        StackExchange.gps.track("newsletter.show", { newsletter_type: "nlquestionad" }, true);
    });
    
    $('#anon-newsletter-form').submit(function () {
        var $form = $(this);
        var $input = $form.find('#newsletter-email-input');
        var $submit = $form.find('#newsletter-email-submit');

        var email = $.trim($input.val());
        if (email.length == 0) {
            return false;
        }
        StackExchange.helpers.addSpinner($form);

        $.ajax({
            url: '/newsletter/signup/anon',
            type: 'POST',
            dataType: 'json',
            data: { email: email, viaAnonNewsletterAd: true },
            success: function (data) {
                if (data.status == 'confirmed' && !data.error) {
                    $input.attr('disabled', true);
                    $submit.replaceWith('<div style="margin-top: 10px;"><strong>Subscribed!</strong></div>');
                }
                else if (data.status == 'unconfirmed' && !data.error) {
                    $input.attr('disabled', true);
                    $submit.replaceWith('<div style="margin-top: 10px;"><strong>Success!</strong> Please click the link in the confirmation email to activate your subscription.</div>');
                }
                else {
                    $form.showErrorMessage(data.error || 'There was a problem signing up for the newsletter. Please try again later.');
                }
            },
            error: function () {
                $form.showErrorMessage('There was a problem signing up for the newsletter. Please try again later.');
            },
            complete: function () {
                StackExchange.helpers.removeSpinner($form);
            }
        });

        return false;
    });
</script>
  
<a name="24879"></a>
<div id="answer-24879" class="answer" data-answerid="24879" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="24879">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">1</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>



<td class="answercell">
    <div class="post-text"><p>There's quite a lot of code so I'm going to comment only this small piece of code :</p>

<pre><code>results = cur.fetchall();
n = len(results);
cols = self.table_columns(None, cur);
retval = [];
for i in range(0,n):
    aux = results[i];
    row = {};
    for j in range(0,len(cols)):
        row[cols[j]] = aux[j];
    if len(row):
        retval.append(row);
return retval
</code></pre>

<ol>
<li>You don't need <code>;</code> at the end of the lines</li>
<li>The best way to iterate on <code>something</code> in Python is via <code>for element in something</code> (or <code>for element,index in enumerate(something)</code> if you need the index).</li>
<li>You can use the fact that the boolean evaluation of an empty container is false to write <code>if row</code> instead of <code>if len(row)</code>.</li>
</ol>

<p>Your code is now :</p>

<pre><code>results = cur.fetchall();
cols = self.table_columns(None, cur);
retval = [];
for res in results:
    row = {};
    for col,j in enumerate(cols):
        row[col] = res[j];
    if row:
        retval.append(row);
return retval
</code></pre>

<p>Now, you can create your <code>row</code> dictionnary direclty from <code>res</code> and <code>cols</code> (other solutions can be found <a href="http://stackoverflow.com/questions/209840/map-two-lists-into-a-dictionary-in-python">on SO</a>):</p>

<pre><code>results = cur.fetchall();
cols = self.table_columns(None, cur);
retval = [];
for res in results:
    row = dict(zip(cols,res))
    if row:
        retval.append(row);
return retval
</code></pre>

<p>Now, there would be a way to make the whole thing a single expression using list comprehension but I am not quite sure this is a good idea.</p>
</div>
    <table class="fw">
    <tr>
    <td class="vt">











<div class="post-menu"><a href="/a/24879" title="short permalink to this answer" class="short-link" id="link-post-24879">share</a><span class="lsep">|</span><a href="/posts/24879/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    
<div class="user-info user-hover">
    <div class="user-action-time">
        
        
            answered <span title="2013-04-08 23:08:16Z" class="relativetime">Apr 8 at 23:08</span>
        

    </div>
    <div class="user-gravatar32">
        <a href="/users/9452/josay"><div><img src="https://www.gravatar.com/avatar/24bd9c10b20c8f7bdc26ae6055a155f7?s=32&d=identicon&r=PG&f=1" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/9452/josay">Josay</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">2,906</span><span title="2 silver badges"><span class="badge2"></span><span class="badgecount">2</span></span><span title="12 bronze badges"><span class="badge3"></span><span class="badgecount">12</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-24879" class="comments dno" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">
					    <tr><td></td><td></td></tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-24879" data-rep=50 data-anon=true
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”." 
				>add comment</a>
    </td>
</tr>
    </table>
</div>
									<a name='new-answer'></a>
						<form id="post-form" action="/questions/24875/answer/submit" method="post"  class="post-form">
							<input type="hidden" id="post-id" value="24875" />
							<h2 class="space">Your Answer</h2>



    

<script type="text/javascript">
    StackExchange.ready(function() {
        initTagRenderer("".split(" "), "".split(" "));
         
        prepareEditor({
            heartbeatType: 'answer',
            bindNavPrevention: true,
            postfix: "",
            onDemand: true,
            discardSelector: ".discard-answer"
            ,immediatelyShowMarkdownHelp:true
        });
        

    });  
</script>


<div id="post-editor" class="post-editor">

    <div style="position: relative;">     
        <div class="wmd-container">
            <div id="wmd-button-bar" class="wmd-button-bar"></div>
            <textarea id="wmd-input" class="wmd-input" name="post-text" cols="92" rows="15" tabindex="101" data-min-length=""></textarea>
        </div>
    </div>

    <div class="fl" style="margin-top: 8px; height:24px;">&nbsp;</div>
    <div id="draft-saved" class="draft-saved community-option fl" style="margin-top: 8px; height:24px; display:none;">draft saved</div>

    <div id="draft-discarded" class="draft-discarded community-option fl" style="margin-top: 8px; height:24px; display:none;">draft discarded</div>



    <div id="wmd-preview" class="wmd-preview"></div>
    <div></div>
    <div class="edit-block">
        <input id="fkey" name="fkey" type="hidden" value="6c07fd052a87c08ef3cc6e062a9ff978">
        <input id="author" name="author" type="text">
    </div>
</div>
							<div style="position: relative;">
								
            <div class="form-item dno new-post-login">
        
                <div class="new-login-form">
                    <div class="new-login-left">
                        <h3>Sign up or <a id="login-link" href="/users/login?returnurl=%2fquestions%2f24875%2flooking-for-python-code-review-of-database-abstraction-class%23new-answer">login</a></h3>
                        <script type="text/javascript">
                            StackExchange.ready(function () {
                                StackExchange.helpers.onClickDraftSave('#login-link');
                            });
                        </script>
                        <div class="preferred-login google-login">
                            <p><span class="icon"></span><span>Sign up using Google</span></p>
                        </div>
                        <div class="preferred-login facebook-login">
                            <p><span class="icon"></span><span>Sign up using Facebook</span></p>
                        </div>
                        <div class="preferred-login stackexchange-login">
                            <p><span class="icon"></span><span>Sign up using Stack Exchange</span></p>
                        </div>
                    </div>
                    <input type="hidden" name="manual-openid" class="manual-openid" />
                    <input type="hidden" name="use-facebook" class="use-facebook" value="false" />
                    <input type="button" class="submit-openid" value="Submit" style="display:none" />
                    <div class="new-login-right">
                                <h3>Post as a guest</h3>
    <div class="form-item">
        <table>
        <tr>
                    <script type="text/javascript">
                StackExchange.ready(function () {
                    StackExchange.helpers.bindHelpOverlayEvents($('.vm input'));
                });
            </script>
            <td class="vm">
                <div>
                    <label for="display-name">Name</label>
                    <input id="display-name" name="display-name" type="text" size="30" maxlength="30" value="" tabindex="105">
                </div>
                <div>
                    <label for="m-address">Email</label>
                    <input id="m-address" name="m-address" type="text" size="30" maxlength="100" value="" tabindex="106">
                    <span class="edit-field-overlay">required, but not shown</span>
                </div>
            </td>
        </tr>
        </table>
    </div>

                    </div>
                </div>
            </div>
            <script type="text/javascript">
                StackExchange.ready(
                    function () {
                        StackExchange.openid.initPostLogin('.new-post-login', '%2fquestions%2f24875%2flooking-for-python-code-review-of-database-abstraction-class%23new-answer');
                    }
                );
            </script>
            <noscript>
                        <h3>Post as a guest</h3>
    <div class="form-item">
        <table>
        <tr>
                    <script type="text/javascript">
                StackExchange.ready(function () {
                    StackExchange.helpers.bindHelpOverlayEvents($('.vm input'));
                });
            </script>
            <td class="vm">
                <div>
                    <label for="display-name">Name</label>
                    <input id="display-name" name="display-name" type="text" size="30" maxlength="30" value="" tabindex="105">
                </div>
                <div>
                    <label for="m-address">Email</label>
                    <input id="m-address" name="m-address" type="text" size="30" maxlength="100" value="" tabindex="106">
                    <span class="edit-field-overlay">required, but not shown</span>
                </div>
            </td>
        </tr>
        </table>
    </div>

            </noscript>
							</div>
           
															<div class="form-submit cbt">
									<input id="submit-button" type="submit" value="Post Your Answer" tabindex="110">
									<a href="#" class="discard-answer dno">discard</a>

<p class="privacy-policy-agreement">
By posting your answer, you agree to the <a href='http://stackexchange.com/legal/privacy-policy' target='_blank'>privacy policy</a> and <a href='http://stackexchange.com/legal/terms-of-service' target='_blank'>terms of service</a>.</p>
<input type="hidden" name="legalLinksShown" value="1" />								</div>
						</form>



						<h2 class="bottom-notice">
Not the answer you&#39;re looking for?							Browse other questions tagged <a href="/questions/tagged/python" class="post-tag" title="show questions tagged &#39;python&#39;" rel="tag">python</a> <a href="/questions/tagged/clean-code" class="post-tag" title="show questions tagged &#39;clean-code&#39;" rel="tag">clean-code</a>  or <a href="/questions/ask">ask your own question</a>.						</h2>
			</div>
		</div>
				<div id="sidebar" class="show-votes">
							<div class="module question-stats">
					<p class="label-key">tagged</p>
					<div class="tagged"><a href="/questions/tagged/python" class="post-tag" title="show questions tagged &#39;python&#39;" rel="tag">python</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">&times;</span>&nbsp;<span class="item-multiplier-count">1117</span></span><br>
<a href="/questions/tagged/clean-code" class="post-tag" title="show questions tagged &#39;clean-code&#39;" rel="tag">clean-code</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">&times;</span>&nbsp;<span class="item-multiplier-count">305</span></span><br>
</div>
					<table id="qinfo">
						<tr>
							<td>
								<p class="label-key">asked</p>
							</td>
							<td style="padding-left: 10px">
								<p class="label-key" title="2013-04-08 22:34:04Z"><b>7 months ago</b></p>
							</td>
						</tr>
						<tr>
							<td>
								<p class="label-key">viewed</p>
							</td>

							<td style="padding-left: 10px">
								<p class="label-key">
									<b>78 times</b>
								</p>
							</td>
						</tr>
							<tr>
								<td>
									<p class="label-key">active</p>
								</td>
								<td style="padding-left: 10px">
									<p class="label-key"><b><a href="?lastactivity" class="lastactivity-link" title="2013-04-09 08:46:27Z">7 months ago</a></b></p>
								</td>
							</tr>
					</table>
				</div>
						
			

<style type="text/css">
    .ads { margin-left: 60px; }
    .ad-container { width: 220px; height: 250px; margin-right: 20px; margin-bottom: 20px; }
    .ad-container .ad { height: 250px; }
    .ad-container .footer-container { overflow: hidden; height: 30px; position: relative; top: -30px; }
    .ad-container .footer-container .footer { font-family: Arial,Helvetic,Sans-Serif; font-size: 12px; text-align: center; padding-top: 9px; background-color: #000; color: #EFF; opacity: 0.9; filter: alpha(opacity=90); top: 30px; height: 30px; position: relative; }
    .ad-container a:hover { text-decoration: underline; }
    #adzerk2 { height: 250px; }
</style>
<script type="text/javascript">
    StackExchange.ready(function () {
        $(".ad-container").hover(
            function () {
                $(".ad-container .footer-container .footer").stop(true, true).animate({ top: "0px" }, "fast");
            },
            function () {
                $(".ad-container .footer-container .footer").animate({ top: "30px" }, "fast");
            });
    });
</script>
    <script type="text/javascript">
        var z = document.createElement("script"); z.type = "text/javascript"; z.async = true; z.src = 'http://engine.adzerk.net/z/12057/adzerk2_2_17_76?keywords=x-host-codereview.stackexchange.com'; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(z, s);
    </script>
    <div class="everyonelovesstackoverflow" id="adzerk2">
    </div>  

			  
    
            

				<div class="module sidebar-related">
					<h4 id="h-related">Related</h4>
					<div class="related" data-tracker="rq=1">
						<div class="spacer">
<a href="/q/2280" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">3
    </div>
</a><a href="/questions/2280/code-review-for-my-binary-tree-in-python" class="question-hyperlink">Code review for my binary tree in python</a>
</div>
<div class="spacer">
<a href="/q/10481" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">2
    </div>
</a><a href="/questions/10481/lazy-class-instantiation-in-python" class="question-hyperlink">Lazy class instantiation in Python</a>
</div>
<div class="spacer">
<a href="/q/11419" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">3
    </div>
</a><a href="/questions/11419/baseball-game-state-class-in-python-looking-for-feedback" class="question-hyperlink">Baseball game state class in python looking for feedback</a>
</div>
<div class="spacer">
<a href="/q/18399" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">3
    </div>
</a><a href="/questions/18399/code-review-of-forwarding-sequence" class="question-hyperlink">Code review of forwarding sequence</a>
</div>
<div class="spacer">
<a href="/q/20837" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">1
    </div>
</a><a href="/questions/20837/python-twitter-parser-looking-for-general-code-review" class="question-hyperlink">Python Twitter parser, looking for general code review</a>
</div>
<div class="spacer">
<a href="/q/23929" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">3
    </div>
</a><a href="/questions/23929/improve-the-design-of-class-accuracy-in-python" class="question-hyperlink">improve the design of class “accuracy” in Python</a>
</div>
<div class="spacer">
<a href="/q/25250" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">1
    </div>
</a><a href="/questions/25250/code-review-for-an-abstract-repository-implementation" class="question-hyperlink">Code review for an abstract repository implementation</a>
</div>
<div class="spacer">
<a href="/q/27900" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">2
    </div>
</a><a href="/questions/27900/python-polynomial-operations-class" class="question-hyperlink">Python &mdash; polynomial operations class</a>
</div>
<div class="spacer">
<a href="/q/27987" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">2
    </div>
</a><a href="/questions/27987/python-class-to-abstract-the-iptables-linux-firewall" class="question-hyperlink">Python class to abstract the iptables Linux firewall</a>
</div>
<div class="spacer">
<a href="/q/28254" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">2
    </div>
</a><a href="/questions/28254/python-out-of-order-class-resequencer" class="question-hyperlink">Python out of order class resequencer</a>
</div>

					</div>
				</div>
		</div>
	
<div id="feed-link">
    <div id="feed-link-text"><a href="/feeds/question/24875" title="feed of this question and its answers"><span class="feed-icon"></span>question feed</a></div>
</div>
	<script type="text/javascript">
StackExchange.ready(function(){$.get('/posts/24875/ivc/72e8');});
</script>
<noscript>
    <div><img src="/posts/24875/ivc/72e8" class="dno" alt="" width="0" height="0"></div>
</noscript><div style="display:none" id="prettify-lang">lang-py</div></div>


        </div>
    </div>
    <div id="footer" class="categories">
        <div class="footerwrap">
            <div id="footer-menu">
                <div class="top-footer-links">
                        <a href="/about">about</a>
                    <a href="/help">help</a>
                        <a href="/help/badges">badges</a>
                    <a href="http://blog.stackexchange.com?blb=1">blog</a>
                        <a href="http://chat.stackexchange.com">chat</a>
                    <a href="http://data.stackexchange.com">data</a>
                    <a href="http://stackexchange.com/legal">legal</a>
                    <a href="http://stackexchange.com/legal/privacy-policy">privacy policy</a>
                    <a href="http://stackexchange.com/about/hiring">jobs</a>
                    <a href="http://stackexchange.com/about/contact">advertising info</a>

                    <a onclick='StackExchange.switchMobile("on", "/questions/24875/looking-for-python-code-review-of-database-abstraction-class")'>mobile</a>
                    <b><a href="/contact">contact us</a></b>
                        <b><a href="http://meta.codereview.stackexchange.com">feedback</a></b>
                    
                </div>
                <div id="footer-sites">
                    <table>
    <tr>
            <th colspan=3>
                Technology
            </th>
            <th >
                Life / Arts
            </th>
            <th >
                Culture / Recreation
            </th>
            <th >
                Science
            </th>
            <th >
                Other
            </th>
    </tr>
    <tr>
            <td>
                <ol>
                        <li><a href="http://stackoverflow.com" title="professional and enthusiast programmers">Stack Overflow</a></li>
                        <li><a href="http://serverfault.com" title="professional system and network administrators">Server Fault</a></li>
                        <li><a href="http://superuser.com" title="computer enthusiasts and power users">Super User</a></li>
                        <li><a href="http://webapps.stackexchange.com" title="power users of web applications">Web Applications</a></li>
                        <li><a href="http://askubuntu.com" title="Ubuntu users and developers">Ask Ubuntu</a></li>
                        <li><a href="http://webmasters.stackexchange.com" title="pro webmasters">Webmasters</a></li>
                        <li><a href="http://gamedev.stackexchange.com" title="professional and independent game developers">Game Development</a></li>
                        <li><a href="http://tex.stackexchange.com" title="users of TeX, LaTeX, ConTeXt, and related typesetting systems">TeX - LaTeX</a></li>
                            </ol></td><td><ol>
                        <li><a href="http://programmers.stackexchange.com" title="professional programmers interested in conceptual questions about software development">Programmers</a></li>
                        <li><a href="http://unix.stackexchange.com" title="users of Linux, FreeBSD and other Un*x-like operating systems.">Unix &amp; Linux</a></li>
                        <li><a href="http://apple.stackexchange.com" title="power users of Apple hardware and software">Ask Different (Apple)</a></li>
                        <li><a href="http://wordpress.stackexchange.com" title="WordPress developers and administrators">WordPress Answers</a></li>
                        <li><a href="http://gis.stackexchange.com" title="cartographers, geographers and GIS professionals">Geographic Information Systems</a></li>
                        <li><a href="http://electronics.stackexchange.com" title="electronics and electrical engineering professionals, students, and enthusiasts">Electrical Engineering</a></li>
                        <li><a href="http://android.stackexchange.com" title="enthusiasts and power users of the Android operating system">Android Enthusiasts</a></li>
                        <li><a href="http://security.stackexchange.com" title="Information security professionals">Information Security</a></li>
                            </ol></td><td><ol>
                        <li><a href="http://dba.stackexchange.com" title="database professionals who wish to improve their database skills and learn from others in the community">Database Administrators</a></li>
                        <li><a href="http://drupal.stackexchange.com" title="Drupal developers and administrators">Drupal Answers</a></li>
                        <li><a href="http://sharepoint.stackexchange.com" title="SharePoint enthusiasts">SharePoint</a></li>
                        <li><a href="http://ux.stackexchange.com" title="user experience researchers and experts">User Experience</a></li>
                        <li><a href="http://mathematica.stackexchange.com" title="users of Mathematica">Mathematica</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#technology" class="more">
                                more (14)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://photo.stackexchange.com" title="professional, enthusiast and amateur photographers">Photography</a></li>
                        <li><a href="http://scifi.stackexchange.com" title="science fiction and fantasy enthusiasts">Science Fiction &amp; Fantasy</a></li>
                        <li><a href="http://cooking.stackexchange.com" title="professional and amateur chefs">Seasoned Advice (cooking)</a></li>
                        <li><a href="http://diy.stackexchange.com" title="contractors and serious DIYers">Home Improvement</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#lifearts" class="more">
                                more (13)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://english.stackexchange.com" title="linguists, etymologists, and serious English language enthusiasts">English Language &amp; Usage</a></li>
                        <li><a href="http://skeptics.stackexchange.com" title="scientific skepticism">Skeptics</a></li>
                        <li><a href="http://judaism.stackexchange.com" title="those who base their lives on Jewish law and tradition and anyone interested in learning more">Mi Yodeya (Judaism)</a></li>
                        <li><a href="http://travel.stackexchange.com" title="road warriors and seasoned travelers">Travel</a></li>
                        <li><a href="http://christianity.stackexchange.com" title="committed Christians, experts in Christianity and those interested in learning more">Christianity</a></li>
                        <li><a href="http://gaming.stackexchange.com" title="passionate videogamers on all platforms">Arqade (gaming)</a></li>
                        <li><a href="http://bicycles.stackexchange.com" title="people who build and repair bicycles, people who train cycling, or commute on bicycles">Bicycles</a></li>
                        <li><a href="http://rpg.stackexchange.com" title="gamemasters and players of tabletop, paper-and-pencil role-playing games">Role-playing Games</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#culturerecreation" class="more">
                                more (21)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://math.stackexchange.com" title="people studying math at any level and professionals in related fields">Mathematics</a></li>
                        <li><a href="http://stats.stackexchange.com" title="statisticians, data analysts, data miners and data visualization experts">Cross Validated (stats)</a></li>
                        <li><a href="http://cstheory.stackexchange.com" title="theoretical computer scientists and researchers in related fields">Theoretical Computer Science</a></li>
                        <li><a href="http://physics.stackexchange.com" title="active researchers, academics and students of physics">Physics</a></li>
                        <li><a href="http://mathoverflow.net" title="professional mathematicians">MathOverflow</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#science" class="more">
                                more (7)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://stackapps.com" title="apps, scripts, and development with the Stack Exchange API">Stack Apps</a></li>
                        <li><a href="http://meta.stackoverflow.com" title="meta-discussion of the Stack Exchange family of Q&amp;A websites">Meta Stack Overflow</a></li>
                        <li><a href="http://area51.stackexchange.com" title="proposing new sites in the Stack Exchange network">Area 51</a></li>
                        <li><a href="http://careers.stackoverflow.com">Stack Overflow Careers</a></li>
                    
                </ol>
            </td>
    </tr>
</table>
                </div>
            </div>

            <div id="copyright">
                site design / logo &#169; 2013 stack exchange inc; user contributions licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license">cc-wiki</a> 
 with <a href="http://blog.stackoverflow.com/2009/06/attribution-required/" rel="license">attribution required</a>
            </div>
            <div id="footer-flair">
                <a href="http://creativecommons.org/licenses/by-sa/3.0/" class="cc-wiki-link"></a>
            </div>
            <div id="svnrev">
                rev 2013.11.26.1178
            </div>
            
        </div>
    </div>
    <noscript>
        <div id="noscript-warning">Code Review Stack Exchange works best with JavaScript enabled<img src="http://pixel.quantserve.com/pixel/p-c1rF4kxgLUzNc.gif" alt="" class="dno"></div>
    </noscript>

    <script type="text/javascript">var _gaq=_gaq||[];_gaq.push(['_setAccount','UA-5620270-24']);
        _gaq.push(['_setDomainName','.stackexchange.com']);
        _gaq.push(['_setCustomVar', 1, 'tags', '|python|clean-code|']); 
_gaq.push(['_trackPageview']);
    var _qevents = _qevents || [];
    var _comscore = _comscore || [];
    (function () {
        var ssl='https:'==document.location.protocol,
            s=document.getElementsByTagName('script')[0],
            ga=document.createElement('script');
        ga.type='text/javascript';
        ga.async=true;
        ga.src=(ssl?'https://ssl':'http://www')+'.google-analytics.com/ga.js';
        s.parentNode.insertBefore(ga,s);
        var sc=document.createElement('script');
        sc.type='text/javascript';
        sc.async=true;
        sc.src=(ssl?'https://secure':'http://edge')+'.quantserve.com/quant.js';
        s.parentNode.insertBefore(sc, s);
        
        var s = document.createElement("script"), el = document.getElementsByTagName("script")[0]; s.async = true;
        s.src = (document.location.protocol == "https:" ? "https://sb" : "http://b") + ".scorecardresearch.com/beacon.js";
        el.parentNode.insertBefore(s, el);
        
    })();
    _comscore.push({ c1: "2", c2: "17440561" });
    _qevents.push({ qacct: "p-c1rF4kxgLUzNc" });
    </script>            
</body>
</html>