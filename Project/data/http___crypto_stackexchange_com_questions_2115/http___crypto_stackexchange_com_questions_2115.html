<!DOCTYPE html>
<html>
<head>
    
    <title>mac - Is SHA1 secure with such many inputs Z that Z = constant secret X + variable public Y? - Cryptography Stack Exchange</title>
    <link rel="shortcut icon" href="//cdn.sstatic.net/crypto/img/favicon.ico">
    <link rel="apple-touch-icon image_src" href="//cdn.sstatic.net/crypto/img/apple-touch-icon.png">
    <link rel="search" type="application/opensearchdescription+xml" title="Cryptography Stack Exchange" href="/opensearch.xml">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@StackCrypto" />
    <meta name="twitter:domain" content="crypto.stackexchange.com"/>
    <meta name="og:type" content="website" />
    <meta name="og:image" content="http://cdn.sstatic.net/crypto/img/apple-touch-icon.png?v=4eff82ce3a8b"/>
    <meta name="og:title" content="Is SHA1 secure with such many inputs Z that Z = constant secret X + variable public Y?" />
    <meta name="og:description" content="Let me ask whether SHA1 is designed to be secure for the following case.
You compute each SHA1 of many strings,for example 1 million, where each string is a concatenation of X+Y ,
where X is secret..." />
    <meta name="og:url" content="http://crypto.stackexchange.com/questions/2115/is-sha1-secure-with-such-many-inputs-z-that-z-constant-secret-x-variable-pub"/>
    <link rel="canonical" href="http://crypto.stackexchange.com/questions/2115/is-sha1-secure-with-such-many-inputs-z-that-z-constant-secret-x-variable-pub" />

    
    
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="//cdn.sstatic.net/Js/stub.en.js?v=e3d47b73fa12" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="//cdn.sstatic.net/crypto/all.css?v=67e9087155b1">
    
    <link rel="alternate" type="application/atom+xml" title="Feed for question &#39;Is SHA1 secure with such many inputs Z that Z = constant secret X + variable public Y?&#39;" href="/feeds/question/2115">
    <script type="text/javascript">
        
        StackExchange.ready(function () {
            StackExchange.using("postValidation", function () {
                StackExchange.postValidation.initOnBlurAndSubmit($('#post-form'), 2, 'answer');
            });

            
            StackExchange.question.init({showAnswerHelp:true,totalCommentCount:1,shownCommentCount:1,highlightColor:'#F4A83D',backgroundColor:'#FFF',questionId:2115});

            styleCode();

                StackExchange.realtime.subscribeToQuestion('281', '2115');
            
                    });
    </script>

                <script type="text/x-mathjax-config">
                    MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
                                        tex2jax: { inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ], displayMath: [ ["$$","$$"], ["\\[", "\\]"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno" },
                                        TeX: {  noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } }, Macros: { href: "{}" } },
                                        messageStyle: "none"
                });
                </script>
                <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>                

    <script type="text/javascript">
        StackExchange.ready(function () {
            StackExchange.realtime.init('wss://qa.sockets.stackexchange.com,ws://qa.sockets.stackexchange.com');
            StackExchange.realtime.subscribeToInboxNotifications();
                    StackExchange.realtime.subscribeToReputationNotifications('281');
                        });
    </script>
    <script type="text/javascript">
        StackExchange.init({"locale":"en","stackAuthUrl":"https://stackauth.com","serverTime":1385433375,"enableUserHovercards":true,"site":{"name":"Cryptography Stack Exchange","description":"Q&A for software developers, mathematicians and others interested in cryptography","isNoticesTabEnabled":true,"recaptchaPublicKey":"6LdsB7sSAAAAAAzjgEF_Hd8vXv-C42sa_KyofaGR","enableSocialMediaInSharePopup":true},"user":{"fkey":"f51c005c36aeb04be7163e16a81b52d5","isAnonymous":true}});
        StackExchange.using.setCacheBreakers({"js/prettify-full.en.js":"e0bbd4760e83","js/moderator.en.js":"1a411fd265fe","js/full-anon.en.js":"8a881a0975af","js/full.en.js":"e87912181c10","js/wmd.en.js":"bd9234d44a40","js/third-party/jquery.autocomplete.min.js":"e5f01e97f7c3","js/third-party/jquery.autocomplete.min.en.js":"","js/mobile.en.js":"d1d834ef85d2","js/help.en.js":"d3cc74d8a93a","js/tageditor.en.js":"6d51a5f8d7f3","js/tageditornew.en.js":"111b781cf314","js/inline-tag-editing.en.js":"f951bd09dc69","js/revisions.en.js":"33fd38144303","js/review.en.js":"f45b4ec094ea","js/tagsuggestions.en.js":"e4e7b952fcc7","js/post-validation.en.js":"c275fe37d674","js/explore-qlist.en.js":"73825bd006fc","js/events.en.js":"53bc48767091","js/mathjax-editing.en.js":"a09844f7b738"});
        StackExchange.using("gps", function() {
             StackExchange.gps.init(true);
        });
        
    </script>
    
        <script type="text/javascript">
            StackExchange.ready(function () {
                $('#nav-tour').click(function () {
                    StackExchange.using("gps", function() {
                        StackExchange.gps.track("aboutpage.click", { aboutclick_location: "headermain" }, true);
                    });
                });
            });
        </script>
</head>
<body class="question-page">
    <noscript><div id="noscript-padding"></div></noscript>
    <div id="notify-container"></div>
    <div id="overlay-header"></div>
    <div id="custom-header"></div>
    <div class="container">
        <div id="header" class=headeranon>
            <div id="portalLink">
                <a class="genu" href="http://stackexchange.com" onclick="StackExchange.ready(function(){genuwine.click();});return false;">Stack Exchange</a>
            </div>
            <div id="topbar">
                <div id="hlinks">
                    
<span id="hlinks-user"></span>
<span id="hlinks-nav">                        <a href="/users/login?returnurl=%2fquestions%2f2115%2fis-sha1-secure-with-such-many-inputs-z-that-z-constant-secret-x-variable-pub">sign up</a>

 <span class="lsep">|</span>
                    <a href="/users/login?returnurl=%2fquestions%2f2115%2fis-sha1-secure-with-such-many-inputs-z-that-z-constant-secret-x-variable-pub">log in</a>

 <span class="lsep">|</span>
</span>
<span id="hlinks-custom"></span>
                </div>
                <div id="hsearch">
                    <form id="search" action="/search" method="get" autocomplete="off">
                        <div>
                            <input autocomplete="off" name="q" class="textbox" placeholder="search" tabindex="1" type="text" maxlength="240" size="28" value="">
                        </div>
                    </form>
                </div>
            </div>
            <br class="cbt">
            <div id="hlogo">
                <a href="/">
                    Cryptography
                        <span class="beta-title">beta</span>
                </a>
            </div>
            <div id="hmenus">
                <div class="nav mainnavs mainnavsanon">
                    <ul>
                            <li class="youarehere"><a id="nav-questions" href="/questions">Questions</a></li>
                            <li><a id="nav-tags" href="/tags">Tags</a></li>
                            <li><a id="nav-tour" href="/about">Tour</a></li>
                            <li><a id="nav-users" href="/users">Users</a></li>
                    </ul>
                </div>
                <div class="nav askquestion">
                    <ul>
                        <li>
                            <a id="nav-askquestion"  href="/questions/ask">Ask Question</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        



        <div id="content">
            

<div itemscope itemtype="http://schema.org/Article">
	<link itemprop="image" href="//cdn.sstatic.net/crypto/img/apple-touch-icon.png">
			<!--googleoff: all-->
<div id="herobox-mini">
    <div id="hero-content">
        <span id="controls">
            <a href="/about" id="tell-me-more" class="button">Tell me more</a>
            <span id="close"><a title="click to dismiss">&times;</a></span>
        </span>
        <div id="blurb">
            Cryptography Stack Exchange is a question and answer site for software developers, mathematicians and others interested in cryptography. It&#39;s 100% free, no registration required.
        </div>        
    </div>
    <script>
        $('#tell-me-more').click(function () {
            var clickSource = $("body").attr("class") + '-mini';
            if ($("body").hasClass("questions-page")) {
                clickSource = 'questionpagemini';
            }
            if ($("body").hasClass("home-page")) {
                clickSource = 'homepagemini';
            }

            StackExchange.using("gps", function () {
                StackExchange.gps.track("aboutpage.click", { aboutclick_location: clickSource } , true);
            });
        });
        $('#herobox-mini #close').click(function () {
            StackExchange.using("gps", function () {
                StackExchange.gps.track("hero.action", { hero_action_type: "close" }, true);
            });
            $.cookie("hero", "none", { path: "/" });
            var $hero = $("#herobox-mini");
            $hero.slideUp('fast', function () { $hero.remove(); });
            return false;
        });
    </script>
</div>
			<!--googleon: all-->
			<div id="question-header">
			<h1 itemprop="name"><a href="/questions/2115/is-sha1-secure-with-such-many-inputs-z-that-z-constant-secret-x-variable-pub" class="question-hyperlink">Is SHA1 secure with such many inputs Z that Z = constant secret X + variable public Y?</a></h1>
		</div>
			<div id="mainbar">

			

<div class="question" data-questionid="2115"  id="question">
    
        <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="2115">
    <a class="vote-up-off" title="This question shows research effort; it is useful and clear">up vote</a>
    <span class="vote-count-post ">4</span>
    <a class="vote-down-off" title="This question does not show any research effort; it is unclear or not useful">down vote</a>
    
    <a class="star-off" href="#" title="This is a favorite question (click again to undo)">favorite</a>
    <div class="favoritecount"><b></b></div>   

</div>

            </td>
            
<td class="postcell">
<div>
    <div class="post-text" itemprop="description">

        <p>Let me ask whether SHA1 is designed to be secure for the following case.
You compute each SHA1 of many strings,for example 1 million, where each string is a concatenation of X+Y ,
where X is secret and constant and Y is public and variable.</p>

<p>Thank you in advance.</p>

    </div>
    <div class="post-taglist">
        <a href="/questions/tagged/mac" class="post-tag" title="show questions tagged &#39;mac&#39;" rel="tag">mac</a> <a href="/questions/tagged/sha1" class="post-tag" title="show questions tagged &#39;sha1&#39;" rel="tag">sha1</a> 
    </div>
    <table class="fw">
    <tr>
    <td class="vt">











<div class="post-menu"><a href="/q/2115" title="short permalink to this question" class="short-link" id="link-post-2115">share</a><span class="lsep">|</span><a href="/posts/2115/edit" class="suggest-edit-post" title="">improve this question</a></div>        
    </td>
    <td align="right" class="post-signature">

<div class="user-info user-hover">
    <div class="user-action-time">
        
        
        <a href="/posts/2115/revisions" title="show all edits to this post">edited <span title="2012-03-18 14:37:53Z" class="relativetime">Mar 18 '12 at 14:37</span></a>
        

    </div>
    <div class="user-gravatar32">
        <a href="/users/46/antony-vennard"><div class="gravatar-wrapper-32"><img src="http://i.stack.imgur.com/3WUyu.png?s=32&g=1" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/46/antony-vennard">Antony Vennard</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">2,812</span><span title="2 gold badges"><span class="badge1"></span><span class="badgecount">2</span></span><span title="11 silver badges"><span class="badge2"></span><span class="badgecount">11</span></span><span title="27 bronze badges"><span class="badge3"></span><span class="badgecount">27</span></span>
    </div>
</div>    </td>
    <td class="post-signature owner">
        
<div class="user-info ">
    <div class="user-action-time">
        
        
            asked <span title="2012-03-17 12:37:28Z" class="relativetime">Mar 17 '12 at 12:37</span>
        

    </div>
    <div class="user-gravatar32">
        <a href="/users/1703/seven-swodniw"><div><img src="https://www.gravatar.com/avatar/73f1ebc07a5d7205eaad07fd1d2cfd56?s=32&d=identicon&r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/1703/seven-swodniw">seven_swodniw</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">147</span><span title="3 bronze badges"><span class="badge3"></span><span class="badgecount">3</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</div>
</td>
        </tr>
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2115" class="comments" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">

    <tr id="comment-3398" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">You should explain what you want to protect against. i.e. what can an attacker do, and what do you want to prevent him from doing. You can&#39;t simply say some scheme is &quot;secure&quot;, you need to specify clearly what your requirements are.</span>
	&ndash;&nbsp;
		<a href="/users/180/codesinchaos" 
		   title="7572 reputation" 
		   class="comment-user">CodesInChaos</a>
	<span class="comment-date" dir="ltr"><span title="2012-03-18 09:28:14Z" class="relativetime-clean">Mar 18 '12 at 9:28</span></span>
				</div>

        </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-2115" data-rep=50 data-anon=true
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid answering questions in comments." 
				>add comment</a>
    </td>
</tr>            </table>    
</div>
    <div class="question-status">
        <h2>                <b>migrated</b> from <a href="http://math.stackexchange.com/questions/121293/is-sha1-secure-with-such-many-inputs-z-that-z-constant-secret-x-variable-pub?noredirect=1" title="is sha1 secure with such many inputs z that z constant secret x variable pub">math.stackexchange.com</a> <span title="2012-03-18 07:47:00Z" class="relativetime">Mar 18 '12 at 7:47</span>
</h2>
        <p>This question came from our site for people studying math at any level and professionals in related fields.</p>
    </div>


			<div id="answers">

				<a name="tab-top"></a>
				<div id="answers-header">
					<div class="subheader answers-subheader">
						<h2>
								2 Answers
						</h2>
						<div>
							<div id="tabs">
        <a href="/questions/2115/is-sha1-secure-with-such-many-inputs-z-that-z-constant-secret-x-variable-pub?answertab=active#tab-top" title="Answers with the latest activity first">active</a>
        <a href="/questions/2115/is-sha1-secure-with-such-many-inputs-z-that-z-constant-secret-x-variable-pub?answertab=oldest#tab-top" title="Answers in the order they were provided">oldest</a>
        <a class="youarehere" href="/questions/2115/is-sha1-secure-with-such-many-inputs-z-that-z-constant-secret-x-variable-pub?answertab=votes#tab-top" title="Answers with the highest score first">votes</a>
</div>
						</div>
					</div>    
				</div>    




  
<a name="2122"></a>
<div id="answer-2122" class="answer accepted-answer" data-answerid="2122" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="2122">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">6</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


        <span class="vote-accepted-on load-accepted-answer-date" title="loading when this answer was accepted...">accepted</span>
</div>

            </td>



<td class="answercell">
    <div class="post-text"><p>Answering the question as worded in its body: <strong>NO</strong>, $\mathrm{SHA1}$ is not <em>designed</em> so that the proposed construction is secure under the stated conditions. The design objective of the $\mathrm{SHA1}$ and $\mathrm{SHA2}$ hashes, <a href="http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf" rel="nofollow">as explained by NIST</a>, is that</p>

<blockquote>
  <p>it is computationally infeasible to find a message that corresponds to a given message digest, or to find two different messages that produce the same message digest.</p>
</blockquote>

<p>and this does not lead to the conclusion that the proposed construction is secure, under any reasonable definition.</p>

<hr>

<p>In order to answer the (different) question as worded in its title, we need to define "<em>secure</em>". The question is about a construction $F: (X,Y) \to F(X,Y) = \mathrm{SHA1}(X||Y)$. One possible definition of "<em>secure</em>" could be that $Y \to F(X,Y)$ is computationally indistinguishable from a random function for an attacker not knowing $X$ (which implies that $X$ does not leak from examples).</p>

<p>With this wide definition, <strong>NO</strong>, $\mathrm{SHA1}$ is not secure. It is vulnerable to a <a href="http://en.wikipedia.org/wiki/Cryptographic_hash_function#Properties" rel="nofollow"><em>length-extension attack</em></a>, a classical weakness of the <a href="http://en.wikipedia.org/wiki/Merkle%E2%80%93Damg%C3%A5rd_construction" rel="nofollow">Merkle–Damgård construction</a> used in $\mathrm{SHA1}$. An adversary knowing $\mathrm{SHA1}(X||Y)$ can compute $\mathrm{SHA1}(X||Y&#39;)$ for some $Y&#39;\ne Y$, on the conditions that $Y&#39;=Y||P||E$; and he knows $E$ and the length of $X||Y$; and $P$ is a specific 65-to-576-bit string depending only on that length. Having many examples of $(Y,\mathrm{SHA1}(X||Y))$ helps the adversary, in that it widens the choices for $Y&#39;$.</p>

<p>To perform this <em>length-extension attack</em>, the adversary can choose $P$ as the 65-to-576-bit string constituting the padding for $X||Y$ when computing $\mathrm{SHA1}(X||Y)$. Then, $\mathrm{SHA1}(X||Y||P||E)$ is computed by starting the normal computation where the block with $E$ starts, with the 160-bit hash state $\mathrm{SHA1}(X||Y)$ rather than the constant specified in $\mathrm{SHA1}$. The attack has very low cost, lower than if the adversary had computed $\mathrm{SHA1}(X||Y&#39;)$ directly with knowledge of $X||Y&#39;$.</p>

<hr>

<p>When the conditions for the <em>length-extension attack</em> are not met (including if the length of $Y$ is fixed, exactly or with a small leeway of +64 bits), or when the objective of the adversary is finding $X$, the construction proposed has considerable cryptanalytic resistance. Up to some limit on the size of $X$, we know no attack much better than <a href="http://en.wikipedia.org/wiki/Brute-force_attack" rel="nofollow">brute-forcing</a> $X$. A security argument could be given based on the assumption that the cipher used in the $\mathrm{SHA1}$ round function is secure; but we know that this assumption does not hold at all, if only because of some <a href="http://people.csail.mit.edu/yiqun/SHA1AttackProceedingVersion.pdf" rel="nofollow">near-practical attacks on the collision-resistance</a> of $\mathrm{SHA1}$. Therefore I can't quantify the level of resistance better than "AFAIK unbroken for practical purposes", which is not strong enough for a recommendation.</p>

<hr>

<p>Fortunately, there is a recommendable construct based on $\mathrm{SHA1}$ that is <em>designed</em> to be secure (in the wide definition we considered); this is <a href="http://en.wikipedia.org/wiki/HMAC" rel="nofollow">HMAC</a> with $\mathrm{SHA1}$ as the hash function, $X$ as the key, $Y$ as the message. This construction has a <a href="http://eprint.iacr.org/2006/043.pdf" rel="nofollow">security argument</a> that is not directly harmed by a collision-resistance attack on $\mathrm{SHA1}$. Although the absolute confidence we can have in this argument is the subject of <a href="http://eprint.iacr.org/2012/074.pdf" rel="nofollow">debate</a> and <a href="http://eprint.iacr.org/forum/read.php?12,604" rel="nofollow">some</a> <a href="http://jonkatz.wordpress.com/2012/02/28/correcting-errors-guest-post-by-yehuda-lindell/" rel="nofollow">controversy</a>, it is still very reassuring to me about the security of HMAC, and I am <a href="http://crypto.stackexchange.com/a/2035/555">not alone</a>.</p>
</div>
    <table class="fw">
    <tr>
    <td class="vt">











<div class="post-menu"><a href="/a/2122" title="short permalink to this answer" class="short-link" id="link-post-2122">share</a><span class="lsep">|</span><a href="/posts/2122/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">

<div class="user-info ">
    <div class="user-action-time">
        
        
        <a href="/posts/2122/revisions" title="show all edits to this post">edited <span title="2012-03-18 15:04:55Z" class="relativetime">Mar 18 '12 at 15:04</span></a>
        

    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        <br>
        
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    
<div class="user-info user-hover">
    <div class="user-action-time">
        
        
            answered <span title="2012-03-18 14:30:31Z" class="relativetime">Mar 18 '12 at 14:30</span>
        

    </div>
    <div class="user-gravatar32">
        <a href="/users/555/fgrieu"><div><img src="https://www.gravatar.com/avatar/3d2a3bdfce4372530b43f3d196407459?s=32&d=identicon&r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/555/fgrieu">fgrieu</a><br>
        <span class="reputation-score" title="reputation score 12490" dir="ltr">12.5k</span><span title="17 silver badges"><span class="badge2"></span><span class="badgecount">17</span></span><span title="49 bronze badges"><span class="badge3"></span><span class="badgecount">49</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2122" class="comments dno" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">
					    <tr><td></td><td></td></tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-2122" data-rep=50 data-anon=true
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”." 
				>add comment</a>
    </td>
</tr>
    </table>
</div>

  
<a name="2116"></a>
<div id="answer-2116" class="answer" data-answerid="2116" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="2116">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">3</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>



<td class="answercell">
    <div class="post-text"><p>I'd recommend <a href="http://en.wikipedia.org/wiki/HMAC" rel="nofollow">HMAC</a>. It's designed to mix a key and a message in a secure way.</p>

<pre><code>HMAC(K,m) = H((Key ⊕ opad) ∥ H((Key ⊕ ipad) ∥ Message)).
</code></pre>

<p>Where <code>H</code> is a normal hash function such as SHA1, <code>opad</code> and <code>ipad</code> are constants. <code>∥</code> stands for concatenation.</p>

<p>The main disadvantage of HMAC is that it requires two hash function calls, which makes significantly more expensive for short messages, whereas for large messages the overhead is negligible. But as always, only optimize if benchmarks indicate that something is a bottleneck. Typically IO is much slower than crypto.</p>

<hr>

<p>Your construction is vulnerable to length extension attacks. An attacker who knows <code>SHA1(Key ∥ Message)</code> can compute <code>SHA1(Key ∥ Message ∥ EvilMessage)</code></p>
</div>
    <table class="fw">
    <tr>
    <td class="vt">











<div class="post-menu"><a href="/a/2116" title="short permalink to this answer" class="short-link" id="link-post-2116">share</a><span class="lsep">|</span><a href="/posts/2116/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">

<div class="user-info ">
    <div class="user-action-time">
        
        
        <a href="/posts/2116/revisions" title="show all edits to this post">edited <span title="2012-03-18 14:34:43Z" class="relativetime">Mar 18 '12 at 14:34</span></a>
        

    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        <br>
        
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    
<div class="user-info user-hover">
    <div class="user-action-time">
        
        
            answered <span title="2012-03-18 09:21:25Z" class="relativetime">Mar 18 '12 at 9:21</span>
        

    </div>
    <div class="user-gravatar32">
        <a href="/users/180/codesinchaos"><div class="gravatar-wrapper-32"><img src="http://www.gravatar.com/avatar/57e2ba76e6290c4e9e19821a068bc8c1?s=128&d=identicon&r=PG" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/180/codesinchaos">CodesInChaos</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">7,572</span><span title="1 gold badge"><span class="badge1"></span><span class="badgecount">1</span></span><span title="17 silver badges"><span class="badge2"></span><span class="badgecount">17</span></span><span title="36 bronze badges"><span class="badge3"></span><span class="badgecount">36</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2116" class="comments" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">

    <tr id="comment-3400" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">The attacker can always calculate SHA1(Key||Message||Padding||Evil message). The Davies-Meyer step is supposed to prevent an attacker from rolling back the final hash to an (unknown) intermediary step, even if the message part, including padding, corresponding to that operation is known.</span>
	&ndash;&nbsp;
		<a href="/users/1564/henrick-hellstrom" 
		   title="3768 reputation" 
		   class="comment-user">Henrick Hellstr&#246;m</a>
	<span class="comment-date" dir="ltr"><span title="2012-03-18 10:18:50Z" class="relativetime-clean">Mar 18 '12 at 10:18</span></span>
		<span class="edited-yes" title="this comment was edited 1 time"></span>
				</div>

        </td>
    </tr>
    <tr id="comment-3401" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">@CodeInChaos: I disagree with the stated condition for the length extension attack to work. The right condition is that the attacker knows <code>EvilMessage</code> and that starts by the appropriate 65 to 576 bits. The imposed prefix of <code>EvilMessage</code> depends, uniquely, on the length of <code>Key ∥ Message</code>, and is the padding specified by <code>SHA-1</code> when hashing a message of that length. Nothing special happens when that length is a multiple of 512. Knowing <code>Message</code> does not help.</span>
	&ndash;&nbsp;
		<a href="/users/555/fgrieu" 
		   title="12490 reputation" 
		   class="comment-user">fgrieu</a>
	<span class="comment-date" dir="ltr"><span title="2012-03-18 11:29:53Z" class="relativetime-clean">Mar 18 '12 at 11:29</span></span>
				</div>

        </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-2116" data-rep=50 data-anon=true
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”." 
				>add comment</a>
    </td>
</tr>
    </table>
</div>
									<a name='new-answer'></a>
						<form id="post-form" action="/questions/2115/answer/submit" method="post"  class="post-form">
							<input type="hidden" id="post-id" value="2115" />
							<h2 class="space">Your Answer</h2>


        <script type="text/javascript">
            StackExchange.ifUsing("editor", function () {
                return StackExchange.using("mathjaxEditing", function () {
                    StackExchange.MarkdownEditor.creationCallbacks.add(function (editor, postfix) {
                        StackExchange.mathjaxEditing.prepareWmdForMathJax(editor, postfix, [["$", "$"], ["\\\\(","\\\\)"]]);
                    });
                });
            }, "mathjax-editing");
        </script>

    

<script type="text/javascript">
    StackExchange.ready(function() {
        initTagRenderer("".split(" "), "".split(" "));
         
        prepareEditor({
            heartbeatType: 'answer',
            bindNavPrevention: true,
            postfix: "",
noCode: true,            onDemand: true,
            discardSelector: ".discard-answer"
            ,immediatelyShowMarkdownHelp:true
        });
        

    });  
</script>


<div id="post-editor" class="post-editor">

    <div style="position: relative;">     
        <div class="wmd-container">
            <div id="wmd-button-bar" class="wmd-button-bar"></div>
            <textarea id="wmd-input" class="wmd-input" name="post-text" cols="92" rows="15" tabindex="101" data-min-length=""></textarea>
        </div>
    </div>

    <div class="fl" style="margin-top: 8px; height:24px;">&nbsp;</div>
    <div id="draft-saved" class="draft-saved community-option fl" style="margin-top: 8px; height:24px; display:none;">draft saved</div>

    <div id="draft-discarded" class="draft-discarded community-option fl" style="margin-top: 8px; height:24px; display:none;">draft discarded</div>



    <div id="wmd-preview" class="wmd-preview"></div>
    <div></div>
    <div class="edit-block">
        <input id="fkey" name="fkey" type="hidden" value="f51c005c36aeb04be7163e16a81b52d5">
        <input id="author" name="author" type="text">
    </div>
</div>
							<div style="position: relative;">
								
            <div class="form-item dno new-post-login">
        
                <div class="new-login-form">
                    <div class="new-login-left">
                        <h3>Sign up or <a id="login-link" href="/users/login?returnurl=%2fquestions%2f2115%2fis-sha1-secure-with-such-many-inputs-z-that-z-constant-secret-x-variable-pub%23new-answer">login</a></h3>
                        <script type="text/javascript">
                            StackExchange.ready(function () {
                                StackExchange.helpers.onClickDraftSave('#login-link');
                            });
                        </script>
                        <div class="preferred-login google-login">
                            <p><span class="icon"></span><span>Sign up using Google</span></p>
                        </div>
                        <div class="preferred-login facebook-login">
                            <p><span class="icon"></span><span>Sign up using Facebook</span></p>
                        </div>
                        <div class="preferred-login stackexchange-login">
                            <p><span class="icon"></span><span>Sign up using Stack Exchange</span></p>
                        </div>
                    </div>
                    <input type="hidden" name="manual-openid" class="manual-openid" />
                    <input type="hidden" name="use-facebook" class="use-facebook" value="false" />
                    <input type="button" class="submit-openid" value="Submit" style="display:none" />
                    <div class="new-login-right">
                                <h3>Post as a guest</h3>
    <div class="form-item">
        <table>
        <tr>
                    <script type="text/javascript">
                StackExchange.ready(function () {
                    StackExchange.helpers.bindHelpOverlayEvents($('.vm input'));
                });
            </script>
            <td class="vm">
                <div>
                    <label for="display-name">Name</label>
                    <input id="display-name" name="display-name" type="text" size="30" maxlength="30" value="" tabindex="105">
                </div>
                <div>
                    <label for="m-address">Email</label>
                    <input id="m-address" name="m-address" type="text" size="30" maxlength="100" value="" tabindex="106">
                    <span class="edit-field-overlay">required, but not shown</span>
                </div>
            </td>
        </tr>
        </table>
    </div>

                    </div>
                </div>
            </div>
            <script type="text/javascript">
                StackExchange.ready(
                    function () {
                        StackExchange.openid.initPostLogin('.new-post-login', '%2fquestions%2f2115%2fis-sha1-secure-with-such-many-inputs-z-that-z-constant-secret-x-variable-pub%23new-answer');
                    }
                );
            </script>
            <noscript>
                        <h3>Post as a guest</h3>
    <div class="form-item">
        <table>
        <tr>
                    <script type="text/javascript">
                StackExchange.ready(function () {
                    StackExchange.helpers.bindHelpOverlayEvents($('.vm input'));
                });
            </script>
            <td class="vm">
                <div>
                    <label for="display-name">Name</label>
                    <input id="display-name" name="display-name" type="text" size="30" maxlength="30" value="" tabindex="105">
                </div>
                <div>
                    <label for="m-address">Email</label>
                    <input id="m-address" name="m-address" type="text" size="30" maxlength="100" value="" tabindex="106">
                    <span class="edit-field-overlay">required, but not shown</span>
                </div>
            </td>
        </tr>
        </table>
    </div>

            </noscript>
							</div>
           
															<div class="form-submit cbt">
									<input id="submit-button" type="submit" value="Post Your Answer" tabindex="110">
									<a href="#" class="discard-answer dno">discard</a>

<p class="privacy-policy-agreement">
By posting your answer, you agree to the <a href='http://stackexchange.com/legal/privacy-policy' target='_blank'>privacy policy</a> and <a href='http://stackexchange.com/legal/terms-of-service' target='_blank'>terms of service</a>.</p>
<input type="hidden" name="legalLinksShown" value="1" />								</div>
						</form>



						<h2 class="bottom-notice">
Not the answer you&#39;re looking for?							Browse other questions tagged <a href="/questions/tagged/mac" class="post-tag" title="show questions tagged &#39;mac&#39;" rel="tag">mac</a> <a href="/questions/tagged/sha1" class="post-tag" title="show questions tagged &#39;sha1&#39;" rel="tag">sha1</a>  or <a href="/questions/ask">ask your own question</a>.						</h2>
			</div>
		</div>
				<div id="sidebar" class="show-votes">
							<div class="module question-stats">
					<p class="label-key">tagged</p>
					<div class="tagged"><a href="/questions/tagged/mac" class="post-tag" title="show questions tagged &#39;mac&#39;" rel="tag">mac</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">&times;</span>&nbsp;<span class="item-multiplier-count">83</span></span><br>
<a href="/questions/tagged/sha1" class="post-tag" title="show questions tagged &#39;sha1&#39;" rel="tag">sha1</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">&times;</span>&nbsp;<span class="item-multiplier-count">40</span></span><br>
</div>
					<table id="qinfo">
						<tr>
							<td>
								<p class="label-key">asked</p>
							</td>
							<td style="padding-left: 10px">
								<p class="label-key" title="2012-03-17 12:37:28Z"><b>1 year ago</b></p>
							</td>
						</tr>
						<tr>
							<td>
								<p class="label-key">viewed</p>
							</td>

							<td style="padding-left: 10px">
								<p class="label-key">
									<b>205 times</b>
								</p>
							</td>
						</tr>
							<tr>
								<td>
									<p class="label-key">active</p>
								</td>
								<td style="padding-left: 10px">
									<p class="label-key"><b><a href="?lastactivity" class="lastactivity-link" title="2012-03-18 15:04:55Z">1 year ago</a></b></p>
								</td>
							</tr>
					</table>
				</div>
						
			


			  
    
            <div class="module sidebar-linked">
	<h4 id="h-linked">Linked</h4>
	<div class="linked" data-tracker="lq=1">
<div class="spacer">
	<a href="/q/2033" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes  default">4</div>
	</a>
	<a href="/questions/2033/does-security-under-rom-imply-exactly-what" class="question-hyperlink">Does security under ROM imply exactly what?</a>
</div>			</div>
</div>


				<div class="module sidebar-related">
					<h4 id="h-related">Related</h4>
					<div class="related" data-tracker="rq=1">
						<div class="spacer">
<a href="/q/1997" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">0
    </div>
</a><a href="/questions/1997/how-to-take-sha-1-safely-for-my-particular-case" class="question-hyperlink">How to take SHA-1 safely for my particular case?</a>
</div>
<div class="spacer">
<a href="/q/2137" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">1
    </div>
</a><a href="/questions/2137/block-ordering-and-security-in-a-mac" class="question-hyperlink">Block ordering and security in a MAC?</a>
</div>
<div class="spacer">
<a href="/q/3221" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">2
    </div>
</a><a href="/questions/3221/different-implementations-of-sha1-which-one-is-correct" class="question-hyperlink">Different implementations of SHA1, which one is correct?</a>
</div>
<div class="spacer">
<a href="/q/5159" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">-2
    </div>
</a><a href="/questions/5159/recovering-sha1-knowing-2-3-of-the-hash-generated" class="question-hyperlink">Recovering SHA1 knowing 2/3 of the hash generated</a>
</div>
<div class="spacer">
<a href="/q/6363" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">-1
    </div>
</a><a href="/questions/6363/rsa-sha1-signature-from-public-key" class="question-hyperlink">RSA SHA1 signature from public key</a>
</div>
<div class="spacer">
<a href="/q/8397" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">2
    </div>
</a><a href="/questions/8397/is-base64sha1guid-still-unique-like-the-original-guid" class="question-hyperlink">Is Base64(SHA1(GUID)) still unique like the original GUID?</a>
</div>
<div class="spacer">
<a href="/q/9435" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">11
    </div>
</a><a href="/questions/9435/is-truncating-a-sha512-hash-to-the-first-40-characters-as-secure-as-using-sha1" class="question-hyperlink">Is truncating a SHA512 hash to the first 40 characters as secure as using SHA1?</a>
</div>
<div class="spacer">
<a href="/q/10034" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">2
    </div>
</a><a href="/questions/10034/hmac-sha1-input-size" class="question-hyperlink">HMAC-SHA1 input size</a>
</div>
<div class="spacer">
<a href="/q/10434" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">0
    </div>
</a><a href="/questions/10434/how-many-blocks-can-we-change-if-know-mac-and-key" class="question-hyperlink">How many blocks can we change if know MAC and key</a>
</div>
<div class="spacer">
<a href="/q/10829" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">8
    </div>
</a><a href="/questions/10829/why-initialize-sha1-with-specific-buffer" class="question-hyperlink">Why initialize SHA1 with specific buffer?</a>
</div>

					</div>
				</div>
		</div>
	
<div id="feed-link">
    <div id="feed-link-text"><a href="/feeds/question/2115" title="feed of this question and its answers"><span class="feed-icon"></span>question feed</a></div>
</div>
	<script type="text/javascript">
StackExchange.ready(function(){$.get('/posts/2115/ivc/42ef');});
</script>
<noscript>
    <div><img src="/posts/2115/ivc/42ef" class="dno" alt="" width="0" height="0"></div>
</noscript></div>


        </div>
    </div>
    <div id="footer" class="categories">
        <div class="footerwrap">
            <div id="footer-menu">
                <div class="top-footer-links">
                        <a href="/about">about</a>
                    <a href="/help">help</a>
                        <a href="/help/badges">badges</a>
                    <a href="http://blog.stackexchange.com?blb=1">blog</a>
                        <a href="http://chat.stackexchange.com">chat</a>
                    <a href="http://data.stackexchange.com">data</a>
                    <a href="http://stackexchange.com/legal">legal</a>
                    <a href="http://stackexchange.com/legal/privacy-policy">privacy policy</a>
                    <a href="http://stackexchange.com/about/hiring">jobs</a>
                    <a href="http://stackexchange.com/about/contact">advertising info</a>

                    <a onclick='StackExchange.switchMobile("on", "/questions/2115/is-sha1-secure-with-such-many-inputs-z-that-z-constant-secret-x-variable-pub")'>mobile</a>
                    <b><a href="/contact">contact us</a></b>
                        <b><a href="http://meta.crypto.stackexchange.com">feedback</a></b>
                    
                </div>
                <div id="footer-sites">
                    <table>
    <tr>
            <th colspan=3>
                Technology
            </th>
            <th >
                Life / Arts
            </th>
            <th >
                Culture / Recreation
            </th>
            <th >
                Science
            </th>
            <th >
                Other
            </th>
    </tr>
    <tr>
            <td>
                <ol>
                        <li><a href="http://stackoverflow.com" title="professional and enthusiast programmers">Stack Overflow</a></li>
                        <li><a href="http://serverfault.com" title="professional system and network administrators">Server Fault</a></li>
                        <li><a href="http://superuser.com" title="computer enthusiasts and power users">Super User</a></li>
                        <li><a href="http://webapps.stackexchange.com" title="power users of web applications">Web Applications</a></li>
                        <li><a href="http://askubuntu.com" title="Ubuntu users and developers">Ask Ubuntu</a></li>
                        <li><a href="http://webmasters.stackexchange.com" title="pro webmasters">Webmasters</a></li>
                        <li><a href="http://gamedev.stackexchange.com" title="professional and independent game developers">Game Development</a></li>
                        <li><a href="http://tex.stackexchange.com" title="users of TeX, LaTeX, ConTeXt, and related typesetting systems">TeX - LaTeX</a></li>
                            </ol></td><td><ol>
                        <li><a href="http://programmers.stackexchange.com" title="professional programmers interested in conceptual questions about software development">Programmers</a></li>
                        <li><a href="http://unix.stackexchange.com" title="users of Linux, FreeBSD and other Un*x-like operating systems.">Unix &amp; Linux</a></li>
                        <li><a href="http://apple.stackexchange.com" title="power users of Apple hardware and software">Ask Different (Apple)</a></li>
                        <li><a href="http://wordpress.stackexchange.com" title="WordPress developers and administrators">WordPress Answers</a></li>
                        <li><a href="http://gis.stackexchange.com" title="cartographers, geographers and GIS professionals">Geographic Information Systems</a></li>
                        <li><a href="http://electronics.stackexchange.com" title="electronics and electrical engineering professionals, students, and enthusiasts">Electrical Engineering</a></li>
                        <li><a href="http://android.stackexchange.com" title="enthusiasts and power users of the Android operating system">Android Enthusiasts</a></li>
                        <li><a href="http://security.stackexchange.com" title="Information security professionals">Information Security</a></li>
                            </ol></td><td><ol>
                        <li><a href="http://dba.stackexchange.com" title="database professionals who wish to improve their database skills and learn from others in the community">Database Administrators</a></li>
                        <li><a href="http://drupal.stackexchange.com" title="Drupal developers and administrators">Drupal Answers</a></li>
                        <li><a href="http://sharepoint.stackexchange.com" title="SharePoint enthusiasts">SharePoint</a></li>
                        <li><a href="http://ux.stackexchange.com" title="user experience researchers and experts">User Experience</a></li>
                        <li><a href="http://mathematica.stackexchange.com" title="users of Mathematica">Mathematica</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#technology" class="more">
                                more (14)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://photo.stackexchange.com" title="professional, enthusiast and amateur photographers">Photography</a></li>
                        <li><a href="http://scifi.stackexchange.com" title="science fiction and fantasy enthusiasts">Science Fiction &amp; Fantasy</a></li>
                        <li><a href="http://cooking.stackexchange.com" title="professional and amateur chefs">Seasoned Advice (cooking)</a></li>
                        <li><a href="http://diy.stackexchange.com" title="contractors and serious DIYers">Home Improvement</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#lifearts" class="more">
                                more (13)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://english.stackexchange.com" title="linguists, etymologists, and serious English language enthusiasts">English Language &amp; Usage</a></li>
                        <li><a href="http://skeptics.stackexchange.com" title="scientific skepticism">Skeptics</a></li>
                        <li><a href="http://judaism.stackexchange.com" title="those who base their lives on Jewish law and tradition and anyone interested in learning more">Mi Yodeya (Judaism)</a></li>
                        <li><a href="http://travel.stackexchange.com" title="road warriors and seasoned travelers">Travel</a></li>
                        <li><a href="http://christianity.stackexchange.com" title="committed Christians, experts in Christianity and those interested in learning more">Christianity</a></li>
                        <li><a href="http://gaming.stackexchange.com" title="passionate videogamers on all platforms">Arqade (gaming)</a></li>
                        <li><a href="http://bicycles.stackexchange.com" title="people who build and repair bicycles, people who train cycling, or commute on bicycles">Bicycles</a></li>
                        <li><a href="http://rpg.stackexchange.com" title="gamemasters and players of tabletop, paper-and-pencil role-playing games">Role-playing Games</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#culturerecreation" class="more">
                                more (21)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://math.stackexchange.com" title="people studying math at any level and professionals in related fields">Mathematics</a></li>
                        <li><a href="http://stats.stackexchange.com" title="statisticians, data analysts, data miners and data visualization experts">Cross Validated (stats)</a></li>
                        <li><a href="http://cstheory.stackexchange.com" title="theoretical computer scientists and researchers in related fields">Theoretical Computer Science</a></li>
                        <li><a href="http://physics.stackexchange.com" title="active researchers, academics and students of physics">Physics</a></li>
                        <li><a href="http://mathoverflow.net" title="professional mathematicians">MathOverflow</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#science" class="more">
                                more (7)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://stackapps.com" title="apps, scripts, and development with the Stack Exchange API">Stack Apps</a></li>
                        <li><a href="http://meta.stackoverflow.com" title="meta-discussion of the Stack Exchange family of Q&amp;A websites">Meta Stack Overflow</a></li>
                        <li><a href="http://area51.stackexchange.com" title="proposing new sites in the Stack Exchange network">Area 51</a></li>
                        <li><a href="http://careers.stackoverflow.com">Stack Overflow Careers</a></li>
                    
                </ol>
            </td>
    </tr>
</table>
                </div>
            </div>

            <div id="copyright">
                site design / logo &#169; 2013 stack exchange inc; user contributions licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license">cc-wiki</a> 
 with <a href="http://blog.stackoverflow.com/2009/06/attribution-required/" rel="license">attribution required</a>
            </div>
            <div id="footer-flair">
                <a href="http://creativecommons.org/licenses/by-sa/3.0/" class="cc-wiki-link"></a>
            </div>
            <div id="svnrev">
                rev 2013.11.26.1178
            </div>
            
        </div>
    </div>
    <noscript>
        <div id="noscript-warning">Cryptography Stack Exchange works best with JavaScript enabled<img src="http://pixel.quantserve.com/pixel/p-c1rF4kxgLUzNc.gif" alt="" class="dno"></div>
    </noscript>

    <script type="text/javascript">var _gaq=_gaq||[];_gaq.push(['_setAccount','UA-5620270-24']);
        _gaq.push(['_setDomainName','.stackexchange.com']);
        _gaq.push(['_setCustomVar', 1, 'tags', '|mac|sha1|']); 
_gaq.push(['_trackPageview']);
    var _qevents = _qevents || [];
    var _comscore = _comscore || [];
    (function () {
        var ssl='https:'==document.location.protocol,
            s=document.getElementsByTagName('script')[0],
            ga=document.createElement('script');
        ga.type='text/javascript';
        ga.async=true;
        ga.src=(ssl?'https://ssl':'http://www')+'.google-analytics.com/ga.js';
        s.parentNode.insertBefore(ga,s);
        var sc=document.createElement('script');
        sc.type='text/javascript';
        sc.async=true;
        sc.src=(ssl?'https://secure':'http://edge')+'.quantserve.com/quant.js';
        s.parentNode.insertBefore(sc, s);
        
        var s = document.createElement("script"), el = document.getElementsByTagName("script")[0]; s.async = true;
        s.src = (document.location.protocol == "https:" ? "https://sb" : "http://b") + ".scorecardresearch.com/beacon.js";
        el.parentNode.insertBefore(s, el);
        
    })();
    _comscore.push({ c1: "2", c2: "17440561" });
    _qevents.push({ qacct: "p-c1rF4kxgLUzNc" });
    </script>            
</body>
</html>