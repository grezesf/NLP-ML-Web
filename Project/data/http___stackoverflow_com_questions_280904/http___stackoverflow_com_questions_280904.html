<!DOCTYPE html>
<html>
<head>
    
    <title>Trigger to fire only if a condition is met in SQL Server - Stack Overflow</title>
    <link rel="shortcut icon" href="//cdn.sstatic.net/stackoverflow/img/favicon.ico">
    <link rel="apple-touch-icon image_src" href="//cdn.sstatic.net/stackoverflow/img/apple-touch-icon.png">
    <link rel="search" type="application/opensearchdescription+xml" title="Stack Overflow" href="/opensearch.xml">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:domain" content="stackoverflow.com"/>
    <meta name="og:type" content="website" />
    <meta name="og:image" content="http://cdn.sstatic.net/stackoverflow/img/apple-touch-icon@2.png?v=fde65a5a78c6"/>
    <meta name="og:title" content="Trigger to fire only if a condition is met in SQL Server" />
    <meta name="og:description" content="I hope this is a simple enough question for any SQL people out there...

We have a table which hold system configuration data, and this is tied to a history table via triggers so we can track who c..." />
    <meta name="og:url" content="http://stackoverflow.com/questions/280904/trigger-to-fire-only-if-a-condition-is-met-in-sql-server"/>
    <link rel="canonical" href="http://stackoverflow.com/questions/280904/trigger-to-fire-only-if-a-condition-is-met-in-sql-server" />

    
    
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="//cdn.sstatic.net/Js/stub.en.js?v=e3d47b73fa12" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="//cdn.sstatic.net/stackoverflow/all.css?v=fe884146022c">
    
    <link rel="alternate" type="application/atom+xml" title="Feed for question &#39;Trigger to fire only if a condition is met in SQL Server&#39;" href="/feeds/question/280904">
    <script type="text/javascript">
        
        StackExchange.ready(function () {
            StackExchange.using("postValidation", function () {
                StackExchange.postValidation.initOnBlurAndSubmit($('#post-form'), 2, 'answer');
            });

            
            StackExchange.question.init({showAnswerHelp:true,totalCommentCount:0,shownCommentCount:0,highlightColor:'#F4A83D',backgroundColor:'#FFF',questionId:280904});

            styleCode();

                StackExchange.realtime.subscribeToQuestion('1', '280904');
            
                    });
    </script>


    <script type="text/javascript">
        StackExchange.init({"locale":"en","stackAuthUrl":"https://stackauth.com","serverTime":1385154446,"styleCode":true,"enableUserHovercards":true,"site":{"name":"Stack Overflow","description":"Q&A for professional and enthusiast programmers","isNoticesTabEnabled":true,"recaptchaPublicKey":"6LdchgIAAAAAAJwGpIzRQSOFaO0pU6s44Xt8aTwc","enableSocialMediaInSharePopup":true},"user":{"fkey":"595e453a90deb79876026b8ee52ee2b4","isAnonymous":true}});
        StackExchange.using.setCacheBreakers({"js/prettify-full.en.js":"e0bbd4760e83","js/moderator.en.js":"1a411fd265fe","js/full-anon.en.js":"2435f0d168c4","js/full.en.js":"e4b72ebdc18f","js/wmd.en.js":"bd9234d44a40","js/third-party/jquery.autocomplete.min.js":"e5f01e97f7c3","js/third-party/jquery.autocomplete.min.en.js":"","js/mobile.en.js":"d1d834ef85d2","js/help.en.js":"d3cc74d8a93a","js/tageditor.en.js":"6d51a5f8d7f3","js/tageditornew.en.js":"111b781cf314","js/inline-tag-editing.en.js":"f951bd09dc69","js/revisions.en.js":"33fd38144303","js/review.en.js":"f45b4ec094ea","js/tagsuggestions.en.js":"e4e7b952fcc7","js/post-validation.en.js":"c275fe37d674","js/explore-qlist.en.js":"73825bd006fc","js/events.en.js":"53bc48767091"});
        StackExchange.using("gps", function() {
             StackExchange.gps.init(true);
        });
        
    </script>
    
        <script type="text/javascript">
            StackExchange.ready(function () {
                $('#nav-tour').click(function () {
                    StackExchange.using("gps", function() {
                        StackExchange.gps.track("aboutpage.click", { aboutclick_location: "headermain" }, true);
                    });
                });
            });
        </script>
</head>
<body class="question-page">
    <noscript><div id="noscript-padding"></div></noscript>
    <div id="notify-container"></div>
    <div id="overlay-header"></div>
    <div id="custom-header"></div>
    <div class="container">
        <div id="header" class=headeranon>
            <div id="portalLink">
                <a class="genu" href="http://stackexchange.com" onclick="StackExchange.ready(function(){genuwine.click();});return false;">Stack Exchange</a>
            </div>
            <div id="topbar">
                <div id="hlinks">
                    
<span id="hlinks-user"></span>
<span id="hlinks-nav">                        <a href="/users/login?returnurl=%2fquestions%2f280904%2ftrigger-to-fire-only-if-a-condition-is-met-in-sql-server">sign up</a>

 <span class="lsep">|</span>
                    <a href="/users/login?returnurl=%2fquestions%2f280904%2ftrigger-to-fire-only-if-a-condition-is-met-in-sql-server">log in</a>

 <span class="lsep">|</span>
                    <a href="http://careers.stackoverflow.com">careers 2.0</a>

 <span class="lsep">|</span>
</span>
<span id="hlinks-custom"></span>
                </div>
                <div id="hsearch">
                    <form id="search" action="/search" method="get" autocomplete="off">
                        <div>
                            <input autocomplete="off" name="q" class="textbox" placeholder="search" tabindex="1" type="text" maxlength="240" size="28" value="">
                        </div>
                    </form>
                </div>
            </div>
            <br class="cbt">
            <div id="hlogo">
                <a href="/">
                    Stack Overflow
                </a>
            </div>
            <div id="hmenus">
                <div class="nav mainnavs mainnavsanon">
                    <ul>
                            <li class="youarehere"><a id="nav-questions" href="/questions">Questions</a></li>
                            <li><a id="nav-tags" href="/tags">Tags</a></li>
                            <li><a id="nav-tour" href="/about">Tour</a></li>
                            <li><a id="nav-users" href="/users">Users</a></li>
                    </ul>
                </div>
                <div class="nav askquestion">
                    <ul>
                        <li>
                            <a id="nav-askquestion"  href="/questions/ask">Ask Question</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        



        <div id="content">
            

<div itemscope itemtype="http://schema.org/Article">
	<link itemprop="image" href="//cdn.sstatic.net/stackoverflow/img/apple-touch-icon.png">
			<!--googleoff: all-->
<div id="herobox-mini">
    <div id="hero-content">
        <span id="controls">
            <a href="/about" id="tell-me-more" class="button">Tell me more</a>
            <span id="close"><a title="click to dismiss">&times;</a></span>
        </span>
        <div id="blurb">
            Stack Overflow is a question and answer site for professional and enthusiast programmers. It&#39;s 100% free, no registration required.
        </div>        
    </div>
    <script>
        $('#tell-me-more').click(function () {
            var clickSource = $("body").attr("class") + '-mini';
            if ($("body").hasClass("questions-page")) {
                clickSource = 'questionpagemini';
            }
            if ($("body").hasClass("home-page")) {
                clickSource = 'homepagemini';
            }

            StackExchange.using("gps", function () {
                StackExchange.gps.track("aboutpage.click", { aboutclick_location: clickSource } , true);
            });
        });
        $('#herobox-mini #close').click(function () {
            StackExchange.using("gps", function () {
                StackExchange.gps.track("hero.action", { hero_action_type: "close" }, true);
            });
            $.cookie("hero", "none", { path: "/" });
            var $hero = $("#herobox-mini");
            $hero.slideUp('fast', function () { $hero.remove(); });
            return false;
        });
    </script>
</div>
			<!--googleon: all-->
			<div id="question-header">
			<h1 itemprop="name"><a href="/questions/280904/trigger-to-fire-only-if-a-condition-is-met-in-sql-server" class="question-hyperlink">Trigger to fire only if a condition is met in SQL Server</a></h1>
		</div>
			<div id="mainbar">

			

<div class="question" data-questionid="280904"  id="question">
    
                <script type="text/javascript">
                var ados = ados || {};ados.run = ados.run || [];
                ados.run.push(function() { ados_add_placement(22,8277,"adzerk921456225",4).setZone(43) ; });                    
            </script>
            <div class="everyonelovesstackoverflow" id="adzerk921456225">
            </div>  


    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="280904">
    <a class="vote-up-off" title="This question shows research effort; it is useful and clear">up vote</a>
    <span class="vote-count-post ">3</span>
    <a class="vote-down-off" title="This question does not show any research effort; it is unclear or not useful">down vote</a>
    
    <a class="star-off" href="#" title="This is a favorite question (click again to undo)">favorite</a>
    <div class="favoritecount"><b>1</b></div>   

</div>

            </td>
            
<td class="postcell">
<div>
    <div class="post-text" itemprop="description">

        <p>I hope this is a simple enough question for any SQL people out there...</p>

<p>We have a table which hold system configuration data, and this is tied to a history table via triggers so we can track who changed what, and when.  </p>

<p>I have a requirement to add another value in to this table, but it is one that will change frequently from code, and has a requirement that we don't track it's history (we don't want to clog the table with many thousands of updates per day.</p>

<p>At present, our trigger is a little like this...</p>

<pre><code>CREATE TRIGGER 
    [dbo].[SystemParameterInsertUpdate]
ON 
    [dbo].[SystemParameter]
FOR INSERT, UPDATE 
AS
  BEGIN
    SET NOCOUNT ON
      INSERT INTO SystemParameterHistory 
      (
        Attribute,
        ParameterValue,
        ParameterDescription,
        ChangeDate
      )
    SELECT
      Attribute,
      ParameterValue,
      ParameterDescription,
      ChangeDate
    FROM Inserted AS I
END
</code></pre>

<p>I'd like to be able to add some logic to stop it creating the record if an Attribute colum value is prefixed with a specific string  (e.g. "NoHist_")</p>

<p>Given that I have almost no experience working with triggers, I was wondering how it would be best to implement this...  I have tried a where clause like the following</p>

<pre><code>where I.Attribute NOT LIKE 'NoHist_%'
</code></pre>

<p>but it doesn't seem to work.  The value is still copied over into the history table.</p>

<p>Any help you could offer would be appreciated.</p>

<hr>

<p>OK - as predicted by Cade Roux, this fail spectacularly on multiple updates.  I'm going to have to take a new approach to this.  Does anyone have any other suggestions, please?</p>

<hr>

<p>Guys - Please educate me here...  Why would LEFT() be preferable to LIKE in this scenario?  I know I've accepted the answer, but I'd like to know for my own education.  </p>

    </div>
    <div class="post-taglist">
        <a href="/questions/tagged/sql-server" class="post-tag" title="show questions tagged &#39;sql-server&#39;" rel="tag">sql-server</a> <a href="/questions/tagged/triggers" class="post-tag" title="show questions tagged &#39;triggers&#39;" rel="tag">triggers</a> 
    </div>
    <table class="fw">
    <tr>
    <td class="vt">











<div class="post-menu"><a href="/q/280904" title="short permalink to this question" class="short-link" id="link-post-280904">share</a><span class="lsep">|</span><a href="/posts/280904/edit" class="suggest-edit-post" title="">improve this question</a></div>        
    </td>
    <td align="right" class="post-signature">

<div class="user-info ">
    <div class="user-action-time">
        
        
        <a href="/posts/280904/revisions" title="show all edits to this post">edited <span title="2012-10-05 02:11:48Z" class="relativetime">Oct 5 '12 at 2:11</span></a>
        

    </div>
    <div class="user-gravatar32">
        <a href="/users/127880/illililililiilililil"><div class="gravatar-wrapper-32"><img src="http://i.stack.imgur.com/hDGuY.jpg?s=32&g=1" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/127880/illililililiilililil">IllIlIlIlIlIIlIlIlIl</a><br>
        <span class="reputation-score" title="reputation score 11805" dir="ltr">11.8k</span><span title="29 gold badges"><span class="badge1"></span><span class="badgecount">29</span></span><span title="81 silver badges"><span class="badge2"></span><span class="badgecount">81</span></span><span title="160 bronze badges"><span class="badge3"></span><span class="badgecount">160</span></span>
    </div>
</div>    </td>
    <td class="post-signature owner">
        
<div class="user-info user-hover">
    <div class="user-action-time">
        
        
            asked <span title="2008-11-11 13:45:47Z" class="relativetime">Nov 11 '08 at 13:45</span>
        

    </div>
    <div class="user-gravatar32">
        <a href="/users/377/zombiesheep"><div><img src="https://www.gravatar.com/avatar/83f52d27501cad499e58be6c5d952f70?s=32&d=identicon&r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/377/zombiesheep">ZombieSheep</a><br>
        <span class="reputation-score" title="reputation score 17444" dir="ltr">17.4k</span><span title="3 gold badges"><span class="badge1"></span><span class="badgecount">3</span></span><span title="33 silver badges"><span class="badge2"></span><span class="badgecount">33</span></span><span title="82 bronze badges"><span class="badge3"></span><span class="badgecount">82</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</div>
</td>
        </tr>
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-280904" class="comments dno" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="" 
			           data-addlink-disabled="true">
					    <tr><td></td><td></td></tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-280904" 
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid answering questions in comments."></a>
    </td>
</tr>            </table>    
</div>


			<div id="answers">

				<a name="tab-top"></a>
				<div id="answers-header">
					<div class="subheader answers-subheader">
						<h2>
								7 Answers
						</h2>
						<div>
							<div id="tabs">
        <a href="/questions/280904/trigger-to-fire-only-if-a-condition-is-met-in-sql-server?answertab=active#tab-top" title="Answers with the latest activity first">active</a>
        <a href="/questions/280904/trigger-to-fire-only-if-a-condition-is-met-in-sql-server?answertab=oldest#tab-top" title="Answers in the order they were provided">oldest</a>
        <a class="youarehere" href="/questions/280904/trigger-to-fire-only-if-a-condition-is-met-in-sql-server?answertab=votes#tab-top" title="Answers with the highest score first">votes</a>
</div>
						</div>
					</div>    
				</div>    




  
<a name="280956"></a>
<div id="answer-280956" class="answer accepted-answer" data-answerid="280956" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="280956">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">8</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


        <span class="vote-accepted-on load-accepted-answer-date" title="loading when this answer was accepted...">accepted</span>
</div>

            </td>



<td class="answercell">
    <div class="post-text"><p>Given that a WHERE clause did not work, maybe this will:</p>

<pre><code>CREATE TRIGGER 
    [dbo].[SystemParameterInsertUpdate]
ON 
    [dbo].[SystemParameter]
FOR INSERT, UPDATE 
AS
  BEGIN
    SET NOCOUNT ON

      If (SELECT Attribute FROM INSERTED) LIKE 'NoHist_%'
      Begin
          Return
      End

      INSERT INTO SystemParameterHistory 
      (
        Attribute,
        ParameterValue,
        ParameterDescription,
        ChangeDate
      )
    SELECT
      Attribute,
      ParameterValue,
      ParameterDescription,
      ChangeDate
    FROM Inserted AS I
END
</code></pre>
</div>
    <table class="fw">
    <tr>
    <td class="vt">











<div class="post-menu"><a href="/a/280956" title="short permalink to this answer" class="short-link" id="link-post-280956">share</a><span class="lsep">|</span><a href="/posts/280956/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">

<div class="user-info ">
    <div class="user-action-time">
        
        
        <a href="/posts/280956/revisions" title="show all edits to this post">edited <span title="2012-11-30 00:24:06Z" class="relativetime">Nov 30 '12 at 0:24</span></a>
        

    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        <br>
        
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    
<div class="user-info user-hover">
    <div class="user-action-time">
        
        
            answered <span title="2008-11-11 14:04:13Z" class="relativetime">Nov 11 '08 at 14:04</span>
        

    </div>
    <div class="user-gravatar32">
        <a href="/users/3043/joel-coehoorn"><div><img src="https://www.gravatar.com/avatar/61d2a0f034915fa9d2acd6f6b145bba8?s=32&d=identicon&r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/3043/joel-coehoorn">Joel Coehoorn</a><br>
        <span class="reputation-score" title="reputation score 172012" dir="ltr">172k</span><span title="57 gold badges"><span class="badge1"></span><span class="badgecount">57</span></span><span title="329 silver badges"><span class="badge2"></span><span class="badgecount">329</span></span><span title="542 bronze badges"><span class="badge3"></span><span class="badgecount">542</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-280956" class="comments" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="" 
			           data-addlink-disabled="true">

    <tr id="comment-132024" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">Perfect.  Thank you so much.</span>
	&ndash;&nbsp;
		<a href="/users/377/zombiesheep" 
		   title="17444 reputation" 
		   class="comment-user owner">ZombieSheep</a>
	<span class="comment-date" dir="ltr"><span title="2008-11-11 14:08:55Z" class="relativetime-clean">Nov 11 '08 at 14:08</span></span>
				</div>

        </td>
    </tr>
    <tr id="comment-132398" class="comment">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                                <span title="number of &#39;useful comment&#39; votes received" 
                                        class="cool">1</span>   
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">with this trigger you&#39;re only handling one row. what happens if someone inserts/updates 2 or more rows at once? data will be wrong.</span>
	&ndash;&nbsp;
		<a href="/users/31345/mladen-prajdic" 
		   title="9439 reputation" 
		   class="comment-user">Mladen Prajdic</a>
	<span class="comment-date" dir="ltr"><span title="2008-11-11 17:13:24Z" class="relativetime-clean">Nov 11 '08 at 17:13</span></span>
				</div>

        </td>
    </tr>
    <tr id="comment-132781" class="comment">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                                <span title="number of &#39;useful comment&#39; votes received" 
                                        class="cool">1</span>   
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">_ is also a wildcard, so LIKE &#39;NoHist_%&#39; will also match &#39;NoHistX&#39;</span>
	&ndash;&nbsp;
		<a href="/users/18255/cade-roux" 
		   title="50879 reputation" 
		   class="comment-user">Cade Roux</a>
	<span class="comment-date" dir="ltr"><span title="2008-11-11 20:27:38Z" class="relativetime-clean">Nov 11 '08 at 20:27</span></span>
				</div>

        </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-280956" 
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."></a>
    </td>
</tr>
    </table>
</div>
            <script type="text/javascript">
                var ados = ados || {};ados.run = ados.run || [];
                ados.run.push(function() { ados_add_placement(22,8277,"adzerk101453621",4).setZone(44) ; });                    
            </script>
            <div class="everyonelovesstackoverflow" id="adzerk101453621">
            </div>  



  
<a name="280975"></a>
<div id="answer-280975" class="answer" data-answerid="280975" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="280975">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">3</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>



<td class="answercell">
    <div class="post-text"><p>How about this?</p>

<pre><code>CREATE TRIGGER 
[dbo].[SystemParameterInsertUpdate]
ON 
[dbo].[SystemParameter]
FOR INSERT, UPDATE 
AS
BEGIN
SET NOCOUNT ON
  IF (LEFT((SELECT Attribute FROM INSERTED), 7) &lt;&gt; 'NoHist_') 
  BEGIN
      INSERT INTO SystemParameterHistory 
      (
        Attribute,
        ParameterValue,
        ParameterDescription,
        ChangeDate
      )
    SELECT
      Attribute,
      ParameterValue,
      ParameterDescription,
      ChangeDate
   FROM Inserted AS I
END
END
</code></pre>
</div>
    <table class="fw">
    <tr>
    <td class="vt">











<div class="post-menu"><a href="/a/280975" title="short permalink to this answer" class="short-link" id="link-post-280975">share</a><span class="lsep">|</span><a href="/posts/280975/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">

<div class="user-info ">
    <div class="user-action-time">
        
        
        <a href="/posts/280975/revisions" title="show all edits to this post">edited <span title="2008-11-11 14:31:24Z" class="relativetime">Nov 11 '08 at 14:31</span></a>
        

    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        <br>
        
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    
<div class="user-info ">
    <div class="user-action-time">
        
        
            answered <span title="2008-11-11 14:08:36Z" class="relativetime">Nov 11 '08 at 14:08</span>
        

    </div>
    <div class="user-gravatar32">
        <a href="/users/26241/matty"><div><img src="https://www.gravatar.com/avatar/23811cc30c31187a81d78d7ee5cd7534?s=32&d=identicon&r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/26241/matty">Matty</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">938</span><span title="3 gold badges"><span class="badge1"></span><span class="badgecount">3</span></span><span title="15 silver badges"><span class="badge2"></span><span class="badgecount">15</span></span><span title="26 bronze badges"><span class="badge3"></span><span class="badgecount">26</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-280975" class="comments" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="" 
			           data-addlink-disabled="true">

    <tr id="comment-132034" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">I like LEFT() better than my own LIKE() suggestion for this.</span>
	&ndash;&nbsp;
		<a href="/users/3043/joel-coehoorn" 
		   title="172012 reputation" 
		   class="comment-user">Joel Coehoorn</a>
	<span class="comment-date" dir="ltr"><span title="2008-11-11 14:16:04Z" class="relativetime-clean">Nov 11 '08 at 14:16</span></span>
				</div>

        </td>
    </tr>
    <tr id="comment-132065" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">I don&#39;t know enough about the what&#39;s going on internally with SQL server to know which approach is better from a performance perspective.  I actually like yours a bit better because you exit immediately rather than wrapping the entire INSERT in a conditional statement.</span>
	&ndash;&nbsp;
		<a href="/users/26241/matty" 
		   title="938 reputation" 
		   class="comment-user">Matty</a>
	<span class="comment-date" dir="ltr"><span title="2008-11-11 14:34:08Z" class="relativetime-clean">Nov 11 '08 at 14:34</span></span>
				</div>

        </td>
    </tr>
    <tr id="comment-132619" class="comment">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                                <span title="number of &#39;useful comment&#39; votes received" 
                                        class="cool">1</span>   
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">This one will also fail if more than one record is being inserted or updated.</span>
	&ndash;&nbsp;
		<a href="/users/18255/cade-roux" 
		   title="50879 reputation" 
		   class="comment-user">Cade Roux</a>
	<span class="comment-date" dir="ltr"><span title="2008-11-11 19:01:47Z" class="relativetime-clean">Nov 11 '08 at 19:01</span></span>
				</div>

        </td>
    </tr>
    <tr id="comment-132644" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">Good point Cade.  For this to work properly it would have to iterate over the insertions/updates.  This would add unnecessary overhead which could be avoided using your code snippet.</span>
	&ndash;&nbsp;
		<a href="/users/26241/matty" 
		   title="938 reputation" 
		   class="comment-user">Matty</a>
	<span class="comment-date" dir="ltr"><span title="2008-11-11 19:15:16Z" class="relativetime-clean">Nov 11 '08 at 19:15</span></span>
				</div>

        </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-280975" 
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."></a>
    </td>
</tr>
    </table>
</div>

  
<a name="281849"></a>
<div id="answer-281849" class="answer" data-answerid="281849" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="281849">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">3</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>



<td class="answercell">
    <div class="post-text"><p>The <code>_</code> character is also a wildcard, BTW, but I'm not sure why this wasn't working for you:</p>

<pre><code>CREATE TRIGGER 
    [dbo].[SystemParameterInsertUpdate]
ON 
    [dbo].[SystemParameter]
FOR INSERT, UPDATE 
AS
  BEGIN
    SET NOCOUNT ON
      INSERT INTO SystemParameterHistory 
      (
        Attribute,
        ParameterValue,
        ParameterDescription,
        ChangeDate
      )
    SELECT
      I.Attribute,
      I.ParameterValue,
      I.ParameterDescription,
      I.ChangeDate
    FROM Inserted AS I
    WHERE I.Attribute NOT LIKE 'NoHist[_]%'
END
</code></pre>
</div>
    <table class="fw">
    <tr>
    <td class="vt">











<div class="post-menu"><a href="/a/281849" title="short permalink to this answer" class="short-link" id="link-post-281849">share</a><span class="lsep">|</span><a href="/posts/281849/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    
<div class="user-info user-hover">
    <div class="user-action-time">
        
        
            answered <span title="2008-11-11 19:07:25Z" class="relativetime">Nov 11 '08 at 19:07</span>
        

    </div>
    <div class="user-gravatar32">
        <a href="/users/18255/cade-roux"><div><img src="https://www.gravatar.com/avatar/d45ef03e9450599588bf733662f792e5?s=32&d=identicon&r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/18255/cade-roux">Cade Roux</a><br>
        <span class="reputation-score" title="reputation score 50879" dir="ltr">50.9k</span><span title="12 gold badges"><span class="badge1"></span><span class="badgecount">12</span></span><span title="80 silver badges"><span class="badge2"></span><span class="badgecount">80</span></span><span title="175 bronze badges"><span class="badge3"></span><span class="badgecount">175</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-281849" class="comments dno" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="" 
			           data-addlink-disabled="true">
					    <tr><td></td><td></td></tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-281849" 
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."></a>
    </td>
</tr>
    </table>
</div>

  
<a name="281008"></a>
<div id="answer-281008" class="answer" data-answerid="281008" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="281008">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">2</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>



<td class="answercell">
    <div class="post-text"><p>Your where clause should have worked. I am at a loss as to why it didn't. Let me show you how I would have figured out the problem with the where clause as it might help you for the future.</p>

<p>When I create triggers, I start at the query window by creating a temp table called #inserted (and or #deleted) with all the columns of the table. Then I popultae it with typical values (Always multiple records and I try to hit the test cases in the values)</p>

<p>Then I write my triggers logic and I can test without it actually being in a trigger. In a case like your where clause not doing what was expected, I could easily test by commenting out the insert to see what the select was returning. I would then probably be easily able to see what the problem was. I assure you that where clasues do work in triggers if they are written correctly.</p>

<p>Once I know that the code works properly for all the cases, I global replace #inserted with inserted and add the create trigger code around it and voila, a tested trigger.</p>

<p>AS I said in a comment, I have a concern that the solution you picked will not work properly in a multiple record insert or update. Triggers should always be written to account for that as you cannot predict if and when they will happen (and they do happen eventually to pretty much every table.)</p>
</div>
    <table class="fw">
    <tr>
    <td class="vt">











<div class="post-menu"><a href="/a/281008" title="short permalink to this answer" class="short-link" id="link-post-281008">share</a><span class="lsep">|</span><a href="/posts/281008/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    
<div class="user-info ">
    <div class="user-action-time">
        
        
            answered <span title="2008-11-11 14:24:29Z" class="relativetime">Nov 11 '08 at 14:24</span>
        

    </div>
    <div class="user-gravatar32">
        <a href="/users/9034/hlgem"><div><img src="https://www.gravatar.com/avatar/0c2672d183877f7fcd8d46970ef03f1f?s=32&d=identicon&r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/9034/hlgem">HLGEM</a><br>
        <span class="reputation-score" title="reputation score 51284" dir="ltr">51.3k</span><span title="4 gold badges"><span class="badge1"></span><span class="badgecount">4</span></span><span title="44 silver badges"><span class="badge2"></span><span class="badgecount">44</span></span><span title="86 bronze badges"><span class="badge3"></span><span class="badgecount">86</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-281008" class="comments" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="" 
			           data-addlink-disabled="true">

    <tr id="comment-132055" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">When you say you have a concern, could you elaborate, please? I can&#39;t see another comment from you in this thread... If you mean there is a possibility that non-&#39;NoHist_&#39; records are dropped incorrectly, could you proposed a solution?</span>
	&ndash;&nbsp;
		<a href="/users/377/zombiesheep" 
		   title="17444 reputation" 
		   class="comment-user owner">ZombieSheep</a>
	<span class="comment-date" dir="ltr"><span title="2008-11-11 14:30:32Z" class="relativetime-clean">Nov 11 '08 at 14:30</span></span>
				</div>

        </td>
    </tr>
    <tr id="comment-132142" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">Yes, that&#39;s why I think it is worth it to get the where clause to work properly. If you look at the solution you took you will see that it returns if it finds a record with NoHist, therefore I suspect it wouldn&#39;t process any records in the same batch that do have a different value. Test to confirm.</span>
	&ndash;&nbsp;
		<a href="/users/9034/hlgem" 
		   title="51284 reputation" 
		   class="comment-user">HLGEM</a>
	<span class="comment-date" dir="ltr"><span title="2008-11-11 15:16:26Z" class="relativetime-clean">Nov 11 '08 at 15:16</span></span>
				</div>

        </td>
    </tr>
    <tr id="comment-132223" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">Thanks HLGEM, I&#39;ll bear that in mind when putting some load on the app.</span>
	&ndash;&nbsp;
		<a href="/users/377/zombiesheep" 
		   title="17444 reputation" 
		   class="comment-user owner">ZombieSheep</a>
	<span class="comment-date" dir="ltr"><span title="2008-11-11 16:02:49Z" class="relativetime-clean">Nov 11 '08 at 16:02</span></span>
				</div>

        </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-281008" 
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."></a>
    </td>
</tr>
    </table>
</div>

  
<a name="3631976"></a>
<div id="answer-3631976" class="answer" data-answerid="3631976" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="3631976">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">1</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>



<td class="answercell">
    <div class="post-text"><pre><code>CREATE TRIGGER
    [dbo].[SystemParameterInsertUpdate]
ON 
    [dbo].[SystemParameter]
FOR INSERT, UPDATE 
AS
  BEGIN
    SET NOCOUNT ON 

    DECLARE @StartRow int
    DECLARE @EndRow int
    DECLARE @CurrentRow int

    SET @StartRow = 1
    SET @EndRow = (SELECT count(*) FROM inserted)
    SET @CurrentRow = @StartRow

    WHILE @CurrentRow &lt;= @EndRow BEGIN

        IF (SELECT Attribute FROM (SELECT ROW_NUMBER() OVER (ORDER BY Attribute ASC) AS 'RowNum', Attribute FROM inserted) AS INS WHERE RowNum = @CurrentRow) LIKE 'NoHist_%' BEGIN

            INSERT INTO SystemParameterHistory(
                Attribute,
                ParameterValue,
                ParameterDescription,
                ChangeDate)
            SELECT
                I.Attribute,
                I.ParameterValue,
                I.ParameterDescription,
                I.ChangeDate
            FROM
                (SELECT Attribute, ParameterValue, ParameterDescription, ChangeDate FROM (
                                                                                            SELECT ROW_NUMBER() OVER (ORDER BY Attribute ASC) AS 'RowNum', * 
                                                                                            FROM inserted)
                                                                                    AS I 
            WHERE RowNum = @CurrentRow

        END --END IF

    SET @CurrentRow = @CurrentRow + 1

    END --END WHILE
END --END TRIGGER
</code></pre>
</div>
    <table class="fw">
    <tr>
    <td class="vt">











<div class="post-menu"><a href="/a/3631976" title="short permalink to this answer" class="short-link" id="link-post-3631976">share</a><span class="lsep">|</span><a href="/posts/3631976/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    
<div class="user-info ">
    <div class="user-action-time">
        
        
            answered <span title="2010-09-02 23:14:21Z" class="relativetime">Sep 2 '10 at 23:14</span>
        

    </div>
    <div class="user-gravatar32">
        <a href="/users/438470/quintessentialsolutions"><div><img src="https://www.gravatar.com/avatar/3a299cb9668eeb2c9b7426d7e04b14f7?s=32&d=identicon&r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/438470/quintessentialsolutions">QuintessentialSolutions</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">11</span><span title="1 bronze badge"><span class="badge3"></span><span class="badgecount">1</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-3631976" class="comments" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="" 
			           data-addlink-disabled="true">

    <tr id="comment-19078924" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">Post some explanation to your code please</span>
	&ndash;&nbsp;
		<a href="/users/502950/mikrodel" 
		   title="2825 reputation" 
		   class="comment-user">MikroDel</a>
	<span class="comment-date" dir="ltr"><span title="2012-12-13 10:09:27Z" class="relativetime-clean">Dec 13 '12 at 10:09</span></span>
				</div>

        </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-3631976" 
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."></a>
    </td>
</tr>
    </table>
</div>

  
<a name="281140"></a>
<div id="answer-281140" class="answer" data-answerid="281140" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="281140">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">0</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>



<td class="answercell">
    <div class="post-text"><p>Using LIKE will give you options for defining what the rest of the string should look like, but if the rule is just starts with 'NoHist_' it doesn't really matter.</p>
</div>
    <table class="fw">
    <tr>
    <td class="vt">











<div class="post-menu"><a href="/a/281140" title="short permalink to this answer" class="short-link" id="link-post-281140">share</a><span class="lsep">|</span><a href="/posts/281140/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    
<div class="user-info ">
    <div class="user-action-time">
        
        
            answered <span title="2008-11-11 15:06:43Z" class="relativetime">Nov 11 '08 at 15:06</span>
        

    </div>
    <div class="user-gravatar32">
        <a href="/users/36559/daniel-m"><div><img src="https://www.gravatar.com/avatar/27796a7879bd8bae7e59e41af45e8bbe?s=32&d=identicon&r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/36559/daniel-m">Daniel M</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">918</span><span title="6 silver badges"><span class="badge2"></span><span class="badgecount">6</span></span><span title="10 bronze badges"><span class="badge3"></span><span class="badgecount">10</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-281140" class="comments dno" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="" 
			           data-addlink-disabled="true">
					    <tr><td></td><td></td></tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-281140" 
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."></a>
    </td>
</tr>
    </table>
</div>

  
<a name="562458"></a>
<div id="answer-562458" class="answer" data-answerid="562458" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="562458">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">-1</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>



<td class="answercell">
    <div class="post-text"><p>For triggers in general, you need to use a cursor to handle inserts or updates of multiple rows. For example:</p>

<pre><code>DECLARE @Attribute;
DECLARE @ParameterValue;
DECLARE mycursor CURSOR FOR SELECT Attribute, ParameterValue FROM inserted;
OPEN mycursor;
FETCH NEXT FROM mycursor into @Attribute, @ParameterValue;
WHILE @@FETCH_STATUS = 0
BEGIN

If @Attribute LIKE 'NoHist_%'
      Begin
          Return
      End

etc.

FETCH NEXT FROM mycursor into @Attribute, @ParameterValue;
END
</code></pre>

<p>Triggers, at least in SQL Server, are a big pain and I avoid using them at all.</p>
</div>
    <table class="fw">
    <tr>
    <td class="vt">











<div class="post-menu"><a href="/a/562458" title="short permalink to this answer" class="short-link" id="link-post-562458">share</a><span class="lsep">|</span><a href="/posts/562458/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    
<div class="user-info ">
    <div class="user-action-time">
        
        
            answered <span title="2009-02-18 19:23:21Z" class="relativetime">Feb 18 '09 at 19:23</span>
        

    </div>
    <div class="user-gravatar32">
        <span class="anonymous-gravatar"></span>
    </div>
    <div class="user-details">
        <br>
        
    </div>
</div>
    </td>
    </tr>
    </table>
</td>        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-562458" class="comments" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="" 
			           data-addlink-disabled="true">

    <tr id="comment-4408606" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">You can deal with multiple inserts or updates just fine if, from the outset, you design your triggers with multi-row data in mind. IMHO the OP&#39;s first attempt (&quot;where I.Attribute NOT LIKE &#39;NoHist_%&#39;&quot;) should have done just that... no idea what went wrong.</span>
	&ndash;&nbsp;
		<a href="/users/158371/christian-severin" 
		   title="909 reputation" 
		   class="comment-user">Christian Severin</a>
	<span class="comment-date" dir="ltr"><span title="2010-11-04 13:42:47Z" class="relativetime-clean">Nov 4 '10 at 13:42</span></span>
		<span class="edited-yes" title="this comment was edited 1 time"></span>
				</div>

        </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-562458" 
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."></a>
    </td>
</tr>
    </table>
</div>
									<a name='new-answer'></a>
						<form id="post-form" action="/questions/280904/answer/submit" method="post"  class="post-form">
							<input type="hidden" id="post-id" value="280904" />
							<h2 class="space">Your Answer</h2>



    

<script type="text/javascript">
    StackExchange.ready(function() {
        initTagRenderer("".split(" "), "".split(" "));
         
        prepareEditor({
            heartbeatType: 'answer',
            bindNavPrevention: true,
            postfix: "",
            onDemand: true,
            discardSelector: ".discard-answer"
            ,immediatelyShowMarkdownHelp:true
        });
        

    });  
</script>


<div id="post-editor" class="post-editor">

    <div style="position: relative;">     
        <div class="wmd-container">
            <div id="wmd-button-bar" class="wmd-button-bar"></div>
            <textarea id="wmd-input" class="wmd-input" name="post-text" cols="92" rows="15" tabindex="101" data-min-length=""></textarea>
        </div>
    </div>

    <div class="fl" style="margin-top: 8px; height:24px;">&nbsp;</div>
    <div id="draft-saved" class="draft-saved community-option fl" style="margin-top: 8px; height:24px; display:none;">draft saved</div>

    <div id="draft-discarded" class="draft-discarded community-option fl" style="margin-top: 8px; height:24px; display:none;">draft discarded</div>



    <div id="wmd-preview" class="wmd-preview"></div>
    <div></div>
    <div class="edit-block">
        <input id="fkey" name="fkey" type="hidden" value="595e453a90deb79876026b8ee52ee2b4">
        <input id="author" name="author" type="text">
    </div>
</div>
							<div style="position: relative;">
								
            <div class="form-item dno new-post-login">
        
                <div class="new-login-form">
                    <div class="new-login-left">
                        <h3>Sign up or <a id="login-link" href="/users/login?returnurl=%2fquestions%2f280904%2ftrigger-to-fire-only-if-a-condition-is-met-in-sql-server%23new-answer">login</a></h3>
                        <script type="text/javascript">
                            StackExchange.ready(function () {
                                StackExchange.helpers.onClickDraftSave('#login-link');
                            });
                        </script>
                        <div class="preferred-login google-login">
                            <p><span class="icon"></span><span>Sign up using Google</span></p>
                        </div>
                        <div class="preferred-login facebook-login">
                            <p><span class="icon"></span><span>Sign up using Facebook</span></p>
                        </div>
                        <div class="preferred-login stackexchange-login">
                            <p><span class="icon"></span><span>Sign up using Stack Exchange</span></p>
                        </div>
                    </div>
                    <input type="hidden" name="manual-openid" class="manual-openid" />
                    <input type="hidden" name="use-facebook" class="use-facebook" value="false" />
                    <input type="button" class="submit-openid" value="Submit" style="display:none" />
                    <div class="new-login-right">
                                <h3>Post as a guest</h3>
    <div class="form-item">
        <table>
        <tr>
                    <script type="text/javascript">
                StackExchange.ready(function () {
                    StackExchange.helpers.bindHelpOverlayEvents($('.vm input'));
                });
            </script>
            <td class="vm">
                <div>
                    <label for="display-name">Name</label>
                    <input id="display-name" name="display-name" type="text" size="30" maxlength="30" value="" tabindex="105">
                </div>
                <div>
                    <label for="m-address">Email</label>
                    <input id="m-address" name="m-address" type="text" size="30" maxlength="100" value="" tabindex="106">
                    <span class="edit-field-overlay">required, but not shown</span>
                </div>
            </td>
        </tr>
        </table>
    </div>

                    </div>
                </div>
            </div>
            <script type="text/javascript">
                StackExchange.ready(
                    function () {
                        StackExchange.openid.initPostLogin('.new-post-login', '%2fquestions%2f280904%2ftrigger-to-fire-only-if-a-condition-is-met-in-sql-server%23new-answer');
                    }
                );
            </script>
            <noscript>
                        <h3>Post as a guest</h3>
    <div class="form-item">
        <table>
        <tr>
                    <script type="text/javascript">
                StackExchange.ready(function () {
                    StackExchange.helpers.bindHelpOverlayEvents($('.vm input'));
                });
            </script>
            <td class="vm">
                <div>
                    <label for="display-name">Name</label>
                    <input id="display-name" name="display-name" type="text" size="30" maxlength="30" value="" tabindex="105">
                </div>
                <div>
                    <label for="m-address">Email</label>
                    <input id="m-address" name="m-address" type="text" size="30" maxlength="100" value="" tabindex="106">
                    <span class="edit-field-overlay">required, but not shown</span>
                </div>
            </td>
        </tr>
        </table>
    </div>

            </noscript>
							</div>
           
															<div class="form-submit cbt">
									<input id="submit-button" type="submit" value="Post Your Answer" tabindex="110">
									<a href="#" class="discard-answer dno">discard</a>

<p class="privacy-policy-agreement">
By posting your answer, you agree to the <a href='http://stackexchange.com/legal/privacy-policy' target='_blank'>privacy policy</a> and <a href='http://stackexchange.com/legal/terms-of-service' target='_blank'>terms of service</a>.</p>
<input type="hidden" name="legalLinksShown" value="1" />								</div>
						</form>



						<h2 class="bottom-notice">
Not the answer you&#39;re looking for?							Browse other questions tagged <a href="/questions/tagged/sql-server" class="post-tag" title="show questions tagged &#39;sql-server&#39;" rel="tag">sql-server</a> <a href="/questions/tagged/triggers" class="post-tag" title="show questions tagged &#39;triggers&#39;" rel="tag">triggers</a>  or <a href="/questions/ask">ask your own question</a>.						</h2>
			</div>
		</div>
				<div id="sidebar" class="show-votes">
							<div class="module question-stats">
					<p class="label-key">tagged</p>
					<div class="tagged"><a href="/questions/tagged/sql-server" class="post-tag" title="show questions tagged &#39;sql-server&#39;" rel="tag">sql-server</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">&times;</span>&nbsp;<span class="item-multiplier-count">82106</span></span><br>
<a href="/questions/tagged/triggers" class="post-tag" title="show questions tagged &#39;triggers&#39;" rel="tag">triggers</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">&times;</span>&nbsp;<span class="item-multiplier-count">6058</span></span><br>
</div>
					<table id="qinfo">
						<tr>
							<td>
								<p class="label-key">asked</p>
							</td>
							<td style="padding-left: 10px">
								<p class="label-key" title="2008-11-11 13:45:47Z"><b>5 years ago</b></p>
							</td>
						</tr>
						<tr>
							<td>
								<p class="label-key">viewed</p>
							</td>

							<td style="padding-left: 10px">
								<p class="label-key">
									<b>23137 times</b>
								</p>
							</td>
						</tr>
							<tr>
								<td>
									<p class="label-key">active</p>
								</td>
								<td style="padding-left: 10px">
									<p class="label-key"><b><a href="?lastactivity" class="lastactivity-link" title="2012-11-30 00:24:06Z">11 months ago</a></b></p>
								</td>
							</tr>
					</table>
				</div>
						
			            <script type="text/javascript">
                var ados = ados || {};ados.run = ados.run || [];
                ados.run.push(function() { ados_add_placement(22,8277,"adzerk928708704",17).setZone(45) ; });                    
            </script>
            <div class="everyonelovesstackoverflow" id="adzerk928708704">
            </div>  
    <div id="hireme">
        <script type="text/javascript">
window.careers_adurl="//careers.stackoverflow.com/gethired/js",window.careers_cssurl="//cdn-careers.sstatic.net/careers/gethired/sidebar.min.css?v=3c55a7a05afd",window.careers_leaderboardcssurl="//cdn-careers.sstatic.net/careers/gethired/ninja.min.css?v=78ccbfa5c59f",window.careers_companycssurl="//cdn-careers.sstatic.net/careers/gethired/company",window.careers_adselector="div.hireme, div#hireme",StackExchange.ready(function(){$.ajax({url:"//cdn-careers.sstatic.net/careers/gethired/loader.min.js?v=de73430809b3",dataType:"script",cache:!0})});        </script>
    </div>



			  
    
            <div class="module sidebar-linked">
	<h4 id="h-linked">Linked</h4>
	<div class="linked" data-tracker="lq=1">
<div class="spacer">
	<a href="/q/6276250" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">0</div>
	</a>
	<a href="/questions/6276250/if-exists-in-trigger" class="question-hyperlink">If Exists in trigger</a>
</div><div class="spacer">
	<a href="/q/16721237" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">0</div>
	</a>
	<a href="/questions/16721237/sql-trigger-if-statement-prevent-update" class="question-hyperlink">sql trigger - if statement - Prevent update</a>
</div>			</div>
</div>


				<div class="module sidebar-related">
					<h4 id="h-related">Related</h4>
					<div class="related" data-tracker="rq=1">
						<div class="spacer">
<a href="/q/650761" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">1
    </div>
</a><a href="/questions/650761/sql-server-triggers-grouping-by-transactions" class="question-hyperlink">SQL Server Triggers - grouping by transactions</a>
</div>
<div class="spacer">
<a href="/q/707724" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">1
    </div>
</a><a href="/questions/707724/help-with-sql-server-trigger" class="question-hyperlink">Help with sql server trigger</a>
</div>
<div class="spacer">
<a href="/q/1187711" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">2
    </div>
</a><a href="/questions/1187711/sql-server-trigger-copy-row-before-updating" class="question-hyperlink">SQL Server trigger - copy row before updating</a>
</div>
<div class="spacer">
<a href="/q/4034538" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">2
    </div>
</a><a href="/questions/4034538/sql-server-triggers" class="question-hyperlink">Sql Server Triggers</a>
</div>
<div class="spacer">
<a href="/q/4468937" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">1
    </div>
</a><a href="/questions/4468937/sql-server-trigger-set-noresults-on" class="question-hyperlink">SQL Server trigger - SET NORESULTS ON?</a>
</div>
<div class="spacer">
<a href="/q/4593653" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">4
    </div>
</a><a href="/questions/4593653/sql-server-update-trigger" class="question-hyperlink">SQL Server Update Trigger</a>
</div>
<div class="spacer">
<a href="/q/4982403" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">4
    </div>
</a><a href="/questions/4982403/sql-server-update-trigger-not-unique-insert-issue" class="question-hyperlink">SQL Server Update Trigger (Not Unique Insert Issue)</a>
</div>
<div class="spacer">
<a href="/q/8015403" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">1
    </div>
</a><a href="/questions/8015403/sql-trigger-on-insert" class="question-hyperlink">sql trigger on insert</a>
</div>
<div class="spacer">
<a href="/q/10642234" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">1
    </div>
</a><a href="/questions/10642234/sql-trigger-for-only-currently-inserted-row" class="question-hyperlink">SQL Trigger for ONLY currently inserted row</a>
</div>
<div class="spacer">
<a href="/q/18695815" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">0
    </div>
</a><a href="/questions/18695815/handling-multiple-rows-in-sql-server-trigger" class="question-hyperlink">Handling multiple rows in SQL Server trigger</a>
</div>

					</div>
				</div>
		</div>
	
<div id="feed-link">
    <div id="feed-link-text"><a href="/feeds/question/280904" title="feed of this question and its answers"><span class="feed-icon"></span>question feed</a></div>
</div>
	<script type="text/javascript">
StackExchange.ready(function(){$.get('/posts/280904/ivc/1f9d');});
</script>
<noscript>
    <div><img src="/posts/280904/ivc/1f9d" class="dno" alt="" width="0" height="0"></div>
</noscript><div style="display:none" id="prettify-lang">lang-sql</div></div>


        </div>
    </div>
    <div id="footer" class="categories">
        <div class="footerwrap">
            <div id="footer-menu">
                <div class="top-footer-links">
                        <a href="/about">about</a>
                    <a href="/help">help</a>
                        <a href="/help/badges">badges</a>
                    <a href="http://blog.stackexchange.com?blb=1">blog</a>
                        <a href="http://chat.stackoverflow.com">chat</a>
                    <a href="http://data.stackexchange.com">data</a>
                    <a href="http://stackexchange.com/legal">legal</a>
                    <a href="http://stackexchange.com/legal/privacy-policy">privacy policy</a>
                    <a href="http://stackexchange.com/about/hiring">jobs</a>
                    <a href="http://engine.adzerk.net/r?e=eyJhdiI6NDE0LCJhdCI6MjAsImNtIjo5NTQsImNoIjoxMTc4LCJjciI6Mjc3NiwiZG0iOjQsImZjIjoyODYyLCJmbCI6Mjc1MSwibnciOjIyLCJydiI6MCwicHIiOjExNSwic3QiOjAsInVyIjoiaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2Fib3V0L2NvbnRhY3QiLCJyZSI6MX0&amp;s=hRods5B22XvRBwWIwtIMekcyNF8">advertising info</a>

                    <a onclick='StackExchange.switchMobile("on", "/questions/280904/trigger-to-fire-only-if-a-condition-is-met-in-sql-server")'>mobile</a>
                    <b><a href="/contact">contact us</a></b>
                        <b><a href="http://meta.stackoverflow.com">feedback</a></b>
                    
                </div>
                <div id="footer-sites">
                    <table>
    <tr>
            <th colspan=3>
                Technology
            </th>
            <th >
                Life / Arts
            </th>
            <th >
                Culture / Recreation
            </th>
            <th >
                Science
            </th>
            <th >
                Other
            </th>
    </tr>
    <tr>
            <td>
                <ol>
                        <li><a href="http://stackoverflow.com" title="professional and enthusiast programmers">Stack Overflow</a></li>
                        <li><a href="http://serverfault.com" title="professional system and network administrators">Server Fault</a></li>
                        <li><a href="http://superuser.com" title="computer enthusiasts and power users">Super User</a></li>
                        <li><a href="http://webapps.stackexchange.com" title="power users of web applications">Web Applications</a></li>
                        <li><a href="http://askubuntu.com" title="Ubuntu users and developers">Ask Ubuntu</a></li>
                        <li><a href="http://webmasters.stackexchange.com" title="pro webmasters">Webmasters</a></li>
                        <li><a href="http://gamedev.stackexchange.com" title="professional and independent game developers">Game Development</a></li>
                        <li><a href="http://tex.stackexchange.com" title="users of TeX, LaTeX, ConTeXt, and related typesetting systems">TeX - LaTeX</a></li>
                            </ol></td><td><ol>
                        <li><a href="http://programmers.stackexchange.com" title="professional programmers interested in conceptual questions about software development">Programmers</a></li>
                        <li><a href="http://unix.stackexchange.com" title="users of Linux, FreeBSD and other Un*x-like operating systems.">Unix &amp; Linux</a></li>
                        <li><a href="http://apple.stackexchange.com" title="power users of Apple hardware and software">Ask Different (Apple)</a></li>
                        <li><a href="http://wordpress.stackexchange.com" title="WordPress developers and administrators">WordPress Answers</a></li>
                        <li><a href="http://gis.stackexchange.com" title="cartographers, geographers and GIS professionals">Geographic Information Systems</a></li>
                        <li><a href="http://electronics.stackexchange.com" title="electronics and electrical engineering professionals, students, and enthusiasts">Electrical Engineering</a></li>
                        <li><a href="http://android.stackexchange.com" title="enthusiasts and power users of the Android operating system">Android Enthusiasts</a></li>
                        <li><a href="http://security.stackexchange.com" title="Information security professionals">Information Security</a></li>
                            </ol></td><td><ol>
                        <li><a href="http://dba.stackexchange.com" title="database professionals who wish to improve their database skills and learn from others in the community">Database Administrators</a></li>
                        <li><a href="http://drupal.stackexchange.com" title="Drupal developers and administrators">Drupal Answers</a></li>
                        <li><a href="http://sharepoint.stackexchange.com" title="SharePoint enthusiasts">SharePoint</a></li>
                        <li><a href="http://ux.stackexchange.com" title="user experience researchers and experts">User Experience</a></li>
                        <li><a href="http://mathematica.stackexchange.com" title="users of Mathematica">Mathematica</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#technology" class="more">
                                more (14)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://photo.stackexchange.com" title="professional, enthusiast and amateur photographers">Photography</a></li>
                        <li><a href="http://scifi.stackexchange.com" title="science fiction and fantasy enthusiasts">Science Fiction &amp; Fantasy</a></li>
                        <li><a href="http://cooking.stackexchange.com" title="professional and amateur chefs">Seasoned Advice (cooking)</a></li>
                        <li><a href="http://diy.stackexchange.com" title="contractors and serious DIYers">Home Improvement</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#lifearts" class="more">
                                more (13)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://english.stackexchange.com" title="linguists, etymologists, and serious English language enthusiasts">English Language &amp; Usage</a></li>
                        <li><a href="http://skeptics.stackexchange.com" title="scientific skepticism">Skeptics</a></li>
                        <li><a href="http://judaism.stackexchange.com" title="those who base their lives on Jewish law and tradition and anyone interested in learning more">Mi Yodeya (Judaism)</a></li>
                        <li><a href="http://travel.stackexchange.com" title="road warriors and seasoned travelers">Travel</a></li>
                        <li><a href="http://christianity.stackexchange.com" title="committed Christians, experts in Christianity and those interested in learning more">Christianity</a></li>
                        <li><a href="http://gaming.stackexchange.com" title="passionate videogamers on all platforms">Arqade (gaming)</a></li>
                        <li><a href="http://bicycles.stackexchange.com" title="people who build and repair bicycles, people who train cycling, or commute on bicycles">Bicycles</a></li>
                        <li><a href="http://rpg.stackexchange.com" title="gamemasters and players of tabletop, paper-and-pencil role-playing games">Role-playing Games</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#culturerecreation" class="more">
                                more (21)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://math.stackexchange.com" title="people studying math at any level and professionals in related fields">Mathematics</a></li>
                        <li><a href="http://stats.stackexchange.com" title="statisticians, data analysts, data miners and data visualization experts">Cross Validated (stats)</a></li>
                        <li><a href="http://cstheory.stackexchange.com" title="theoretical computer scientists and researchers in related fields">Theoretical Computer Science</a></li>
                        <li><a href="http://physics.stackexchange.com" title="active researchers, academics and students of physics">Physics</a></li>
                        <li><a href="http://mathoverflow.net" title="professional mathematicians">MathOverflow</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#science" class="more">
                                more (7)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://stackapps.com" title="apps, scripts, and development with the Stack Exchange API">Stack Apps</a></li>
                        <li><a href="http://meta.stackoverflow.com" title="meta-discussion of the Stack Exchange family of Q&amp;A websites">Meta Stack Overflow</a></li>
                        <li><a href="http://area51.stackexchange.com" title="proposing new sites in the Stack Exchange network">Area 51</a></li>
                        <li><a href="http://careers.stackoverflow.com">Stack Overflow Careers</a></li>
                    
                </ol>
            </td>
    </tr>
</table>
                </div>
            </div>

            <div id="copyright">
                site design / logo &#169; 2013 stack exchange inc; user contributions licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license">cc-wiki</a> 
 with <a href="http://blog.stackoverflow.com/2009/06/attribution-required/" rel="license">attribution required</a>
            </div>
            <div id="footer-flair">
                <a href="http://creativecommons.org/licenses/by-sa/3.0/" class="cc-wiki-link"></a>
            </div>
            <div id="svnrev">
                rev 2013.11.22.1174
            </div>
            
        </div>
    </div>
    <noscript>
        <div id="noscript-warning">Stack Overflow works best with JavaScript enabled<img src="http://pixel.quantserve.com/pixel/p-c1rF4kxgLUzNc.gif" alt="" class="dno"></div>
    </noscript>
<script type="text/javascript">var p = "http", d = "static"; if (document.location.protocol == "https:") { p += "s"; d = "engine"; } var z = document.createElement("script"); z.type = "text/javascript"; z.async = true; z.src = p + "://" + d + ".adzerk.net/ados.js"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(z, s);</script>
<script type="text/javascript">
    var ados = ados || {};
    ados.run = ados.run || [];
    ados.run.push(function () { ados_setKeywords('sql-server,triggers');; ados_load(); });         
</script>

    <script type="text/javascript">var _gaq=_gaq||[];_gaq.push(['_setAccount','UA-5620270-1']);
        _gaq.push(['_setCustomVar', 1, 'tags', '|sql-server|triggers|']); 
_gaq.push(['_trackPageview']);
    var _qevents = _qevents || [];
    var _comscore = _comscore || [];
    (function () {
        var ssl='https:'==document.location.protocol,
            s=document.getElementsByTagName('script')[0],
            ga=document.createElement('script');
        ga.type='text/javascript';
        ga.async=true;
        ga.src=(ssl?'https://ssl':'http://www')+'.google-analytics.com/ga.js';
        s.parentNode.insertBefore(ga,s);
        var sc=document.createElement('script');
        sc.type='text/javascript';
        sc.async=true;
        sc.src=(ssl?'https://secure':'http://edge')+'.quantserve.com/quant.js';
        s.parentNode.insertBefore(sc, s);
        
        var s = document.createElement("script"), el = document.getElementsByTagName("script")[0]; s.async = true;
        s.src = (document.location.protocol == "https:" ? "https://sb" : "http://b") + ".scorecardresearch.com/beacon.js";
        el.parentNode.insertBefore(s, el);
        
    })();
    _comscore.push({ c1: "2", c2: "17440561" });
    _qevents.push({ qacct: "p-c1rF4kxgLUzNc" });
    </script>        
    
</body>
</html>