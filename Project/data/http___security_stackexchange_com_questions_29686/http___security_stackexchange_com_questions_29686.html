<!DOCTYPE html>
<html>
<head>
    
    <title>ssl - How does OCSP stapling work? - Information Security Stack Exchange</title>
    <link rel="shortcut icon" href="//cdn.sstatic.net/security/img/favicon.ico">
    <link rel="apple-touch-icon image_src" href="//cdn.sstatic.net/security/img/apple-touch-icon.png">
    <link rel="search" type="application/opensearchdescription+xml" title="Information Security Stack Exchange" href="/opensearch.xml">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@StackSecurity" />
    <meta name="twitter:domain" content="security.stackexchange.com"/>
    <meta name="og:type" content="website" />
    <meta name="og:image" content="http://cdn.sstatic.net/security/img/apple-touch-icon@2.png?v=497726d850f9"/>
    <meta name="og:title" content="How does OCSP stapling work?" />
    <meta name="og:description" content="I&#39;ve been looking into OCSP stapling for HTTPS, which looks pretty interesting. From what I can tell, it&#39;s essentially a way of offloading CRLs from the CA to the server, allowing for everything to..." />
    <meta name="og:url" content="http://security.stackexchange.com/questions/29686/how-does-ocsp-stapling-work"/>
    <link rel="canonical" href="http://security.stackexchange.com/questions/29686/how-does-ocsp-stapling-work" />

    
    
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="//cdn.sstatic.net/Js/stub.en.js?v=e3d47b73fa12" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="//cdn.sstatic.net/security/all.css?v=d8e2635c1981">
    
    <link rel="alternate" type="application/atom+xml" title="Feed for question &#39;How does OCSP stapling work?&#39;" href="/feeds/question/29686">
    <script type="text/javascript">
        
        StackExchange.ready(function () {
            StackExchange.using("postValidation", function () {
                StackExchange.postValidation.initOnBlurAndSubmit($('#post-form'), 2, 'answer');
            });

            
            StackExchange.question.init({showAnswerHelp:true,totalCommentCount:0,shownCommentCount:0,highlightColor:'#F4A83D',backgroundColor:'#FFF',questionId:29686});

            styleCode();

                StackExchange.realtime.subscribeToQuestion('162', '29686');
            
                    });
    </script>


    <script type="text/javascript">
        StackExchange.ready(function () {
            StackExchange.realtime.init('wss://qa.sockets.stackexchange.com,ws://qa.sockets.stackexchange.com');
            StackExchange.realtime.subscribeToInboxNotifications();
                    StackExchange.realtime.subscribeToReputationNotifications('162');
                        });
    </script>
    <script type="text/javascript">
        StackExchange.init({"locale":"en","stackAuthUrl":"https://stackauth.com","serverTime":1385426556,"enableUserHovercards":true,"site":{"name":"Information Security Stack Exchange","description":"Q&A for Information security professionals","isNoticesTabEnabled":true,"recaptchaPublicKey":"6LdsB7sSAAAAAAzjgEF_Hd8vXv-C42sa_KyofaGR","enableSocialMediaInSharePopup":true},"user":{"fkey":"f51c005c36aeb04be7163e16a81b52d5","isAnonymous":true}});
        StackExchange.using.setCacheBreakers({"js/prettify-full.en.js":"e0bbd4760e83","js/moderator.en.js":"1a411fd265fe","js/full-anon.en.js":"8a881a0975af","js/full.en.js":"e87912181c10","js/wmd.en.js":"bd9234d44a40","js/third-party/jquery.autocomplete.min.js":"e5f01e97f7c3","js/third-party/jquery.autocomplete.min.en.js":"","js/mobile.en.js":"d1d834ef85d2","js/help.en.js":"d3cc74d8a93a","js/tageditor.en.js":"6d51a5f8d7f3","js/tageditornew.en.js":"111b781cf314","js/inline-tag-editing.en.js":"f951bd09dc69","js/revisions.en.js":"33fd38144303","js/review.en.js":"f45b4ec094ea","js/tagsuggestions.en.js":"e4e7b952fcc7","js/post-validation.en.js":"c275fe37d674","js/explore-qlist.en.js":"73825bd006fc","js/events.en.js":"53bc48767091"});
        StackExchange.using("gps", function() {
             StackExchange.gps.init(true);
        });
        
    </script>
    
        <script type="text/javascript">
            StackExchange.ready(function () {
                $('#nav-tour').click(function () {
                    StackExchange.using("gps", function() {
                        StackExchange.gps.track("aboutpage.click", { aboutclick_location: "headermain" }, true);
                    });
                });
            });
        </script>
</head>
<body class="question-page">
    <noscript><div id="noscript-padding"></div></noscript>
    <div id="notify-container"></div>
    <div id="overlay-header"></div>
    <div id="custom-header"></div>
    <div class="container">
        <div id="header" class=headeranon>
            <div id="portalLink">
                <a class="genu" href="http://stackexchange.com" onclick="StackExchange.ready(function(){genuwine.click();});return false;">Stack Exchange</a>
            </div>
            <div id="topbar">
                <div id="hlinks">
                    
<span id="hlinks-user"></span>
<span id="hlinks-nav">                        <a href="/users/login?returnurl=%2fquestions%2f29686%2fhow-does-ocsp-stapling-work">sign up</a>

 <span class="lsep">|</span>
                    <a href="/users/login?returnurl=%2fquestions%2f29686%2fhow-does-ocsp-stapling-work">log in</a>

 <span class="lsep">|</span>
</span>
<span id="hlinks-custom"></span>
                </div>
                <div id="hsearch">
                    <form id="search" action="/search" method="get" autocomplete="off">
                        <div>
                            <input autocomplete="off" name="q" class="textbox" placeholder="search" tabindex="1" type="text" maxlength="240" size="28" value="">
                        </div>
                    </form>
                </div>
            </div>
            <br class="cbt">
            <div id="hlogo">
                <a href="/">
                    Information Security
                </a>
            </div>
            <div id="hmenus">
                <div class="nav mainnavs mainnavsanon">
                    <ul>
                            <li class="youarehere"><a id="nav-questions" href="/questions">Questions</a></li>
                            <li><a id="nav-tags" href="/tags">Tags</a></li>
                            <li><a id="nav-tour" href="/about">Tour</a></li>
                            <li><a id="nav-users" href="/users">Users</a></li>
                    </ul>
                </div>
                <div class="nav askquestion">
                    <ul>
                        <li>
                            <a id="nav-askquestion"  href="/questions/ask">Ask Question</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        



        <div id="content">
            

<div itemscope itemtype="http://schema.org/Article">
	<link itemprop="image" href="//cdn.sstatic.net/security/img/apple-touch-icon.png">
			<!--googleoff: all-->
<div id="herobox-mini">
    <div id="hero-content">
        <span id="controls">
            <a href="/about" id="tell-me-more" class="button">Tell me more</a>
            <span id="close"><a title="click to dismiss">&times;</a></span>
        </span>
        <div id="blurb">
            Information Security Stack Exchange is a question and answer site for Information security professionals. It&#39;s 100% free, no registration required.
        </div>        
    </div>
    <script>
        $('#tell-me-more').click(function () {
            var clickSource = $("body").attr("class") + '-mini';
            if ($("body").hasClass("questions-page")) {
                clickSource = 'questionpagemini';
            }
            if ($("body").hasClass("home-page")) {
                clickSource = 'homepagemini';
            }

            StackExchange.using("gps", function () {
                StackExchange.gps.track("aboutpage.click", { aboutclick_location: clickSource } , true);
            });
        });
        $('#herobox-mini #close').click(function () {
            StackExchange.using("gps", function () {
                StackExchange.gps.track("hero.action", { hero_action_type: "close" }, true);
            });
            $.cookie("hero", "none", { path: "/" });
            var $hero = $("#herobox-mini");
            $hero.slideUp('fast', function () { $hero.remove(); });
            return false;
        });
    </script>
</div>
			<!--googleon: all-->
			<div id="question-header">
			<h1 itemprop="name"><a href="/questions/29686/how-does-ocsp-stapling-work" class="question-hyperlink">How does OCSP stapling work?</a></h1>
		</div>
			<div id="mainbar">

			

<div class="question" data-questionid="29686"  id="question">
    
        <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="29686">
    <a class="vote-up-off" title="This question shows research effort; it is useful and clear">up vote</a>
    <span class="vote-count-post ">11</span>
    <a class="vote-down-off" title="This question does not show any research effort; it is unclear or not useful">down vote</a>
    
    <a class="star-off" href="#" title="This is a favorite question (click again to undo)">favorite</a>
    <div class="favoritecount"><b>5</b></div>   

</div>

            </td>
            
<td class="postcell">
<div>
    <div class="post-text" itemprop="description">

        <p>I've been looking into <a href="http://en.wikipedia.org/wiki/OCSP_stapling">OCSP stapling</a> for HTTPS, which looks pretty interesting. From what I can tell, it's essentially a way of offloading CRLs from the CA to the server, allowing for everything to be done in one connection, which mitigates some privacy issues. How does the process work from a high-level perspective?</p>

<p>I'm mainly interested in:</p>

<ul>
<li>Where / how does OCSP stapling get flagged as enabled? Is it something the CA does?</li>
<li>How does the server get the updated CRL from the CA? How does it know when to update?</li>
<li>What stops someone from stripping the "OCSP is enabled" flag from the handshake?</li>
<li>If the SSL connection is compromised (e.g. through BEAST or a private key leak) does it open up an opportunity for the attacker to cause long-term problems by manipulating the CRL?</li>
</ul>

    </div>
    <div class="post-taglist">
        <a href="/questions/tagged/ssl" class="post-tag" title="show questions tagged &#39;ssl&#39;" rel="tag">ssl</a> <a href="/questions/tagged/certificate-authority" class="post-tag" title="show questions tagged &#39;certificate-authority&#39;" rel="tag">certificate-authority</a> <a href="/questions/tagged/ocsp" class="post-tag" title="show questions tagged &#39;ocsp&#39;" rel="tag">ocsp</a> 
    </div>
    <table class="fw">
    <tr>
    <td class="vt">











<div class="post-menu"><a href="/q/29686" title="short permalink to this question" class="short-link" id="link-post-29686">share</a><span class="lsep">|</span><a href="/posts/29686/edit" class="suggest-edit-post" title="">improve this question</a></div>        
    </td>
    <td class="post-signature owner">
        
<div class="user-info user-hover">
    <div class="user-action-time">
        
        
            asked <span title="2013-01-25 09:05:06Z" class="relativetime">Jan 25 at 9:05</span>
        

    </div>
    <div class="user-gravatar32">
        <a href="/users/5400/polynomial"><div><img src="https://www.gravatar.com/avatar/6fc641bdddde78a51c0db6b8527c54f7?s=32&d=identicon&r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/5400/polynomial">Polynomial</a><br>
        <span class="reputation-score" title="reputation score 39083" dir="ltr">39.1k</span><span title="10 gold badges"><span class="badge1"></span><span class="badgecount">10</span></span><span title="84 silver badges"><span class="badge2"></span><span class="badgecount">84</span></span><span title="157 bronze badges"><span class="badge3"></span><span class="badgecount">157</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</div>
</td>
        </tr>
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-29686" class="comments dno" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">
					    <tr><td></td><td></td></tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-29686" data-rep=50 data-anon=true
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid answering questions in comments." 
				>add comment</a>
    </td>
</tr>            </table>    
</div>


			<div id="answers">

				<a name="tab-top"></a>
				<div id="answers-header">
					<div class="subheader answers-subheader">
						<h2>
								1 Answer
						</h2>
						<div>
							<div id="tabs">
        <a href="/questions/29686/how-does-ocsp-stapling-work?answertab=active#tab-top" title="Answers with the latest activity first">active</a>
        <a href="/questions/29686/how-does-ocsp-stapling-work?answertab=oldest#tab-top" title="Answers in the order they were provided">oldest</a>
        <a class="youarehere" href="/questions/29686/how-does-ocsp-stapling-work?answertab=votes#tab-top" title="Answers with the highest score first">votes</a>
</div>
						</div>
					</div>    
				</div>    




  
<a name="29694"></a>
<div id="answer-29694" class="answer accepted-answer" data-answerid="29694" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="29694">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">11</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


        <span class="vote-accepted-on load-accepted-answer-date" title="loading when this answer was accepted...">accepted</span>
</div>

            </td>



<td class="answercell">
    <div class="post-text"><p>A <strong>CRL</strong> is an object which contains the list of serial numbers of certificates which have been revoked by a given CA. It is a signed object; the CRL issuer is usually the CA itself (with the same key) but this power can be delegated.</p>

<p>An <strong>OCSP response</strong> is what an OCSP responder returns when it receives a request about the revocation status of a certificate. The request / response protocol is specified in <a href="http://tools.ietf.org/html/rfc2560">RFC 2560</a>. The responses themselves are <em>signed</em> by the responder and they can have an independent life; this means that a given OCSP response can be considered as a specialized CRL which talks about a single certificate.</p>

<p>During <strong>certificate validation</strong>, the verifier (e.g. a Web browser, when validating the server's certificate) must build a chain of certificate, from one of its <em>trust anchor</em> (aka root certificates), verify all the signatures and names and extensions, and then proceeds with ascertaining the <em>revocation status</em> of each certificate in the chain. This last step entails obtaining CRL and/or OCSP responses, validating them (which means verifying the signatures on them), and reading their contents. This raises two distinct types of question:</p>

<ol>
<li>How does a verifier check that a CRL or OCSP response is genuine and up-to-date and really applies to the certificate at hand ?</li>
<li>How does a verifier obtains the CRL or OCSP response in the first place ?</li>
</ol>

<p><strong>CRL / OCSP match with a certificate</strong></p>

<p>Let's concentrate on the following setup: the verifier wants to obtain the revocation status of certificate <em>T</em> (as "target"). He has already built and verified a chain of certificates which ends with CA certificate <em>C</em> followed by <em>T</em>, which means that the signature on <em>T</em> matches the public key in <em>C</em>. Also, the revocation status of <em>C</em> has been verified, and it is now <em>T</em> which the verifier is interested in. <em>T</em> can be an end-entity certificate (e.g. the SSL server's certificate) or another CA certificate as part of a longer chain, which extends beyond <em>T</em>.</p>

<p>A CRL is signed; <em>who</em> signs it is a matter of a subtle distinction between <a href="http://en.wikipedia.org/wiki/X.509">X.509</a> and its <a href="http://tools.ietf.org/html/rfc5280">PKIX interpretation in the context of the Internet</a>. For the "original" X.509, a CRL is valid if it is signed by an entity who has a valid certificate and bears the same <em>Distinguished Name</em> as the CA. This works well if the CRL is signed by the same public key than <em>T</em>, i.e. the key of the CA <em>C</em>: at that point, <em>C</em> is a fully validated certificate so its public key can be "trusted" (the verifier is reasonably sure that the public key is really owned by an entity which goes under the name given in <em>C</em>'s <code>subjectDN</code> field). However, it could be any other certificate with that name, and located at the end of a valid chain of its own (which may imply more path building, validation and processing of CRL). In X.509, distinguished names are everything, because X.509 was meant for the <em>Directory</em>, the worldwide LDAP-like server aggregate where <em>everything</em> is uniquely referenced by it distinguished name.</p>

<p>PKIX, the working group which deals with the Internet, has noticed that the Directory, marvelous as it may be, shares some characteristics with mythical beasts like the <a href="http://en.wikipedia.org/wiki/Mokele-mbembe">Mokèlé-mbèmbé</a>, specifically that it does not appear to exist at all (at least, no confirmed sighting has been reported). Correspondingly, PKIX enforces a restriction to keep trouble contained: the certificate of the CRL issuer must be at the end of a path which begins with the same trust anchor as the path which ends with <em>T</em>. This should avoid trans-root issues when two distinct CA which do not know each other ended up using the same distinguished names (they could have noticed the issue right away if they had worked in the context of the Directory, if it had existed). This specific point is in <a href="http://tools.ietf.org/html/rfc5280">RFC 5280</a>, section 6.3.3, step (f).</p>

<p>The role of CRL issuer can be delegated, in which case the distinguished name of the CRL issuer is found in the <code>CRL Distribution Points</code> extension in <em>T</em> itself, and a matching <code>Issuing Distribution Point</code> extension is found in the CRL.</p>

<p>For OCSP responses, a similar system is used. The OCSP response may be signed by the CA itself (with the key in <em>C</em>); or there may be a dedicated issuer. Things are more constrained there: when there is a dedicated issuer, it must have a certificate which is directly issued by <em>C</em> itself, and bearing a specific extension which marks it as an OCSP responder (<code>Extended Key Usage</code> with the <code>id-kp-OCSPSigning</code> OID, see section 4.2.2.2 of <a href="http://tools.ietf.org/html/rfc2560">RFC 2560</a>). The certificate for that responder can be attached to the OCSP response itself (outside of the signed area, but encoded within the same blob nonetheless).</p>

<p>The important point is that <em>it does not matter how the CRL or OCSP response were obtained</em>: they are signed object, verifying the signatures and all the name matching and extension contents is sufficient. The object themselves can travel over TCP connections, emails, USB keys, caravans of camels, learned by heart and declaimed by a Shakespearian actor, whatever. The signature abstracts these details away. Certificates, CRL, OCSP responses cannot be "manipulated" without invalidating the signature.</p>

<p>CRL and OCSP responses have <strong>validity dates</strong>. They both have a <code>thisUpdate</code> field which tells when they were issued (formally, the date at which the information they contain was gathered). They also have a <code>nextUpdate</code> field which is the date before which a newer version should be issued; thus, it serves as a kind of expiry date. It is expected that verifiers cache CRL and OCSP responses, using these dates to know whether the cached version is still usable, or a new one should be obtained.</p>

<p><strong>How to locate CRL and OCSP responses</strong></p>

<p>The way a CRL or OCSP response is not important for <em>security</em>, but, of course, a verifier cannot guess URL out of thin air. The URL at which CRL can be downloaded is encoded in the <code>CRL Distribution Points</code> extension of the certificate <em>T</em> (this extension has two roles: a validating role for delegation of CRL issuance power, and a descriptive role to give pointers to locations where the actual CRL could be downloaded). <code>http://</code> URL are common, but also <code>ldap://</code> URL (especially in closed environment like enterprise networks). An <code>https://</code> URL for CRL download can lead to a loop (since the download entails validating the certificate of another SSL server) hence it will tend not to be supported well, or at all (Windows will not follow such URL).</p>

<p>Similarly, the URL at which an OCSP responder can be found is in the <code>Authority Information Access</code> extension in certificate <em>T</em>.</p>

<p>These URL are indicative only; the verifier can use any CRL or OCSP response it could obtain, regardless of its provenance, provided that all the signatures are verified. Since CRL and OCSP responses have a non-negligible life time, it makes sense to cache and reuse them. <strong>OCSP stapling</strong> is a way for a SSL <em>server</em> to obtain OCSP responses for his own certificate, and provide them to the client, under the assumption that the client may need them. This makes the whole process more efficient: the client does not have to open extra connections to get the OCSP responses itself, and the same OCSP response can be sent by the server to all clients within a given time frame. One way to see it is that the SSL server acts as a Web proxy for the purpose of downloading OCSP responses.</p>

<p>OCSP stapling is entirely up to the SSL server; the contents of the certificates and OCSP responses is unaffected. The CA or the OCSP responder need not be aware that stapling occurs at all.</p>

<p>"Removing" the OCSP stapling flag from the handshake would break the <code>Finished</code> messages at the end of the handshake, so this is not feasible for the attacker, unless this would allow him to break the whole handshake before the end. <em>However</em>, it does not: the lack of OCSP stapling does not mean that the client will not ascertain revocation status; it just means that the client will be on his own, and will have to obtain the CRL or OCSP responses by itself.</p>

<p>The unfortunate thing about OCSP stapling is that it is not yet widely supported. The idea is sound, though. Its security implications is that, with stapling, a SSL server has a powerful argument to convince the Web browser to actually <em>do its job</em> and not skip revocation status checks altogether, like many Web browsers are unfortunately prone to do (things change in that matter, but slowly).</p>

<p><strong>Note:</strong> CRL / OCSP response lifetime usually ranges from a few minutes to a few days. The dates are verified with regards to the <em>client</em> notion of time; clients with out-of-date clocks can run into trouble.</p>
</div>
    <table class="fw">
    <tr>
    <td class="vt">











<div class="post-menu"><a href="/a/29694" title="short permalink to this answer" class="short-link" id="link-post-29694">share</a><span class="lsep">|</span><a href="/posts/29694/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    
<div class="user-info user-hover">
    <div class="user-action-time">
        
        
            answered <span title="2013-01-25 13:08:20Z" class="relativetime">Jan 25 at 13:08</span>
        

    </div>
    <div class="user-gravatar32">
        <a href="/users/655/thomas-pornin"><div><img src="https://www.gravatar.com/avatar/07ccc97c05f3fb80560ebc618a7de8bc?s=32&d=identicon&r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/655/thomas-pornin">Thomas Pornin</a><br>
        <span class="reputation-score" title="reputation score 106623" dir="ltr">107k</span><span title="19 gold badges"><span class="badge1"></span><span class="badgecount">19</span></span><span title="194 silver badges"><span class="badge2"></span><span class="badgecount">194</span></span><span title="377 bronze badges"><span class="badge3"></span><span class="badgecount">377</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-29694" class="comments" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">

    <tr id="comment-46113" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">First, great write up.  

One note, however. You say that OCSP stapling will &quot;... provide them to the client, under the assumption that the client may need them&quot;. I found the below text in the RFC, and it seems to me that it will only provide it to the client if the client asks in the ClientHello. I may be missing something, but I just wanted to bring it up. Thanks.  

From RFC 6066, page 14 &quot;Servers that receive a client hello containing the &quot;status_request&quot; extension MAY return a suitable certificate status response to the client along with their certificate. &quot;</span>
	&ndash;&nbsp;
		<a href="/users/16399/steel-city-hacker" 
		   title="1287 reputation" 
		   class="comment-user">Steel City Hacker</a>
	<span class="comment-date" dir="ltr"><span title="2013-01-25 18:25:32Z" class="relativetime-clean">Jan 25 at 18:25</span></span>
		<span class="edited-yes" title="this comment was edited 4 times"></span>
				</div>

        </td>
    </tr>
    <tr id="comment-46114" class="comment">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                                <span title="number of &#39;useful comment&#39; votes received" 
                                        class="cool">1</span>   
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">OCSP stapling is a TLS extension. TLS supports extensions, but the client must announce that it supports each of them; the server is not allowed to use extensions which the client did not specifically allowed. Here, the client states in the ClientHello that it &quot;supports&quot; the OCSP stapling extension, i.e. that it will not crash if the server staples OCSP responses. This does not mean that the client will <i>use</i> the responses or even needs them; the client itself cannot know at that point (it has not seen the server&#39;s certificate yet).</span>
	&ndash;&nbsp;
		<a href="/users/655/thomas-pornin" 
		   title="106623 reputation" 
		   class="comment-user">Thomas Pornin</a>
	<span class="comment-date" dir="ltr"><span title="2013-01-25 18:41:33Z" class="relativetime-clean">Jan 25 at 18:41</span></span>
				</div>

        </td>
    </tr>
    <tr id="comment-47870" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">I read this today and it reminded me of this.  For those who aren&#39;t familiar, the CA Security Council is a new conglomerate of CAs... Check it out.  <a href="https://casecurity.org/2013/02/14/certificate-revocation-and-ocsp-stapling/" rel="nofollow">casecurity.org/2013/02/14/&hellip;</a></span>
	&ndash;&nbsp;
		<a href="/users/16399/steel-city-hacker" 
		   title="1287 reputation" 
		   class="comment-user">Steel City Hacker</a>
	<span class="comment-date" dir="ltr"><span title="2013-02-14 22:01:25Z" class="relativetime-clean">Feb 14 at 22:01</span></span>
		<span class="edited-yes" title="this comment was edited 1 time"></span>
				</div>

        </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-29694" data-rep=50 data-anon=true
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”." 
				>add comment</a>
    </td>
</tr>
    </table>
</div>
									<a name='new-answer'></a>
						<form id="post-form" action="/questions/29686/answer/submit" method="post"  class="post-form">
							<input type="hidden" id="post-id" value="29686" />
							<h2 class="space">Your Answer</h2>



    

<script type="text/javascript">
    StackExchange.ready(function() {
        initTagRenderer("".split(" "), "".split(" "));
         
        prepareEditor({
            heartbeatType: 'answer',
            bindNavPrevention: true,
            postfix: "",
noCode: true,            onDemand: true,
            discardSelector: ".discard-answer"
            ,immediatelyShowMarkdownHelp:true
        });
        

    });  
</script>


<div id="post-editor" class="post-editor">

    <div style="position: relative;">     
        <div class="wmd-container">
            <div id="wmd-button-bar" class="wmd-button-bar"></div>
            <textarea id="wmd-input" class="wmd-input" name="post-text" cols="92" rows="15" tabindex="101" data-min-length=""></textarea>
        </div>
    </div>

    <div class="fl" style="margin-top: 8px; height:24px;">&nbsp;</div>
    <div id="draft-saved" class="draft-saved community-option fl" style="margin-top: 8px; height:24px; display:none;">draft saved</div>

    <div id="draft-discarded" class="draft-discarded community-option fl" style="margin-top: 8px; height:24px; display:none;">draft discarded</div>



    <div id="wmd-preview" class="wmd-preview"></div>
    <div></div>
    <div class="edit-block">
        <input id="fkey" name="fkey" type="hidden" value="f51c005c36aeb04be7163e16a81b52d5">
        <input id="author" name="author" type="text">
    </div>
</div>
							<div style="position: relative;">
								
            <div class="form-item dno new-post-login">
        
                <div class="new-login-form">
                    <div class="new-login-left">
                        <h3>Sign up or <a id="login-link" href="/users/login?returnurl=%2fquestions%2f29686%2fhow-does-ocsp-stapling-work%23new-answer">login</a></h3>
                        <script type="text/javascript">
                            StackExchange.ready(function () {
                                StackExchange.helpers.onClickDraftSave('#login-link');
                            });
                        </script>
                        <div class="preferred-login google-login">
                            <p><span class="icon"></span><span>Sign up using Google</span></p>
                        </div>
                        <div class="preferred-login facebook-login">
                            <p><span class="icon"></span><span>Sign up using Facebook</span></p>
                        </div>
                        <div class="preferred-login stackexchange-login">
                            <p><span class="icon"></span><span>Sign up using Stack Exchange</span></p>
                        </div>
                    </div>
                    <input type="hidden" name="manual-openid" class="manual-openid" />
                    <input type="hidden" name="use-facebook" class="use-facebook" value="false" />
                    <input type="button" class="submit-openid" value="Submit" style="display:none" />
                    <div class="new-login-right">
                                <h3>Post as a guest</h3>
    <div class="form-item">
        <table>
        <tr>
                    <script type="text/javascript">
                StackExchange.ready(function () {
                    StackExchange.helpers.bindHelpOverlayEvents($('.vm input'));
                });
            </script>
            <td class="vm">
                <div>
                    <label for="display-name">Name</label>
                    <input id="display-name" name="display-name" type="text" size="30" maxlength="30" value="" tabindex="105">
                </div>
                <div>
                    <label for="m-address">Email</label>
                    <input id="m-address" name="m-address" type="text" size="30" maxlength="100" value="" tabindex="106">
                    <span class="edit-field-overlay">required, but not shown</span>
                </div>
            </td>
        </tr>
        </table>
    </div>

                    </div>
                </div>
            </div>
            <script type="text/javascript">
                StackExchange.ready(
                    function () {
                        StackExchange.openid.initPostLogin('.new-post-login', '%2fquestions%2f29686%2fhow-does-ocsp-stapling-work%23new-answer');
                    }
                );
            </script>
            <noscript>
                        <h3>Post as a guest</h3>
    <div class="form-item">
        <table>
        <tr>
                    <script type="text/javascript">
                StackExchange.ready(function () {
                    StackExchange.helpers.bindHelpOverlayEvents($('.vm input'));
                });
            </script>
            <td class="vm">
                <div>
                    <label for="display-name">Name</label>
                    <input id="display-name" name="display-name" type="text" size="30" maxlength="30" value="" tabindex="105">
                </div>
                <div>
                    <label for="m-address">Email</label>
                    <input id="m-address" name="m-address" type="text" size="30" maxlength="100" value="" tabindex="106">
                    <span class="edit-field-overlay">required, but not shown</span>
                </div>
            </td>
        </tr>
        </table>
    </div>

            </noscript>
							</div>
           
															<div class="form-submit cbt">
									<input id="submit-button" type="submit" value="Post Your Answer" tabindex="110">
									<a href="#" class="discard-answer dno">discard</a>

<p class="privacy-policy-agreement">
By posting your answer, you agree to the <a href='http://stackexchange.com/legal/privacy-policy' target='_blank'>privacy policy</a> and <a href='http://stackexchange.com/legal/terms-of-service' target='_blank'>terms of service</a>.</p>
<input type="hidden" name="legalLinksShown" value="1" />								</div>
						</form>



						<h2 class="bottom-notice">
Not the answer you&#39;re looking for?							Browse other questions tagged <a href="/questions/tagged/ssl" class="post-tag" title="show questions tagged &#39;ssl&#39;" rel="tag">ssl</a> <a href="/questions/tagged/certificate-authority" class="post-tag" title="show questions tagged &#39;certificate-authority&#39;" rel="tag">certificate-authority</a> <a href="/questions/tagged/ocsp" class="post-tag" title="show questions tagged &#39;ocsp&#39;" rel="tag">ocsp</a>  or <a href="/questions/ask">ask your own question</a>.						</h2>
			</div>
		</div>
				<div id="sidebar" class="show-votes">
							<div class="module question-stats">
					<p class="label-key">tagged</p>
					<div class="tagged"><a href="/questions/tagged/ssl" class="post-tag" title="show questions tagged &#39;ssl&#39;" rel="tag">ssl</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">&times;</span>&nbsp;<span class="item-multiplier-count">926</span></span><br>
<a href="/questions/tagged/certificate-authority" class="post-tag" title="show questions tagged &#39;certificate-authority&#39;" rel="tag">certificate-authority</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">&times;</span>&nbsp;<span class="item-multiplier-count">176</span></span><br>
<a href="/questions/tagged/ocsp" class="post-tag" title="show questions tagged &#39;ocsp&#39;" rel="tag">ocsp</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">&times;</span>&nbsp;<span class="item-multiplier-count">4</span></span><br>
</div>
					<table id="qinfo">
						<tr>
							<td>
								<p class="label-key">asked</p>
							</td>
							<td style="padding-left: 10px">
								<p class="label-key" title="2013-01-25 09:05:06Z"><b>10 months ago</b></p>
							</td>
						</tr>
						<tr>
							<td>
								<p class="label-key">viewed</p>
							</td>

							<td style="padding-left: 10px">
								<p class="label-key">
									<b>1113 times</b>
								</p>
							</td>
						</tr>
							<tr>
								<td>
									<p class="label-key">active</p>
								</td>
								<td style="padding-left: 10px">
									<p class="label-key"><b><a href="?lastactivity" class="lastactivity-link" title="2013-01-25 18:25:14Z">10 months ago</a></b></p>
								</td>
							</tr>
					</table>
				</div>
						
			

<style type="text/css">
    .ads { margin-left: 60px; }
    .ad-container { width: 220px; height: 250px; margin-right: 20px; margin-bottom: 20px; }
    .ad-container .ad { height: 250px; }
    .ad-container .footer-container { overflow: hidden; height: 30px; position: relative; top: -30px; }
    .ad-container .footer-container .footer { font-family: Arial,Helvetic,Sans-Serif; font-size: 12px; text-align: center; padding-top: 9px; background-color: #000; color: #EFF; opacity: 0.9; filter: alpha(opacity=90); top: 30px; height: 30px; position: relative; }
    .ad-container a:hover { text-decoration: underline; }
    #adzerk2 { height: 250px; }
</style>
<script type="text/javascript">
    StackExchange.ready(function () {
        $(".ad-container").hover(
            function () {
                $(".ad-container .footer-container .footer").stop(true, true).animate({ top: "0px" }, "fast");
            },
            function () {
                $(".ad-container .footer-container .footer").animate({ top: "30px" }, "fast");
            });
    });
</script>
    <script type="text/javascript">
        var z = document.createElement("script"); z.type = "text/javascript"; z.async = true; z.src = 'http://engine.adzerk.net/z/12057/adzerk2_2_17_76?keywords=x-host-security.stackexchange.com'; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(z, s);
    </script>
    <div class="everyonelovesstackoverflow" id="adzerk2">
    </div>  

			  
    
            

				<div class="module sidebar-related">
					<h4 id="h-related">Related</h4>
					<div class="related" data-tracker="rq=1">
						<div class="spacer">
<a href="/q/90" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">25
    </div>
</a><a href="/questions/90/does-it-matter-which-certificate-authority-i-source-my-ssl-certificate-from" class="question-hyperlink">Does it matter which Certificate Authority I source my SSL Certificate from?</a>
</div>
<div class="spacer">
<a href="/q/1167" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">21
    </div>
</a><a href="/questions/1167/where-to-get-an-ssl-certificate-for-personal-website" class="question-hyperlink">Where to get an SSL certificate for personal website?</a>
</div>
<div class="spacer">
<a href="/q/6554" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">14
    </div>
</a><a href="/questions/6554/why-does-facebook-serve-several-ssl-certificates" class="question-hyperlink">Why does Facebook serve several SSL certificates?</a>
</div>
<div class="spacer">
<a href="/q/11566" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">5
    </div>
</a><a href="/questions/11566/how-does-dnssec-work-are-there-known-limitations-or-issues" class="question-hyperlink">How does DNSSec work?  Are there known limitations or issues?</a>
</div>
<div class="spacer">
<a href="/q/12810" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">2
    </div>
</a><a href="/questions/12810/how-does-bidirectional-authentication-using-ssl-work" class="question-hyperlink">How does bidirectional authentication using SSL work?</a>
</div>
<div class="spacer">
<a href="/q/15484" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">1
    </div>
</a><a href="/questions/15484/does-convergence-solve-the-problem-of-hacked-cas" class="question-hyperlink">Does Convergence solve the problem of hacked CAs?</a>
</div>
<div class="spacer">
<a href="/q/20803" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted large">216
    </div>
</a><a href="/questions/20803/how-does-ssl-work" class="question-hyperlink">How does SSL work?</a>
</div>
<div class="spacer">
<a href="/q/37570" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">2
    </div>
</a><a href="/questions/37570/how-does-perfect-forward-secrecy-work-in-https" class="question-hyperlink">How does Perfect forward secrecy work in https?</a>
</div>
<div class="spacer">
<a href="/q/41988" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">2
    </div>
</a><a href="/questions/41988/how-does-sslstrip-work" class="question-hyperlink">How does SSLstrip work?</a>
</div>
<div class="spacer">
<a href="/q/45979" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">-1
    </div>
</a><a href="/questions/45979/how-does-ssl-prevent-mitm-attacks" class="question-hyperlink">How does ssl prevent MITM attacks</a>
</div>

					</div>
				</div>
		</div>
	
<div id="feed-link">
    <div id="feed-link-text"><a href="/feeds/question/29686" title="feed of this question and its answers"><span class="feed-icon"></span>question feed</a></div>
</div>
	<script type="text/javascript">
StackExchange.ready(function(){$.get('/posts/29686/ivc/d3ae');});
</script>
<noscript>
    <div><img src="/posts/29686/ivc/d3ae" class="dno" alt="" width="0" height="0"></div>
</noscript></div>


        </div>
    </div>
    <div id="footer" class="categories">
        <div class="footerwrap">
            <div id="footer-menu">
                <div class="top-footer-links">
                        <a href="/about">about</a>
                    <a href="/help">help</a>
                        <a href="/help/badges">badges</a>
                    <a href="http://security.blogoverflow.com/?blb=1">blog</a>
                        <a href="http://chat.stackexchange.com">chat</a>
                    <a href="http://data.stackexchange.com">data</a>
                    <a href="http://stackexchange.com/legal">legal</a>
                    <a href="http://stackexchange.com/legal/privacy-policy">privacy policy</a>
                    <a href="http://stackexchange.com/about/hiring">jobs</a>
                    <a href="http://stackexchange.com/about/contact">advertising info</a>

                    <a onclick='StackExchange.switchMobile("on", "/questions/29686/how-does-ocsp-stapling-work")'>mobile</a>
                    <b><a href="/contact">contact us</a></b>
                        <b><a href="http://meta.security.stackexchange.com">feedback</a></b>
                    
                </div>
                <div id="footer-sites">
                    <table>
    <tr>
            <th colspan=3>
                Technology
            </th>
            <th >
                Life / Arts
            </th>
            <th >
                Culture / Recreation
            </th>
            <th >
                Science
            </th>
            <th >
                Other
            </th>
    </tr>
    <tr>
            <td>
                <ol>
                        <li><a href="http://stackoverflow.com" title="professional and enthusiast programmers">Stack Overflow</a></li>
                        <li><a href="http://serverfault.com" title="professional system and network administrators">Server Fault</a></li>
                        <li><a href="http://superuser.com" title="computer enthusiasts and power users">Super User</a></li>
                        <li><a href="http://webapps.stackexchange.com" title="power users of web applications">Web Applications</a></li>
                        <li><a href="http://askubuntu.com" title="Ubuntu users and developers">Ask Ubuntu</a></li>
                        <li><a href="http://webmasters.stackexchange.com" title="pro webmasters">Webmasters</a></li>
                        <li><a href="http://gamedev.stackexchange.com" title="professional and independent game developers">Game Development</a></li>
                        <li><a href="http://tex.stackexchange.com" title="users of TeX, LaTeX, ConTeXt, and related typesetting systems">TeX - LaTeX</a></li>
                            </ol></td><td><ol>
                        <li><a href="http://programmers.stackexchange.com" title="professional programmers interested in conceptual questions about software development">Programmers</a></li>
                        <li><a href="http://unix.stackexchange.com" title="users of Linux, FreeBSD and other Un*x-like operating systems.">Unix &amp; Linux</a></li>
                        <li><a href="http://apple.stackexchange.com" title="power users of Apple hardware and software">Ask Different (Apple)</a></li>
                        <li><a href="http://wordpress.stackexchange.com" title="WordPress developers and administrators">WordPress Answers</a></li>
                        <li><a href="http://gis.stackexchange.com" title="cartographers, geographers and GIS professionals">Geographic Information Systems</a></li>
                        <li><a href="http://electronics.stackexchange.com" title="electronics and electrical engineering professionals, students, and enthusiasts">Electrical Engineering</a></li>
                        <li><a href="http://android.stackexchange.com" title="enthusiasts and power users of the Android operating system">Android Enthusiasts</a></li>
                        <li><a href="http://security.stackexchange.com" title="Information security professionals">Information Security</a></li>
                            </ol></td><td><ol>
                        <li><a href="http://dba.stackexchange.com" title="database professionals who wish to improve their database skills and learn from others in the community">Database Administrators</a></li>
                        <li><a href="http://drupal.stackexchange.com" title="Drupal developers and administrators">Drupal Answers</a></li>
                        <li><a href="http://sharepoint.stackexchange.com" title="SharePoint enthusiasts">SharePoint</a></li>
                        <li><a href="http://ux.stackexchange.com" title="user experience researchers and experts">User Experience</a></li>
                        <li><a href="http://mathematica.stackexchange.com" title="users of Mathematica">Mathematica</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#technology" class="more">
                                more (14)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://photo.stackexchange.com" title="professional, enthusiast and amateur photographers">Photography</a></li>
                        <li><a href="http://scifi.stackexchange.com" title="science fiction and fantasy enthusiasts">Science Fiction &amp; Fantasy</a></li>
                        <li><a href="http://cooking.stackexchange.com" title="professional and amateur chefs">Seasoned Advice (cooking)</a></li>
                        <li><a href="http://diy.stackexchange.com" title="contractors and serious DIYers">Home Improvement</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#lifearts" class="more">
                                more (13)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://english.stackexchange.com" title="linguists, etymologists, and serious English language enthusiasts">English Language &amp; Usage</a></li>
                        <li><a href="http://skeptics.stackexchange.com" title="scientific skepticism">Skeptics</a></li>
                        <li><a href="http://judaism.stackexchange.com" title="those who base their lives on Jewish law and tradition and anyone interested in learning more">Mi Yodeya (Judaism)</a></li>
                        <li><a href="http://travel.stackexchange.com" title="road warriors and seasoned travelers">Travel</a></li>
                        <li><a href="http://christianity.stackexchange.com" title="committed Christians, experts in Christianity and those interested in learning more">Christianity</a></li>
                        <li><a href="http://gaming.stackexchange.com" title="passionate videogamers on all platforms">Arqade (gaming)</a></li>
                        <li><a href="http://bicycles.stackexchange.com" title="people who build and repair bicycles, people who train cycling, or commute on bicycles">Bicycles</a></li>
                        <li><a href="http://rpg.stackexchange.com" title="gamemasters and players of tabletop, paper-and-pencil role-playing games">Role-playing Games</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#culturerecreation" class="more">
                                more (21)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://math.stackexchange.com" title="people studying math at any level and professionals in related fields">Mathematics</a></li>
                        <li><a href="http://stats.stackexchange.com" title="statisticians, data analysts, data miners and data visualization experts">Cross Validated (stats)</a></li>
                        <li><a href="http://cstheory.stackexchange.com" title="theoretical computer scientists and researchers in related fields">Theoretical Computer Science</a></li>
                        <li><a href="http://physics.stackexchange.com" title="active researchers, academics and students of physics">Physics</a></li>
                        <li><a href="http://mathoverflow.net" title="professional mathematicians">MathOverflow</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#science" class="more">
                                more (7)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://stackapps.com" title="apps, scripts, and development with the Stack Exchange API">Stack Apps</a></li>
                        <li><a href="http://meta.stackoverflow.com" title="meta-discussion of the Stack Exchange family of Q&amp;A websites">Meta Stack Overflow</a></li>
                        <li><a href="http://area51.stackexchange.com" title="proposing new sites in the Stack Exchange network">Area 51</a></li>
                        <li><a href="http://careers.stackoverflow.com">Stack Overflow Careers</a></li>
                    
                </ol>
            </td>
    </tr>
</table>
                </div>
            </div>

            <div id="copyright">
                site design / logo &#169; 2013 stack exchange inc; user contributions licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license">cc-wiki</a> 
 with <a href="http://blog.stackoverflow.com/2009/06/attribution-required/" rel="license">attribution required</a>
            </div>
            <div id="footer-flair">
                <a href="http://creativecommons.org/licenses/by-sa/3.0/" class="cc-wiki-link"></a>
            </div>
            <div id="svnrev">
                rev 2013.11.25.1177
            </div>
            
        </div>
    </div>
    <noscript>
        <div id="noscript-warning">Information Security Stack Exchange works best with JavaScript enabled<img src="http://pixel.quantserve.com/pixel/p-c1rF4kxgLUzNc.gif" alt="" class="dno"></div>
    </noscript>

    <script type="text/javascript">var _gaq=_gaq||[];_gaq.push(['_setAccount','UA-5620270-24']);
        _gaq.push(['_setDomainName','.stackexchange.com']);
        _gaq.push(['_setCustomVar', 1, 'tags', '|ssl|certificate-authority|ocsp||']); 
_gaq.push(['_trackPageview']);
    var _qevents = _qevents || [];
    var _comscore = _comscore || [];
    (function () {
        var ssl='https:'==document.location.protocol,
            s=document.getElementsByTagName('script')[0],
            ga=document.createElement('script');
        ga.type='text/javascript';
        ga.async=true;
        ga.src=(ssl?'https://ssl':'http://www')+'.google-analytics.com/ga.js';
        s.parentNode.insertBefore(ga,s);
        var sc=document.createElement('script');
        sc.type='text/javascript';
        sc.async=true;
        sc.src=(ssl?'https://secure':'http://edge')+'.quantserve.com/quant.js';
        s.parentNode.insertBefore(sc, s);
        
        var s = document.createElement("script"), el = document.getElementsByTagName("script")[0]; s.async = true;
        s.src = (document.location.protocol == "https:" ? "https://sb" : "http://b") + ".scorecardresearch.com/beacon.js";
        el.parentNode.insertBefore(s, el);
        
    })();
    _comscore.push({ c1: "2", c2: "17440561" });
    _qevents.push({ qacct: "p-c1rF4kxgLUzNc" });
    </script>            
</body>
</html>