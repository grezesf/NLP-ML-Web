<!DOCTYPE html>
<html>
<head>
    
    <title>Reduce Clustered Index seek cost SQL Server 2008 R2 - Database Administrators Stack Exchange</title>
    <link rel="shortcut icon" href="//cdn.sstatic.net/dba/img/favicon.ico">
    <link rel="apple-touch-icon image_src" href="//cdn.sstatic.net/dba/img/apple-touch-icon.png">
    <link rel="search" type="application/opensearchdescription+xml" title="Database Administrators Stack Exchange" href="/opensearch.xml">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@StackDBAs" />
    <meta name="twitter:domain" content="dba.stackexchange.com"/>
    <meta name="og:type" content="website" />
    <meta name="og:image" content="http://cdn.sstatic.net/dba/img/apple-touch-icon@2.png?v=246e2cb2439c"/>
    <meta name="og:title" content="Reduce Clustered Index seek cost SQL Server 2008 R2" />
    <meta name="og:description" content="I am running a query and it have records in lakhs, it takes more than 20 mins to fetch data. After running the execution plan i noticed that clustered index seek cost can be be the reason. How can I " />
    <meta name="og:url" content="http://dba.stackexchange.com/questions/43553/reduce-clustered-index-seek-cost-sql-server-2008-r2"/>
    <link rel="canonical" href="http://dba.stackexchange.com/questions/43553/reduce-clustered-index-seek-cost-sql-server-2008-r2" />

    
    
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="//cdn.sstatic.net/Js/stub.en.js?v=e3d47b73fa12" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="//cdn.sstatic.net/dba/all.css?v=9de8a29ebe20">
    
    <link rel="alternate" type="application/atom+xml" title="Feed for question &#39;Reduce Clustered Index seek cost SQL Server 2008 R2&#39;" href="/feeds/question/43553">
    <script type="text/javascript">
        
        StackExchange.ready(function () {
            StackExchange.using("postValidation", function () {
                StackExchange.postValidation.initOnBlurAndSubmit($('#post-form'), 2, 'answer');
            });

            
            StackExchange.question.init({showAnswerHelp:true,totalCommentCount:32,shownCommentCount:5,highlightColor:'#F4A83D',backgroundColor:'#FFF',questionId:43553});

            styleCode();

                StackExchange.realtime.subscribeToQuestion('182', '43553');
            
                    });
    </script>


    <script type="text/javascript">
        StackExchange.ready(function () {
            StackExchange.realtime.init('wss://qa.sockets.stackexchange.com,ws://qa.sockets.stackexchange.com');
            StackExchange.realtime.subscribeToInboxNotifications();
                    StackExchange.realtime.subscribeToReputationNotifications('182');
                        });
    </script>
    <script type="text/javascript">
        StackExchange.init({"locale":"en","stackAuthUrl":"https://stackauth.com","serverTime":1385132396,"styleCode":true,"enableUserHovercards":true,"site":{"name":"Database Administrators Stack Exchange","description":"Q&A for database professionals who wish to improve their database skills and learn from others in the community","isNoticesTabEnabled":true,"recaptchaPublicKey":"6LdsB7sSAAAAAAzjgEF_Hd8vXv-C42sa_KyofaGR","enableSocialMediaInSharePopup":true},"user":{"fkey":"f51c005c36aeb04be7163e16a81b52d5","isAnonymous":true}});
        StackExchange.using.setCacheBreakers({"js/prettify-full.en.js":"e0bbd4760e83","js/moderator.en.js":"1a411fd265fe","js/full-anon.en.js":"2435f0d168c4","js/full.en.js":"e4b72ebdc18f","js/wmd.en.js":"bd9234d44a40","js/third-party/jquery.autocomplete.min.js":"e5f01e97f7c3","js/third-party/jquery.autocomplete.min.en.js":"","js/mobile.en.js":"d1d834ef85d2","js/help.en.js":"d3cc74d8a93a","js/tageditor.en.js":"6d51a5f8d7f3","js/tageditornew.en.js":"111b781cf314","js/inline-tag-editing.en.js":"f951bd09dc69","js/revisions.en.js":"33fd38144303","js/review.en.js":"f45b4ec094ea","js/tagsuggestions.en.js":"e4e7b952fcc7","js/post-validation.en.js":"c275fe37d674","js/explore-qlist.en.js":"73825bd006fc","js/events.en.js":"53bc48767091"});
        StackExchange.using("gps", function() {
             StackExchange.gps.init(true);
        });
        
    </script>
    
        <script type="text/javascript">
            StackExchange.ready(function () {
                $('#nav-tour').click(function () {
                    StackExchange.using("gps", function() {
                        StackExchange.gps.track("aboutpage.click", { aboutclick_location: "headermain" }, true);
                    });
                });
            });
        </script>
</head>
<body class="question-page">
    <noscript><div id="noscript-padding"></div></noscript>
    <div id="notify-container"></div>
    <div id="overlay-header"></div>
    <div id="custom-header"></div>
    <div class="container">
        <div id="header" class=headeranon>
            <div id="portalLink">
                <a class="genu" href="http://stackexchange.com" onclick="StackExchange.ready(function(){genuwine.click();});return false;">Stack Exchange</a>
            </div>
            <div id="topbar">
                <div id="hlinks">
                    
<span id="hlinks-user"></span>
<span id="hlinks-nav">                        <a href="/users/login?returnurl=%2fquestions%2f43553%2freduce-clustered-index-seek-cost-sql-server-2008-r2">sign up</a>

 <span class="lsep">|</span>
                    <a href="/users/login?returnurl=%2fquestions%2f43553%2freduce-clustered-index-seek-cost-sql-server-2008-r2">log in</a>

 <span class="lsep">|</span>
</span>
<span id="hlinks-custom"></span>
                </div>
                <div id="hsearch">
                    <form id="search" action="/search" method="get" autocomplete="off">
                        <div>
                            <input autocomplete="off" name="q" class="textbox" placeholder="search" tabindex="1" type="text" maxlength="240" size="28" value="">
                        </div>
                    </form>
                </div>
            </div>
            <br class="cbt">
            <div id="hlogo">
                <a href="/">
                    Database Administrators
                </a>
            </div>
            <div id="hmenus">
                <div class="nav mainnavs mainnavsanon">
                    <ul>
                            <li class="youarehere"><a id="nav-questions" href="/questions">Questions</a></li>
                            <li><a id="nav-tags" href="/tags">Tags</a></li>
                            <li><a id="nav-tour" href="/about">Tour</a></li>
                            <li><a id="nav-users" href="/users">Users</a></li>
                    </ul>
                </div>
                <div class="nav askquestion">
                    <ul>
                        <li>
                            <a id="nav-askquestion"  href="/questions/ask">Ask Question</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        



        <div id="content">
            

<div itemscope itemtype="http://schema.org/Article">
	<link itemprop="image" href="//cdn.sstatic.net/dba/img/apple-touch-icon.png">
			<!--googleoff: all-->
<div id="herobox-mini">
    <div id="hero-content">
        <span id="controls">
            <a href="/about" id="tell-me-more" class="button">Tell me more</a>
            <span id="close"><a title="click to dismiss">&times;</a></span>
        </span>
        <div id="blurb">
            Database Administrators Stack Exchange is a question and answer site for database professionals who wish to improve their database skills and learn from others in the community. It&#39;s 100% free, no registration required.
        </div>        
    </div>
    <script>
        $('#tell-me-more').click(function () {
            var clickSource = $("body").attr("class") + '-mini';
            if ($("body").hasClass("questions-page")) {
                clickSource = 'questionpagemini';
            }
            if ($("body").hasClass("home-page")) {
                clickSource = 'homepagemini';
            }

            StackExchange.using("gps", function () {
                StackExchange.gps.track("aboutpage.click", { aboutclick_location: clickSource } , true);
            });
        });
        $('#herobox-mini #close').click(function () {
            StackExchange.using("gps", function () {
                StackExchange.gps.track("hero.action", { hero_action_type: "close" }, true);
            });
            $.cookie("hero", "none", { path: "/" });
            var $hero = $("#herobox-mini");
            $hero.slideUp('fast', function () { $hero.remove(); });
            return false;
        });
    </script>
</div>
			<!--googleon: all-->
			<div id="question-header">
			<h1 itemprop="name"><a href="/questions/43553/reduce-clustered-index-seek-cost-sql-server-2008-r2" class="question-hyperlink">Reduce Clustered Index seek cost SQL Server 2008 R2</a></h1>
		</div>
			<div id="mainbar">

			

<div class="question" data-questionid="43553"  id="question">
    
        <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="43553">
    <a class="vote-up-off" title="This question shows research effort; it is useful and clear">up vote</a>
    <span class="vote-count-post ">3</span>
    <a class="vote-down-off" title="This question does not show any research effort; it is unclear or not useful">down vote</a>
    
    <a class="star-off" href="#" title="This is a favorite question (click again to undo)">favorite</a>
    <div class="favoritecount"><b></b></div>   

</div>

            </td>
            
<td class="postcell">
<div>
    <div class="post-text" itemprop="description">

        <p>I am running a query and it have records in lakhs, it takes more than 20 mins to fetch data. After running the execution plan i noticed that clustered index seek cost can be be the reason. How can I reduce the clustered index seek cost of below mentioned query?</p>

<p>Foreign keys costs around 13% to 23%.</p>

<pre><code>CREATE PROC [dbo].[Test] (@UserTypeID  INT,
                          @UserID      INT,
                          @CityID      INT,
                          @OperatorID  INT,
                          @ParameterID INT)
AS
  BEGIN
      DECLARE @temp TABLE (
        range  DECIMAL(18, 2),
        range2 DECIMAL(18, 2),
        image  VARCHAR(50),
        symbol VARCHAR(20))

      IF( @UserID &gt; 0 )
        BEGIN
            --print 'hii'    
            INSERT INTO @temp
                        (range,
                         range2,
                         image,
                         symbol)
            SELECT tbl_Legend_ViewNetwork_Dtls.range,
                   tbl_Legend_ViewNetwork_Dtls.range2,
                   tbl_Legend_ViewNetwork_Dtls.image,
                   tbl_Legend_ViewNetwork_Dtls.symbol
            FROM   tbl_Legend_ViewNetwork_Dtls
                   INNER JOIN tbl_Legend_ViewNetwork
                     ON tbl_Legend_ViewNetwork_Dtls.tbl_legend_view_network_id = tbl_Legend_ViewNetwork.id
            WHERE  tbl_Legend_ViewNetwork.parameter_id = @ParameterID
                   AND tbl_Legend_ViewNetwork.user_type_id = @UserTypeID
                   AND tbl_Legend_ViewNetwork.is_default = 1
                   AND tbl_Legend_ViewNetwork.user_id = @UserID

            UPDATE @temp
            SET    range = range2,
                   range2 = range
            WHERE  symbol = '&lt;'
        END
      ELSE
        BEGIN
            INSERT INTO @temp
                        (range,
                         range2,
                         image,
                         symbol)
            SELECT tbl_Legend_ViewNetwork_Dtls.range,
                   tbl_Legend_ViewNetwork_Dtls.range2,
                   tbl_Legend_ViewNetwork_Dtls.image,
                   tbl_Legend_ViewNetwork_Dtls.symbol
            FROM   tbl_Legend_ViewNetwork_Dtls
                   INNER JOIN tbl_Legend_ViewNetwork
                     ON tbl_Legend_ViewNetwork_Dtls.tbl_legend_view_network_id = tbl_Legend_ViewNetwork.id
            WHERE  tbl_Legend_ViewNetwork.parameter_id = @ParameterID
                   AND tbl_Legend_ViewNetwork.user_type_id = @UserTypeID
                   AND tbl_Legend_ViewNetwork.is_default = 1

            UPDATE @temp
            SET    range = range2,
                   range2 = range
            WHERE  symbol = '&lt;'
        END

      --select * from @temp          
      SELECT '[' + STUFF((SELECT ',{"latitude":"' + a.lat + '","longitude":"' + a.long + '","value":"' + CONVERT(VARCHAR(20), a.value) + '","image":"' + temp.image + '"}'
                          FROM   (SELECT tbl_Survey_Details.lat,
                                         tbl_Survey_Details.long,
                                         tbl_Survey_Details.value
                                  FROM   tbl_Survey_Details
                                         INNER JOIN tbl_Survey
                                           ON tbl_Survey_Details.tbl_survey_id = tbl_Survey.id
                                         INNER JOIN tbl_Location
                                           ON tbl_Survey.tbl_location_id = tbl_Location.id
                                         INNER JOIN tbl_Area
                                           ON tbl_Location.tbl_area_id = tbl_Area.id
                                         INNER JOIN tbl_City
                                           ON tbl_Area.tbl_city_id = tbl_City.id
                                  WHERE  tbl_Survey_Details.tbl_parameter_id = @ParameterID
                                         AND tbl_Survey.tbl_mobile_operator_id = @OperatorID
                                         AND tbl_Area.tbl_city_id = @CityID) AS a
                                 INNER JOIN @temp temp
                                   ON a.value BETWEEN temp.range AND temp.range2
                          FOR XML Path ('')), 1, 1, '') + ']' AS data
  END 
</code></pre>

<p><img src="http://i.stack.imgur.com/b8ePb.jpg" alt="Execution plan screenshot"></p>

<p>Revised Query:</p>

<pre><code>CREATE PROC [dbo].[Test] (@UserTypeID  INT,
                          @UserID      INT,
                          @CityID      INT,
                          @OperatorID  INT,
                          @ParameterID INT)
AS
  BEGIN
      DECLARE @temp TABLE (
        range  DECIMAL(18, 2),
        range2 DECIMAL(18, 2),
        image  VARCHAR(50),
        symbol VARCHAR(20))

      IF( @UserID &gt; 0 )
        BEGIN
            --print 'hii'    
            INSERT INTO @temp
                        (range,
                         range2,
                         image,
                         symbol)
            SELECT tbl_Legend_ViewNetwork_Dtls.range,
                   tbl_Legend_ViewNetwork_Dtls.range2,
                   tbl_Legend_ViewNetwork_Dtls.image,
                   tbl_Legend_ViewNetwork_Dtls.symbol
            FROM   tbl_Legend_ViewNetwork_Dtls
                   INNER JOIN tbl_Legend_ViewNetwork
                     ON tbl_Legend_ViewNetwork_Dtls.tbl_legend_view_network_id = tbl_Legend_ViewNetwork.id
            WHERE  tbl_Legend_ViewNetwork.parameter_id = @ParameterID
                   AND tbl_Legend_ViewNetwork.user_type_id = @UserTypeID
                   AND tbl_Legend_ViewNetwork.is_default = 1
                   AND tbl_Legend_ViewNetwork.user_id = @UserID

            UPDATE @temp
            SET    range = range2,
                   range2 = range
            WHERE  symbol = '&lt;'
        END
      ELSE
        BEGIN
            INSERT INTO @temp
                        (range,
                         range2,
                         image,
                         symbol)
            SELECT tbl_Legend_ViewNetwork_Dtls.range,
                   tbl_Legend_ViewNetwork_Dtls.range2,
                   tbl_Legend_ViewNetwork_Dtls.image,
                   tbl_Legend_ViewNetwork_Dtls.symbol
            FROM   tbl_Legend_ViewNetwork_Dtls
                   INNER JOIN tbl_Legend_ViewNetwork
                     ON tbl_Legend_ViewNetwork_Dtls.tbl_legend_view_network_id = tbl_Legend_ViewNetwork.id
            WHERE  tbl_Legend_ViewNetwork.parameter_id = @ParameterID
                   AND tbl_Legend_ViewNetwork.user_type_id = @UserTypeID
                   AND tbl_Legend_ViewNetwork.is_default = 1

            UPDATE @temp
            SET    range = range2,
                   range2 = range
            WHERE  symbol = '&lt;'
        END

   SELECT   a.lat, a.long,a.value, temp.image
                          FROM   (SELECT tbl_Survey_Details.lat,
                                         tbl_Survey_Details.long,
                                         tbl_Survey_Details.value
                                  FROM   tbl_Survey_Details
                                         INNER JOIN tbl_Survey
                                           ON tbl_Survey_Details.tbl_survey_id = tbl_Survey.id
                                         INNER JOIN tbl_Location
                                           ON tbl_Survey.tbl_location_id = tbl_Location.id
                                         INNER JOIN tbl_Area
                                           ON tbl_Location.tbl_area_id = tbl_Area.id
                                         INNER JOIN tbl_City
                                           ON tbl_Area.tbl_city_id = tbl_City.id
                                  WHERE  tbl_Survey_Details.tbl_parameter_id = @ParameterID
                                         AND tbl_Survey.tbl_mobile_operator_id = @OperatorID
                                         AND tbl_Area.tbl_city_id = @CityID) AS a
                                 INNER JOIN @temp temp
                                   ON a.value BETWEEN temp.range AND temp.range2

  END 
</code></pre>

<p>Revised Execution Plan:
<img src="http://i.stack.imgur.com/vpfb3.jpg" alt="Revised Execution Plan"></p>

<p>Link to XML Execution plan file : <a href="https://hotfile.com/dl/225503951/44f35b7/sql.sqlplan.html" rel="nofollow">click here</a></p>

    </div>
    <div class="post-taglist">
        <a href="/questions/tagged/sql" class="post-tag" title="show questions tagged &#39;sql&#39;" rel="tag">sql</a> <a href="/questions/tagged/sql-server" class="post-tag" title="show questions tagged &#39;sql-server&#39;" rel="tag">sql-server</a> <a href="/questions/tagged/sql-server-2008" class="post-tag" title="show questions tagged &#39;sql-server-2008&#39;" rel="tag">sql-server-2008</a> 
    </div>
    <table class="fw">
    <tr>
    <td class="vt">











<div class="post-menu"><a href="/q/43553" title="short permalink to this question" class="short-link" id="link-post-43553">share</a><span class="lsep">|</span><a href="/posts/43553/edit" class="suggest-edit-post" title="">improve this question</a></div>        
    </td>
    <td align="right" class="post-signature">

<div class="user-info ">
    <div class="user-action-time">
        
        
        <a href="/posts/43553/revisions" title="show all edits to this post">edited <span title="2013-06-03 10:51:30Z" class="relativetime">Jun 3 at 10:51</span></a>
        

    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        <br>
        
    </div>
</div>    </td>
    <td class="post-signature owner">
        
<div class="user-info ">
    <div class="user-action-time">
        
        
            asked <span title="2013-05-31 12:49:29Z" class="relativetime">May 31 at 12:49</span>
        

    </div>
    <div class="user-gravatar32">
        <a href="/users/24452/deepak-d"><div><img src="https://www.gravatar.com/avatar/bdb202f036a342681974898a2d4f2ffc?s=32&d=identicon&r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/24452/deepak-d">Deepak D</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">19</span><span title="3 bronze badges"><span class="badge3"></span><span class="badgecount">3</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</div>
</td>
        </tr>
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-43553" class="comments" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="27" 
			           data-addlink-html="" 
			           data-addlink-disabled="true">

    <tr id="comment-76755" class="comment">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                                <span title="number of &#39;useful comment&#39; votes received" 
                                        class="cool">3</span>   
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">Please post your execution plan.</span>
	&ndash;&nbsp;
		<a href="/users/1945/jnk" 
		   title="9564 reputation" 
		   class="comment-user">JNK<span class="mod-flair" title="moderator">&#9830;</span></a>
	<span class="comment-date" dir="ltr"><span title="2013-05-31 12:52:18Z" class="relativetime-clean">May 31 at 12:52</span></span>
				</div>

        </td>
    </tr>
    <tr id="comment-76757" class="comment">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                                <span title="number of &#39;useful comment&#39; votes received" 
                                        class="cool">4</span>   
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">The best would be downloading SQL Sentry Plan explorer (free) and using the upload feature.  It can obfuscate your object names so it&#39;s private but still post a quality execution plan on the web for us to check out.</span>
	&ndash;&nbsp;
		<a href="/users/1945/jnk" 
		   title="9564 reputation" 
		   class="comment-user">JNK<span class="mod-flair" title="moderator">&#9830;</span></a>
	<span class="comment-date" dir="ltr"><span title="2013-05-31 13:01:34Z" class="relativetime-clean">May 31 at 13:01</span></span>
				</div>

        </td>
    </tr>
    <tr id="comment-76761" class="comment">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                                <span title="number of &#39;useful comment&#39; votes received" 
                                        class="cool">3</span>   
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">I suspect the actual cost/time is mostly in the XML, which is not normally expanded in the execution plan (because it&#39;s a function call).  You&#39;re joining on an XML value function output, which is not sargable unless you have XML indexes in place.</span>
	&ndash;&nbsp;
		<a href="/users/1945/jnk" 
		   title="9564 reputation" 
		   class="comment-user">JNK<span class="mod-flair" title="moderator">&#9830;</span></a>
	<span class="comment-date" dir="ltr"><span title="2013-05-31 13:21:13Z" class="relativetime-clean">May 31 at 13:21</span></span>
				</div>

        </td>
    </tr>
    <tr id="comment-76762" class="comment">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                                <span title="number of &#39;useful comment&#39; votes received" 
                                        class="cool">2</span>   
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">That XML UDX bit at the end of the execution plan is probably the worst thing in the query, but the optimizer can&#39;t calculate the cost so it shows it at 0%</span>
	&ndash;&nbsp;
		<a href="/users/1945/jnk" 
		   title="9564 reputation" 
		   class="comment-user">JNK<span class="mod-flair" title="moderator">&#9830;</span></a>
	<span class="comment-date" dir="ltr"><span title="2013-05-31 13:22:26Z" class="relativetime-clean">May 31 at 13:22</span></span>
				</div>

        </td>
    </tr>
    <tr id="comment-76765" class="comment">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                                <span title="number of &#39;useful comment&#39; votes received" 
                                        class="cool">3</span>   
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">Well you are creating XML and then querying it - can you not just query the tables directly?</span>
	&ndash;&nbsp;
		<a href="/users/1945/jnk" 
		   title="9564 reputation" 
		   class="comment-user">JNK<span class="mod-flair" title="moderator">&#9830;</span></a>
	<span class="comment-date" dir="ltr"><span title="2013-05-31 13:34:22Z" class="relativetime-clean">May 31 at 13:34</span></span>
				</div>

        </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-43553" 
			   class="comments-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid answering questions in comments.">show <b>27</b> more comments</a>
    </td>
</tr>            </table>    
</div>
    <div class="question-status">
        <h2>                <b>migrated</b> from <a href="http://stackoverflow.com/questions/16857671/reduce-clustered-index-seek-cost-sql-server-2008-r2?noredirect=1" title="reduce clustered index seek cost sql server 2008 r2">stackoverflow.com</a> <span title="2013-05-31 13:54:08Z" class="relativetime">May 31 at 13:54</span>
</h2>
        <p>This question came from our site for professional and enthusiast programmers.</p>
    </div>


			<div id="answers">

				<a name="tab-top"></a>
				<div id="answers-header">
					<div class="subheader answers-subheader">
						<h2>
								2 Answers
						</h2>
						<div>
							<div id="tabs">
        <a href="/questions/43553/reduce-clustered-index-seek-cost-sql-server-2008-r2?answertab=active#tab-top" title="Answers with the latest activity first">active</a>
        <a href="/questions/43553/reduce-clustered-index-seek-cost-sql-server-2008-r2?answertab=oldest#tab-top" title="Answers in the order they were provided">oldest</a>
        <a class="youarehere" href="/questions/43553/reduce-clustered-index-seek-cost-sql-server-2008-r2?answertab=votes#tab-top" title="Answers with the highest score first">votes</a>
</div>
						</div>
					</div>    
				</div>    




  
<a name="43866"></a>
<div id="answer-43866" class="answer" data-answerid="43866" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="43866">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">3</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>



<td class="answercell">
    <div class="post-text"><p>Since it takes about the same amount of time to fetch 300,000 rows using a very simple query, I'd suggest you stop looking at query tuning temporarily and decide whether this scenario you're currently testing is realistic.</p>

<ul>
<li><p>You are running Management Studio on your local workstation, connected to a SQL Server instance on a godaddy server. Therefore on top of the query cost within SQL Server you are also constrained by:</p>

<ul>
<li>godaddy's bandwidth (shared with other people on those servers)</li>
<li>your bandwidth (potentially shared with other people in your neighborhood)</li>
<li>the time it takes Management Studio to gather the results and render them</li>
</ul></li>
<li><p>You are retrieving 300,000 rows in your result. Usually this is not something you do - what user is going to consume 300,000 rows? Consider aggregating or only return a subset on each pull, and thinking about what purpose this query actually serves.</p></li>
</ul>

<p>Since it is unlikely that this is how your database will be expected to produce results in reality, I suggest you change your testing methodology somewhat. Either have Management Studio installed on some server <em>within</em> godaddy's infrastructure, taking bandwidth and general Internet volatility out of the equation, or test your query logic using your local copy of Management Studio, but don't use that for timing the results. Rather, use an app within godaddy's infrastructure to test the timing (after all, this is how your application will eventually work, right?).</p>

<p>If the query is also slow when you've taken bandwidth/Internet out of the picture, then you can start to consider whether the I/O you're getting from godaddy's server is sufficient (or whether you really need to pull 300,000 rows at any one time anyway, so maybe the point is moot).</p>
</div>
    <table class="fw">
    <tr>
    <td class="vt">











<div class="post-menu"><a href="/a/43866" title="short permalink to this answer" class="short-link" id="link-post-43866">share</a><span class="lsep">|</span><a href="/posts/43866/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    
<div class="user-info user-hover">
    <div class="user-action-time">
        
        
            answered <span title="2013-06-05 12:06:17Z" class="relativetime">Jun 5 at 12:06</span>
        

    </div>
    <div class="user-gravatar32">
        <a href="/users/1186/aaron-bertrand"><div><img src="https://www.gravatar.com/avatar/3881a283f3dff68791acf089f6a69f4f?s=32&d=identicon&r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/1186/aaron-bertrand">Aaron Bertrand</a><span class="mod-flair" title="moderator">&#9830;</span><br>
        <span class="reputation-score" title="reputation score 45708" dir="ltr">45.7k</span><span title="5 gold badges"><span class="badge1"></span><span class="badgecount">5</span></span><span title="56 silver badges"><span class="badge2"></span><span class="badgecount">56</span></span><span title="119 bronze badges"><span class="badge3"></span><span class="badgecount">119</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-43866" class="comments dno" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="" 
			           data-addlink-disabled="true">
					    <tr><td></td><td></td></tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-43866" 
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."></a>
    </td>
</tr>
    </table>
</div>

  
<a name="43621"></a>
<div id="answer-43621" class="answer" data-answerid="43621" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="43621">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">2</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>



<td class="answercell">
    <div class="post-text"><p>These steps should help:</p>

<ol>
<li><p>Add <code>OPTION RECOMPILE</code> to both queries with parameters. It will recompile execution plan for actual parameters' values.</p></li>
<li><p>You have index on <code>tbl_Legend_ViewNetwork (parameter_id, user_type_id, is_default,user_id)</code> with user_id being the last column. Don't you? </p></li>
<li><p>Create a summary table or materialized view to substitute 3 sequential joins from the 2nd query.</p></li>
<li><p>Change update statement for a case statement in the query.</p></li>
<li><p>Use CTE instead of @Temp, as you do not need to update anything</p></li>
<li><p>Get rid of <code>IF</code> by using `user_id=@UserID OR @UserID is null)</p></li>
<li><p>When you do multiple JOINs you need to filtering as soon as possible. Thus you should do <code>Select * from tbl_City JOIN ... Where City_id = @CityID</code>. So you first select 1 city and then join, rather than selecting nay rows, joining to all cities and then filtering.</p></li>
<li><p>You do not need to JOIN tbl_City in the last query, because you are not using contents on this table anywhere (you use: <code>tbl_Area.tbl_city_id = @CityID</code>).
Here is what I get:</p>

<pre><code>CREATE PROC [dbo].[Test] (@UserTypeID  INT,
                      @UserID      INT,
                      @CityID      INT,
                      @OperatorID  INT,
                      @ParameterID INT)
AS BEGIN

with cte1 as (
        SELECT 

            case  tbl_Legend_ViewNetwork_Dtls.symbol
            when '&lt;' then tbl_Legend_ViewNetwork_Dtls.range2
            else tbl_Legend_ViewNetwork_Dtls.range
        end 
        as range,

        case  tbl_Legend_ViewNetwork_Dtls.symbol
            when '&lt;' then tbl_Legend_ViewNetwork_Dtls.range
            else tbl_Legend_ViewNetwork_Dtls.range2
        end 
        as range2,
       tbl_Legend_ViewNetwork_Dtls.image
        FROM   tbl_Legend_ViewNetwork_Dtls
               INNER JOIN tbl_Legend_ViewNetwork
                 ON tbl_Legend_ViewNetwork_Dtls.tbl_legend_view_network_id = tbl_Legend_ViewNetwork.id
        WHERE  tbl_Legend_ViewNetwork.parameter_id = @ParameterID
               AND tbl_Legend_ViewNetwork.user_type_id = @UserTypeID
               AND tbl_Legend_ViewNetwork.is_default = 1
               AND (tbl_Legend_ViewNetwork.user_id = @UserID OR @UserID is NULL)


),

cte2 as (

    SELECT  
        tbl_Survey_Details.lat,
                    tbl_Survey_Details.long,
                    tbl_Survey_Details.value

    FROM    tbl_City

    INNER JOIN tbl_Area
        ON tbl_Area_tbl_city_id = tbl_City.id AND tbl_city_id = @CityID

    INNER JOIN tbl_Location
        ON tbl_Location.tbl_area_id = tbl_Area.id

    INNER JOIN tbl_Survey
        ON tbl_Survey.tbl_location_id = tbl_Location.id

    INNER JOIN tbl_Survey_Details
        ON tbl_Survey_Details.tbl_survey_id = tbl_Survey.id

    WHERE   tbl_Survey_Details.tbl_parameter_id = @ParameterID
                    AND 
        tbl_Survey.tbl_mobile_operator_id = @OperatorID
)


SELECT  a.lat, a.long,a.value, cte1.image
            FROM cte2

            INNER JOIN cte1
                   ON cte2.value BETWEEN cte1.range AND cte1.range2
OPTION (RECOMPILE)
END
</code></pre></li>
</ol>

<p>P.S. Marian, thank you for your help with formatting!</p>
</div>
    <table class="fw">
    <tr>
    <td class="vt">











<div class="post-menu"><a href="/a/43621" title="short permalink to this answer" class="short-link" id="link-post-43621">share</a><span class="lsep">|</span><a href="/posts/43621/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">

<div class="user-info ">
    <div class="user-action-time">
        
        
        <a href="/posts/43621/revisions" title="show all edits to this post">edited <span title="2013-06-02 00:24:23Z" class="relativetime">Jun 2 at 0:24</span></a>
        

    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        <br>
        
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    
<div class="user-info ">
    <div class="user-action-time">
        
        
            answered <span title="2013-06-01 23:33:11Z" class="relativetime">Jun 1 at 23:33</span>
        

    </div>
    <div class="user-gravatar32">
        <a href="/users/24164/stoleg"><div><img src="https://www.gravatar.com/avatar/36d7735ae503d46d844da5cdf77a5993?s=32&d=identicon&r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/24164/stoleg">Stoleg</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">410</span><span title="2 silver badges"><span class="badge2"></span><span class="badgecount">2</span></span><span title="10 bronze badges"><span class="badge3"></span><span class="badgecount">10</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-43621" class="comments" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="9" 
			           data-addlink-html="" 
			           data-addlink-disabled="true">

    <tr id="comment-76918" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">I like the suggestions, but, like @MartinSmith, I&#39;m still waiting for the real .sqlplan. Pictures of the plan are good, but not like the real one.</span>
	&ndash;&nbsp;
		<a href="/users/418/marian" 
		   title="8965 reputation" 
		   class="comment-user">Marian</a>
	<span class="comment-date" dir="ltr"><span title="2013-06-02 00:16:57Z" class="relativetime-clean">Jun 2 at 0:16</span></span>
				</div>

        </td>
    </tr>
    <tr id="comment-76919" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">@Marian, Plan created by Optimiser in the given circumstances. It cannot make the query different or achieve same result with less effort by going outside the query boundaries. After all a query is a command to do certain operations. Computer cannot disobey, but it&#39;s our task to make its life easier.</span>
	&ndash;&nbsp;
		<a href="/users/24164/stoleg" 
		   title="410 reputation" 
		   class="comment-user">Stoleg</a>
	<span class="comment-date" dir="ltr"><span title="2013-06-02 00:23:13Z" class="relativetime-clean">Jun 2 at 0:23</span></span>
				</div>

        </td>
    </tr>
    <tr id="comment-76920" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">the main problem I have with the pic (not with the real plan itself) is that I can&#39;t see the real numbers (estimated rows vs actual rows, no of executions for certain operations). Call it laziness, yes, maybe you&#39;re right. But I still prefer the real plan.</span>
	&ndash;&nbsp;
		<a href="/users/418/marian" 
		   title="8965 reputation" 
		   class="comment-user">Marian</a>
	<span class="comment-date" dir="ltr"><span title="2013-06-02 00:28:05Z" class="relativetime-clean">Jun 2 at 0:28</span></span>
		<span class="edited-yes" title="this comment was edited 1 time"></span>
				</div>

        </td>
    </tr>
    <tr id="comment-77186" class="comment">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                                <span title="number of &#39;useful comment&#39; votes received" 
                                        class="cool">3</span>   
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">@DeepakD you&#39;re fetching 300K rows from a godaddy server. Are you sure the problem is the query, and not the fetching of 300K rows? How long does it take <code>SELECT TOP 300000 * FROM dbo.Some_Big_Enough_Table;</code>?</span>
	&ndash;&nbsp;
		<a href="/users/1186/aaron-bertrand" 
		   title="45708 reputation" 
		   class="comment-user">Aaron Bertrand<span class="mod-flair" title="moderator">&#9830;</span></a>
	<span class="comment-date" dir="ltr"><span title="2013-06-04 13:01:01Z" class="relativetime-clean">Jun 4 at 13:01</span></span>
				</div>

        </td>
    </tr>
    <tr id="comment-77422" class="comment">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                                <span title="number of &#39;useful comment&#39; votes received" 
                                        class="cool">2</span>   
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">I&#39;m afraid there is nothing you can do further without SQL Profiler. Use it to find out bottlenecks on your server (I/O, CPU, Memory). To me it seems to be a constrain on data reading (I/O ~ HDD reading speed) performance of your hardware. There a limit how fast a query will run on any given hardware.</span>
	&ndash;&nbsp;
		<a href="/users/24164/stoleg" 
		   title="410 reputation" 
		   class="comment-user">Stoleg</a>
	<span class="comment-date" dir="ltr"><span title="2013-06-05 09:16:39Z" class="relativetime-clean">Jun 5 at 9:16</span></span>
				</div>

        </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-43621" 
			   class="comments-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">show <b>9</b> more comments</a>
    </td>
</tr>
    </table>
</div>
									<a name='new-answer'></a>
						<form id="post-form" action="/questions/43553/answer/submit" method="post"  class="post-form">
							<input type="hidden" id="post-id" value="43553" />
							<h2 class="space">Your Answer</h2>



    

<script type="text/javascript">
    StackExchange.ready(function() {
        initTagRenderer("".split(" "), "".split(" "));
         
        prepareEditor({
            heartbeatType: 'answer',
            bindNavPrevention: true,
            postfix: "",
            onDemand: true,
            discardSelector: ".discard-answer"
            ,immediatelyShowMarkdownHelp:true
        });
        

    });  
</script>


<div id="post-editor" class="post-editor">

    <div style="position: relative;">     
        <div class="wmd-container">
            <div id="wmd-button-bar" class="wmd-button-bar"></div>
            <textarea id="wmd-input" class="wmd-input" name="post-text" cols="92" rows="15" tabindex="101" data-min-length=""></textarea>
        </div>
    </div>

    <div class="fl" style="margin-top: 8px; height:24px;">&nbsp;</div>
    <div id="draft-saved" class="draft-saved community-option fl" style="margin-top: 8px; height:24px; display:none;">draft saved</div>

    <div id="draft-discarded" class="draft-discarded community-option fl" style="margin-top: 8px; height:24px; display:none;">draft discarded</div>



    <div id="wmd-preview" class="wmd-preview"></div>
    <div></div>
    <div class="edit-block">
        <input id="fkey" name="fkey" type="hidden" value="f51c005c36aeb04be7163e16a81b52d5">
        <input id="author" name="author" type="text">
    </div>
</div>
							<div style="position: relative;">
								
            <div class="form-item dno new-post-login">
        
                <div class="new-login-form">
                    <div class="new-login-left">
                        <h3>Sign up or <a id="login-link" href="/users/login?returnurl=%2fquestions%2f43553%2freduce-clustered-index-seek-cost-sql-server-2008-r2%23new-answer">login</a></h3>
                        <script type="text/javascript">
                            StackExchange.ready(function () {
                                StackExchange.helpers.onClickDraftSave('#login-link');
                            });
                        </script>
                        <div class="preferred-login google-login">
                            <p><span class="icon"></span><span>Sign up using Google</span></p>
                        </div>
                        <div class="preferred-login facebook-login">
                            <p><span class="icon"></span><span>Sign up using Facebook</span></p>
                        </div>
                        <div class="preferred-login stackexchange-login">
                            <p><span class="icon"></span><span>Sign up using Stack Exchange</span></p>
                        </div>
                    </div>
                    <input type="hidden" name="manual-openid" class="manual-openid" />
                    <input type="hidden" name="use-facebook" class="use-facebook" value="false" />
                    <input type="button" class="submit-openid" value="Submit" style="display:none" />
                    <div class="new-login-right">
                                <h3>Post as a guest</h3>
    <div class="form-item">
        <table>
        <tr>
                    <script type="text/javascript">
                StackExchange.ready(function () {
                    StackExchange.helpers.bindHelpOverlayEvents($('.vm input'));
                });
            </script>
            <td class="vm">
                <div>
                    <label for="display-name">Name</label>
                    <input id="display-name" name="display-name" type="text" size="30" maxlength="30" value="" tabindex="105">
                </div>
                <div>
                    <label for="m-address">Email</label>
                    <input id="m-address" name="m-address" type="text" size="30" maxlength="100" value="" tabindex="106">
                    <span class="edit-field-overlay">required, but not shown</span>
                </div>
            </td>
        </tr>
        </table>
    </div>

                    </div>
                </div>
            </div>
            <script type="text/javascript">
                StackExchange.ready(
                    function () {
                        StackExchange.openid.initPostLogin('.new-post-login', '%2fquestions%2f43553%2freduce-clustered-index-seek-cost-sql-server-2008-r2%23new-answer');
                    }
                );
            </script>
            <noscript>
                        <h3>Post as a guest</h3>
    <div class="form-item">
        <table>
        <tr>
                    <script type="text/javascript">
                StackExchange.ready(function () {
                    StackExchange.helpers.bindHelpOverlayEvents($('.vm input'));
                });
            </script>
            <td class="vm">
                <div>
                    <label for="display-name">Name</label>
                    <input id="display-name" name="display-name" type="text" size="30" maxlength="30" value="" tabindex="105">
                </div>
                <div>
                    <label for="m-address">Email</label>
                    <input id="m-address" name="m-address" type="text" size="30" maxlength="100" value="" tabindex="106">
                    <span class="edit-field-overlay">required, but not shown</span>
                </div>
            </td>
        </tr>
        </table>
    </div>

            </noscript>
							</div>
           
															<div class="form-submit cbt">
									<input id="submit-button" type="submit" value="Post Your Answer" tabindex="110">
									<a href="#" class="discard-answer dno">discard</a>

<p class="privacy-policy-agreement">
By posting your answer, you agree to the <a href='http://stackexchange.com/legal/privacy-policy' target='_blank'>privacy policy</a> and <a href='http://stackexchange.com/legal/terms-of-service' target='_blank'>terms of service</a>.</p>
<input type="hidden" name="legalLinksShown" value="1" />								</div>
						</form>



						<h2 class="bottom-notice">
Not the answer you&#39;re looking for?							Browse other questions tagged <a href="/questions/tagged/sql" class="post-tag" title="show questions tagged &#39;sql&#39;" rel="tag">sql</a> <a href="/questions/tagged/sql-server" class="post-tag" title="show questions tagged &#39;sql-server&#39;" rel="tag">sql-server</a> <a href="/questions/tagged/sql-server-2008" class="post-tag" title="show questions tagged &#39;sql-server-2008&#39;" rel="tag">sql-server-2008</a>  or <a href="/questions/ask">ask your own question</a>.						</h2>
			</div>
		</div>
				<div id="sidebar" class="show-votes">
							<div class="module question-stats">
					<p class="label-key">tagged</p>
					<div class="tagged"><a href="/questions/tagged/sql-server" class="post-tag" title="show questions tagged &#39;sql-server&#39;" rel="tag">sql-server</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">&times;</span>&nbsp;<span class="item-multiplier-count">5389</span></span><br>
<a href="/questions/tagged/sql" class="post-tag" title="show questions tagged &#39;sql&#39;" rel="tag">sql</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">&times;</span>&nbsp;<span class="item-multiplier-count">2406</span></span><br>
<a href="/questions/tagged/sql-server-2008" class="post-tag" title="show questions tagged &#39;sql-server-2008&#39;" rel="tag">sql-server-2008</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">&times;</span>&nbsp;<span class="item-multiplier-count">2292</span></span><br>
</div>
					<table id="qinfo">
						<tr>
							<td>
								<p class="label-key">asked</p>
							</td>
							<td style="padding-left: 10px">
								<p class="label-key" title="2013-05-31 12:49:29Z"><b>5 months ago</b></p>
							</td>
						</tr>
						<tr>
							<td>
								<p class="label-key">viewed</p>
							</td>

							<td style="padding-left: 10px">
								<p class="label-key">
									<b>644 times</b>
								</p>
							</td>
						</tr>
							<tr>
								<td>
									<p class="label-key">active</p>
								</td>
								<td style="padding-left: 10px">
									<p class="label-key"><b><a href="?lastactivity" class="lastactivity-link" title="2013-06-05 12:06:17Z">5 months ago</a></b></p>
								</td>
							</tr>
					</table>
				</div>
						
			
    <div style="margin-bottom: 10px;">
        

<style type="text/css">
#newsletter-ad {
    width: 190px;
    height: 250px;
    overflow: hidden;
    background: url('//cdn.sstatic.net/dba/img/newsletter-ad.png');
    padding: 0 15px 0 15px;
}
#newsletter-ad-header {
    margin-top: 60px;
}
#newsletter-ad ul {
    margin: 1em 0 1em 1.5em;
}
#newsletter-ad ul li {
    margin-bottom: 5px;
}
#newsletter-signup-container {
    text-align: center;
}
#newsletter-preview-container {
    margin-top: 10px;
    text-align: center;
}
#newsletter-email-input {
    width: 200px;
}
</style>

<script>
    StackExchange.ready(function () {
        StackExchange.newsletterAd.init();
    });
</script>

<div id="newsletter-ad">
    <p id="newsletter-ad-header">Get the <b>weekly newsletter!</b></p>
    <ul>
        <li>Top questions and answers</li>
        <li>Important announcements</li>
        <li>Unanswered questions</li>
    </ul>
    <div id="newsletter-signup-container"><input id="newsletter-signup" type="button" value="Sign up for the newsletter" /></div>
    <p id="newsletter-preview-container">see an <a href="http://stackexchange.com/newsletters/newsletter?site=dba.stackexchange.com" id="newsletter-preview">example newsletter</a></p>
    <div class="dno">
        
<p class="privacy-policy-agreement">
By subscribing, you agree to the <a href='http://stackexchange.com/legal/privacy-policy' target='_blank'>privacy policy</a> and <a href='http://stackexchange.com/legal/terms-of-service' target='_blank'>terms of service</a>.</p>
<input type="hidden" name="legalLinksShown" value="1" />
    </div>
</div>

    </div>

			  
    
            

				<div class="module sidebar-related">
					<h4 id="h-related">Related</h4>
					<div class="related" data-tracker="rq=1">
						<div class="spacer">
<a href="/q/11374" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">2
    </div>
</a><a href="/questions/11374/reducing-sort-time-for-querying-aspnet-users-table-in-sql-server" class="question-hyperlink">Reducing sort time for querying aspnet_users table in Sql Server</a>
</div>
<div class="spacer">
<a href="/q/12328" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">3
    </div>
</a><a href="/questions/12328/clustered-index-update-on-nonclustered-columns" class="question-hyperlink">Clustered Index Update on Nonclustered Columns</a>
</div>
<div class="spacer">
<a href="/q/12913" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">7
    </div>
</a><a href="/questions/12913/sql-server-2008-partitioning-and-clustered-indexes" class="question-hyperlink">SQL Server 2008 - Partitioning and Clustered Indexes</a>
</div>
<div class="spacer">
<a href="/q/14582" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">-1
    </div>
</a><a href="/questions/14582/sql-server-could-not-allocate-space-for-object" class="question-hyperlink">sql server - could not allocate space for object</a>
</div>
<div class="spacer">
<a href="/q/25761" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">7
    </div>
</a><a href="/questions/25761/sql-server-2008-datetime-index-performance-bug" class="question-hyperlink">SQL Server 2008 datetime index performance bug</a>
</div>
<div class="spacer">
<a href="/q/27140" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">5
    </div>
</a><a href="/questions/27140/optimisation-of-complex-query-100-cost-index-seek" class="question-hyperlink">Optimisation of complex query - 100% cost index seek?</a>
</div>
<div class="spacer">
<a href="/q/28279" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">3
    </div>
</a><a href="/questions/28279/help-to-create-indexes-to-improve-query-performance-and-reduce-report-generation" class="question-hyperlink">Help to create indexes to improve query performance and reduce report generation time</a>
</div>
<div class="spacer">
<a href="/q/29278" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">3
    </div>
</a><a href="/questions/29278/does-the-query-cost-in-sql-server-account-for-buffering" class="question-hyperlink">Does the Query cost in Sql Server account for buffering?</a>
</div>
<div class="spacer">
<a href="/q/34541" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">4
    </div>
</a><a href="/questions/34541/indexing-strategy-when-using-the-between-operator-sql-server-2008" class="question-hyperlink">Indexing strategy when using the between operator SQL Server 2008</a>
</div>
<div class="spacer">
<a href="/q/46768" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">3
    </div>
</a><a href="/questions/46768/question-about-non-clustered-index-storage-in-sql-server" class="question-hyperlink">Question about non-clustered index storage in SQL Server</a>
</div>

					</div>
				</div>
		</div>
	
<div id="feed-link">
    <div id="feed-link-text"><a href="/feeds/question/43553" title="feed of this question and its answers"><span class="feed-icon"></span>question feed</a></div>
</div>
	<script type="text/javascript">
StackExchange.ready(function(){$.get('/posts/43553/ivc/e99e');});
</script>
<noscript>
    <div><img src="/posts/43553/ivc/e99e" class="dno" alt="" width="0" height="0"></div>
</noscript><div style="display:none" id="prettify-lang">lang-sql</div></div>


        </div>
    </div>
    <div id="footer" class="categories">
        <div class="footerwrap">
            <div id="footer-menu">
                <div class="top-footer-links">
                        <a href="/about">about</a>
                    <a href="/help">help</a>
                        <a href="/help/badges">badges</a>
                    <a href="http://dba.blogoverflow.com?blb=1">blog</a>
                        <a href="http://chat.stackexchange.com">chat</a>
                    <a href="http://data.stackexchange.com">data</a>
                    <a href="http://stackexchange.com/legal">legal</a>
                    <a href="http://stackexchange.com/legal/privacy-policy">privacy policy</a>
                    <a href="http://stackexchange.com/about/hiring">jobs</a>
                    <a href="http://stackexchange.com/about/contact">advertising info</a>

                    <a onclick='StackExchange.switchMobile("on", "/questions/43553/reduce-clustered-index-seek-cost-sql-server-2008-r2")'>mobile</a>
                    <b><a href="/contact">contact us</a></b>
                        <b><a href="http://meta.dba.stackexchange.com">feedback</a></b>
                    
                </div>
                <div id="footer-sites">
                    <table>
    <tr>
            <th colspan=3>
                Technology
            </th>
            <th >
                Life / Arts
            </th>
            <th >
                Culture / Recreation
            </th>
            <th >
                Science
            </th>
            <th >
                Other
            </th>
    </tr>
    <tr>
            <td>
                <ol>
                        <li><a href="http://stackoverflow.com" title="professional and enthusiast programmers">Stack Overflow</a></li>
                        <li><a href="http://serverfault.com" title="professional system and network administrators">Server Fault</a></li>
                        <li><a href="http://superuser.com" title="computer enthusiasts and power users">Super User</a></li>
                        <li><a href="http://webapps.stackexchange.com" title="power users of web applications">Web Applications</a></li>
                        <li><a href="http://askubuntu.com" title="Ubuntu users and developers">Ask Ubuntu</a></li>
                        <li><a href="http://webmasters.stackexchange.com" title="pro webmasters">Webmasters</a></li>
                        <li><a href="http://gamedev.stackexchange.com" title="professional and independent game developers">Game Development</a></li>
                        <li><a href="http://tex.stackexchange.com" title="users of TeX, LaTeX, ConTeXt, and related typesetting systems">TeX - LaTeX</a></li>
                            </ol></td><td><ol>
                        <li><a href="http://programmers.stackexchange.com" title="professional programmers interested in conceptual questions about software development">Programmers</a></li>
                        <li><a href="http://unix.stackexchange.com" title="users of Linux, FreeBSD and other Un*x-like operating systems.">Unix &amp; Linux</a></li>
                        <li><a href="http://apple.stackexchange.com" title="power users of Apple hardware and software">Ask Different (Apple)</a></li>
                        <li><a href="http://wordpress.stackexchange.com" title="WordPress developers and administrators">WordPress Answers</a></li>
                        <li><a href="http://gis.stackexchange.com" title="cartographers, geographers and GIS professionals">Geographic Information Systems</a></li>
                        <li><a href="http://electronics.stackexchange.com" title="electronics and electrical engineering professionals, students, and enthusiasts">Electrical Engineering</a></li>
                        <li><a href="http://android.stackexchange.com" title="enthusiasts and power users of the Android operating system">Android Enthusiasts</a></li>
                        <li><a href="http://security.stackexchange.com" title="Information security professionals">Information Security</a></li>
                            </ol></td><td><ol>
                        <li><a href="http://dba.stackexchange.com" title="database professionals who wish to improve their database skills and learn from others in the community">Database Administrators</a></li>
                        <li><a href="http://drupal.stackexchange.com" title="Drupal developers and administrators">Drupal Answers</a></li>
                        <li><a href="http://sharepoint.stackexchange.com" title="SharePoint enthusiasts">SharePoint</a></li>
                        <li><a href="http://ux.stackexchange.com" title="user experience researchers and experts">User Experience</a></li>
                        <li><a href="http://mathematica.stackexchange.com" title="users of Mathematica">Mathematica</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#technology" class="more">
                                more (14)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://photo.stackexchange.com" title="professional, enthusiast and amateur photographers">Photography</a></li>
                        <li><a href="http://scifi.stackexchange.com" title="science fiction and fantasy enthusiasts">Science Fiction &amp; Fantasy</a></li>
                        <li><a href="http://cooking.stackexchange.com" title="professional and amateur chefs">Seasoned Advice (cooking)</a></li>
                        <li><a href="http://diy.stackexchange.com" title="contractors and serious DIYers">Home Improvement</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#lifearts" class="more">
                                more (13)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://english.stackexchange.com" title="linguists, etymologists, and serious English language enthusiasts">English Language &amp; Usage</a></li>
                        <li><a href="http://skeptics.stackexchange.com" title="scientific skepticism">Skeptics</a></li>
                        <li><a href="http://judaism.stackexchange.com" title="those who base their lives on Jewish law and tradition and anyone interested in learning more">Mi Yodeya (Judaism)</a></li>
                        <li><a href="http://travel.stackexchange.com" title="road warriors and seasoned travelers">Travel</a></li>
                        <li><a href="http://christianity.stackexchange.com" title="committed Christians, experts in Christianity and those interested in learning more">Christianity</a></li>
                        <li><a href="http://gaming.stackexchange.com" title="passionate videogamers on all platforms">Arqade (gaming)</a></li>
                        <li><a href="http://bicycles.stackexchange.com" title="people who build and repair bicycles, people who train cycling, or commute on bicycles">Bicycles</a></li>
                        <li><a href="http://rpg.stackexchange.com" title="gamemasters and players of tabletop, paper-and-pencil role-playing games">Role-playing Games</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#culturerecreation" class="more">
                                more (21)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://math.stackexchange.com" title="people studying math at any level and professionals in related fields">Mathematics</a></li>
                        <li><a href="http://stats.stackexchange.com" title="statisticians, data analysts, data miners and data visualization experts">Cross Validated (stats)</a></li>
                        <li><a href="http://cstheory.stackexchange.com" title="theoretical computer scientists and researchers in related fields">Theoretical Computer Science</a></li>
                        <li><a href="http://physics.stackexchange.com" title="active researchers, academics and students of physics">Physics</a></li>
                        <li><a href="http://mathoverflow.net" title="professional mathematicians">MathOverflow</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#science" class="more">
                                more (7)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://stackapps.com" title="apps, scripts, and development with the Stack Exchange API">Stack Apps</a></li>
                        <li><a href="http://meta.stackoverflow.com" title="meta-discussion of the Stack Exchange family of Q&amp;A websites">Meta Stack Overflow</a></li>
                        <li><a href="http://area51.stackexchange.com" title="proposing new sites in the Stack Exchange network">Area 51</a></li>
                        <li><a href="http://careers.stackoverflow.com">Stack Overflow Careers</a></li>
                    
                </ol>
            </td>
    </tr>
</table>
                </div>
            </div>

            <div id="copyright">
                site design / logo &#169; 2013 stack exchange inc; user contributions licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license">cc-wiki</a> 
 with <a href="http://blog.stackoverflow.com/2009/06/attribution-required/" rel="license">attribution required</a>
            </div>
            <div id="footer-flair">
                <a href="http://creativecommons.org/licenses/by-sa/3.0/" class="cc-wiki-link"></a>
            </div>
            <div id="svnrev">
                rev 2013.11.22.1174
            </div>
            
        </div>
    </div>
    <noscript>
        <div id="noscript-warning">Database Administrators Stack Exchange works best with JavaScript enabled<img src="http://pixel.quantserve.com/pixel/p-c1rF4kxgLUzNc.gif" alt="" class="dno"></div>
    </noscript>

    <script type="text/javascript">var _gaq=_gaq||[];_gaq.push(['_setAccount','UA-5620270-24']);
        _gaq.push(['_setDomainName','.stackexchange.com']);
        _gaq.push(['_setCustomVar', 1, 'tags', '|sql|sql-server|sql-server-2008|']); 
_gaq.push(['_trackPageview']);
    var _qevents = _qevents || [];
    var _comscore = _comscore || [];
    (function () {
        var ssl='https:'==document.location.protocol,
            s=document.getElementsByTagName('script')[0],
            ga=document.createElement('script');
        ga.type='text/javascript';
        ga.async=true;
        ga.src=(ssl?'https://ssl':'http://www')+'.google-analytics.com/ga.js';
        s.parentNode.insertBefore(ga,s);
        var sc=document.createElement('script');
        sc.type='text/javascript';
        sc.async=true;
        sc.src=(ssl?'https://secure':'http://edge')+'.quantserve.com/quant.js';
        s.parentNode.insertBefore(sc, s);
        
        var s = document.createElement("script"), el = document.getElementsByTagName("script")[0]; s.async = true;
        s.src = (document.location.protocol == "https:" ? "https://sb" : "http://b") + ".scorecardresearch.com/beacon.js";
        el.parentNode.insertBefore(s, el);
        
    })();
    _comscore.push({ c1: "2", c2: "17440561" });
    _qevents.push({ qacct: "p-c1rF4kxgLUzNc" });
    </script>        
    
</body>
</html>